(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function n(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(o){if(o.ep)return;o.ep=!0;const l=n(o);fetch(o.href,l)}})();function Ao(i){const t=Object.create(null);for(const n of i.split(","))t[n]=1;return n=>n in t}const Tt={},on=[],Ue=()=>{},Yl=()=>!1,Qs=i=>i.charCodeAt(0)===111&&i.charCodeAt(1)===110&&(i.charCodeAt(2)>122||i.charCodeAt(2)<97),Lo=i=>i.startsWith("onUpdate:"),te=Object.assign,Ro=(i,t)=>{const n=i.indexOf(t);n>-1&&i.splice(n,1)},jh=Object.prototype.hasOwnProperty,vt=(i,t)=>jh.call(i,t),st=Array.isArray,an=i=>tr(i)==="[object Map]",Xl=i=>tr(i)==="[object Set]",ot=i=>typeof i=="function",Bt=i=>typeof i=="string",mi=i=>typeof i=="symbol",kt=i=>i!==null&&typeof i=="object",Ql=i=>(kt(i)||ot(i))&&ot(i.then)&&ot(i.catch),tu=Object.prototype.toString,tr=i=>tu.call(i),Dh=i=>tr(i).slice(8,-1),eu=i=>tr(i)==="[object Object]",Io=i=>Bt(i)&&i!=="NaN"&&i[0]!=="-"&&""+parseInt(i,10)===i,Mn=Ao(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),er=i=>{const t=Object.create(null);return(n=>t[n]||(t[n]=i(n)))},Bh=/-\w/g,pi=er(i=>i.replace(Bh,t=>t.slice(1).toUpperCase())),Uh=/\B([A-Z])/g,Mi=er(i=>i.replace(Uh,"-$1").toLowerCase()),iu=er(i=>i.charAt(0).toUpperCase()+i.slice(1)),$r=er(i=>i?`on${iu(i)}`:""),fi=(i,t)=>!Object.is(i,t),$s=(i,...t)=>{for(let n=0;n<i.length;n++)i[n](...t)},nu=(i,t,n,r=!1)=>{Object.defineProperty(i,t,{configurable:!0,enumerable:!1,writable:r,value:n})},Mo=i=>{const t=parseFloat(i);return isNaN(t)?i:t};let Ga;const ir=()=>Ga||(Ga=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function No(i){if(st(i)){const t={};for(let n=0;n<i.length;n++){const r=i[n],o=Bt(r)?Zh(r):No(r);if(o)for(const l in o)t[l]=o[l]}return t}else if(Bt(i)||kt(i))return i}const $h=/;(?![^(]*\))/g,zh=/:([^]+)/,Fh=/\/\*[^]*?\*\//g;function Zh(i){const t={};return i.replace(Fh,"").split($h).forEach(n=>{if(n){const r=n.split(zh);r.length>1&&(t[r[0].trim()]=r[1].trim())}}),t}function Wn(i){let t="";if(Bt(i))t=i;else if(st(i))for(let n=0;n<i.length;n++){const r=Wn(i[n]);r&&(t+=r+" ")}else if(kt(i))for(const n in i)i[n]&&(t+=n+" ");return t.trim()}const Wh="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Hh=Ao(Wh);function su(i){return!!i||i===""}const ru=i=>!!(i&&i.__v_isRef===!0),Vt=i=>Bt(i)?i:i==null?"":st(i)||kt(i)&&(i.toString===tu||!ot(i.toString))?ru(i)?Vt(i.value):JSON.stringify(i,ou,2):String(i),ou=(i,t)=>ru(t)?ou(i,t.value):an(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[r,o],l)=>(n[zr(r,l)+" =>"]=o,n),{})}:Xl(t)?{[`Set(${t.size})`]:[...t.values()].map(n=>zr(n))}:mi(t)?zr(t):kt(t)&&!st(t)&&!eu(t)?String(t):t,zr=(i,t="")=>{var n;return mi(i)?`Symbol(${(n=i.description)!=null?n:t})`:i};let ae;class qh{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=ae,!t&&ae&&(this.index=(ae.scopes||(ae.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].pause();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].resume();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].resume()}}run(t){if(this._active){const n=ae;try{return ae=this,t()}finally{ae=n}}}on(){++this._on===1&&(this.prevScope=ae,ae=this)}off(){this._on>0&&--this._on===0&&(ae=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let n,r;for(n=0,r=this.effects.length;n<r;n++)this.effects[n].stop();for(this.effects.length=0,n=0,r=this.cleanups.length;n<r;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,r=this.scopes.length;n<r;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const o=this.parent.scopes.pop();o&&o!==this&&(this.parent.scopes[this.index]=o,o.index=this.index)}this.parent=void 0}}}function Kh(){return ae}let Pt;const Fr=new WeakSet;class au{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,ae&&ae.active&&ae.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Fr.has(this)&&(Fr.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||uu(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Ja(this),cu(this);const t=Pt,n=Oe;Pt=this,Oe=!0;try{return this.fn()}finally{hu(this),Pt=t,Oe=n,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)Bo(t);this.deps=this.depsTail=void 0,Ja(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Fr.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){ao(this)&&this.run()}get dirty(){return ao(this)}}let lu=0,Nn,jn;function uu(i,t=!1){if(i.flags|=8,t){i.next=jn,jn=i;return}i.next=Nn,Nn=i}function jo(){lu++}function Do(){if(--lu>0)return;if(jn){let t=jn;for(jn=void 0;t;){const n=t.next;t.next=void 0,t.flags&=-9,t=n}}let i;for(;Nn;){let t=Nn;for(Nn=void 0;t;){const n=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(r){i||(i=r)}t=n}}if(i)throw i}function cu(i){for(let t=i.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function hu(i){let t,n=i.depsTail,r=n;for(;r;){const o=r.prevDep;r.version===-1?(r===n&&(n=o),Bo(r),Vh(r)):t=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=o}i.deps=t,i.depsTail=n}function ao(i){for(let t=i.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(du(t.dep.computed)||t.dep.version!==t.version))return!0;return!!i._dirty}function du(i){if(i.flags&4&&!(i.flags&16)||(i.flags&=-17,i.globalVersion===Hn)||(i.globalVersion=Hn,!i.isSSR&&i.flags&128&&(!i.deps&&!i._dirty||!ao(i))))return;i.flags|=2;const t=i.dep,n=Pt,r=Oe;Pt=i,Oe=!0;try{cu(i);const o=i.fn(i._value);(t.version===0||fi(o,i._value))&&(i.flags|=128,i._value=o,t.version++)}catch(o){throw t.version++,o}finally{Pt=n,Oe=r,hu(i),i.flags&=-3}}function Bo(i,t=!1){const{dep:n,prevSub:r,nextSub:o}=i;if(r&&(r.nextSub=o,i.prevSub=void 0),o&&(o.prevSub=r,i.nextSub=void 0),n.subs===i&&(n.subs=r,!r&&n.computed)){n.computed.flags&=-5;for(let l=n.computed.deps;l;l=l.nextDep)Bo(l,!0)}!t&&!--n.sc&&n.map&&n.map.delete(n.key)}function Vh(i){const{prevDep:t,nextDep:n}=i;t&&(t.nextDep=n,i.prevDep=void 0),n&&(n.prevDep=t,i.nextDep=void 0)}let Oe=!0;const fu=[];function Xe(){fu.push(Oe),Oe=!1}function Qe(){const i=fu.pop();Oe=i===void 0?!0:i}function Ja(i){const{cleanup:t}=i;if(i.cleanup=void 0,t){const n=Pt;Pt=void 0;try{t()}finally{Pt=n}}}let Hn=0;class Gh{constructor(t,n){this.sub=t,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Uo{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!Pt||!Oe||Pt===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==Pt)n=this.activeLink=new Gh(Pt,this),Pt.deps?(n.prevDep=Pt.depsTail,Pt.depsTail.nextDep=n,Pt.depsTail=n):Pt.deps=Pt.depsTail=n,pu(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const r=n.nextDep;r.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=r),n.prevDep=Pt.depsTail,n.nextDep=void 0,Pt.depsTail.nextDep=n,Pt.depsTail=n,Pt.deps===n&&(Pt.deps=r)}return n}trigger(t){this.version++,Hn++,this.notify(t)}notify(t){jo();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{Do()}}}function pu(i){if(i.dep.sc++,i.sub.flags&4){const t=i.dep.computed;if(t&&!i.dep.subs){t.flags|=20;for(let r=t.deps;r;r=r.nextDep)pu(r)}const n=i.dep.subs;n!==i&&(i.prevSub=n,n&&(n.nextSub=i)),i.dep.subs=i}}const lo=new WeakMap,Ri=Symbol(""),uo=Symbol(""),qn=Symbol("");function Xt(i,t,n){if(Oe&&Pt){let r=lo.get(i);r||lo.set(i,r=new Map);let o=r.get(n);o||(r.set(n,o=new Uo),o.map=r,o.key=n),o.track()}}function Je(i,t,n,r,o,l){const u=lo.get(i);if(!u){Hn++;return}const h=f=>{f&&f.trigger()};if(jo(),t==="clear")u.forEach(h);else{const f=st(i),p=f&&Io(n);if(f&&n==="length"){const m=Number(r);u.forEach((g,w)=>{(w==="length"||w===qn||!mi(w)&&w>=m)&&h(g)})}else switch((n!==void 0||u.has(void 0))&&h(u.get(n)),p&&h(u.get(qn)),t){case"add":f?p&&h(u.get("length")):(h(u.get(Ri)),an(i)&&h(u.get(uo)));break;case"delete":f||(h(u.get(Ri)),an(i)&&h(u.get(uo)));break;case"set":an(i)&&h(u.get(Ri));break}}Do()}function qi(i){const t=gt(i);return t===i?t:(Xt(t,"iterate",qn),Te(i)?t:t.map(Ce))}function nr(i){return Xt(i=gt(i),"iterate",qn),i}function ai(i,t){return ti(i)?hn(Ii(i)?Ce(t):t):Ce(t)}const Jh={__proto__:null,[Symbol.iterator](){return Zr(this,Symbol.iterator,i=>ai(this,i))},concat(...i){return qi(this).concat(...i.map(t=>st(t)?qi(t):t))},entries(){return Zr(this,"entries",i=>(i[1]=ai(this,i[1]),i))},every(i,t){return Ke(this,"every",i,t,void 0,arguments)},filter(i,t){return Ke(this,"filter",i,t,n=>n.map(r=>ai(this,r)),arguments)},find(i,t){return Ke(this,"find",i,t,n=>ai(this,n),arguments)},findIndex(i,t){return Ke(this,"findIndex",i,t,void 0,arguments)},findLast(i,t){return Ke(this,"findLast",i,t,n=>ai(this,n),arguments)},findLastIndex(i,t){return Ke(this,"findLastIndex",i,t,void 0,arguments)},forEach(i,t){return Ke(this,"forEach",i,t,void 0,arguments)},includes(...i){return Wr(this,"includes",i)},indexOf(...i){return Wr(this,"indexOf",i)},join(i){return qi(this).join(i)},lastIndexOf(...i){return Wr(this,"lastIndexOf",i)},map(i,t){return Ke(this,"map",i,t,void 0,arguments)},pop(){return kn(this,"pop")},push(...i){return kn(this,"push",i)},reduce(i,...t){return Ya(this,"reduce",i,t)},reduceRight(i,...t){return Ya(this,"reduceRight",i,t)},shift(){return kn(this,"shift")},some(i,t){return Ke(this,"some",i,t,void 0,arguments)},splice(...i){return kn(this,"splice",i)},toReversed(){return qi(this).toReversed()},toSorted(i){return qi(this).toSorted(i)},toSpliced(...i){return qi(this).toSpliced(...i)},unshift(...i){return kn(this,"unshift",i)},values(){return Zr(this,"values",i=>ai(this,i))}};function Zr(i,t,n){const r=nr(i),o=r[t]();return r!==i&&!Te(i)&&(o._next=o.next,o.next=()=>{const l=o._next();return l.done||(l.value=n(l.value)),l}),o}const Yh=Array.prototype;function Ke(i,t,n,r,o,l){const u=nr(i),h=u!==i&&!Te(i),f=u[t];if(f!==Yh[t]){const g=f.apply(i,l);return h?Ce(g):g}let p=n;u!==i&&(h?p=function(g,w){return n.call(this,ai(i,g),w,i)}:n.length>2&&(p=function(g,w){return n.call(this,g,w,i)}));const m=f.call(u,p,r);return h&&o?o(m):m}function Ya(i,t,n,r){const o=nr(i);let l=n;return o!==i&&(Te(i)?n.length>3&&(l=function(u,h,f){return n.call(this,u,h,f,i)}):l=function(u,h,f){return n.call(this,u,ai(i,h),f,i)}),o[t](l,...r)}function Wr(i,t,n){const r=gt(i);Xt(r,"iterate",qn);const o=r[t](...n);return(o===-1||o===!1)&&Zo(n[0])?(n[0]=gt(n[0]),r[t](...n)):o}function kn(i,t,n=[]){Xe(),jo();const r=gt(i)[t].apply(i,n);return Do(),Qe(),r}const Xh=Ao("__proto__,__v_isRef,__isVue"),_u=new Set(Object.getOwnPropertyNames(Symbol).filter(i=>i!=="arguments"&&i!=="caller").map(i=>Symbol[i]).filter(mi));function Qh(i){mi(i)||(i=String(i));const t=gt(this);return Xt(t,"has",i),t.hasOwnProperty(i)}class mu{constructor(t=!1,n=!1){this._isReadonly=t,this._isShallow=n}get(t,n,r){if(n==="__v_skip")return t.__v_skip;const o=this._isReadonly,l=this._isShallow;if(n==="__v_isReactive")return!o;if(n==="__v_isReadonly")return o;if(n==="__v_isShallow")return l;if(n==="__v_raw")return r===(o?l?ud:wu:l?yu:vu).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(r)?t:void 0;const u=st(t);if(!o){let f;if(u&&(f=Jh[n]))return f;if(n==="hasOwnProperty")return Qh}const h=Reflect.get(t,n,Qt(t)?t:r);if((mi(n)?_u.has(n):Xh(n))||(o||Xt(t,"get",n),l))return h;if(Qt(h)){const f=u&&Io(n)?h:h.value;return o&&kt(f)?ho(f):f}return kt(h)?o?ho(h):zo(h):h}}class gu extends mu{constructor(t=!1){super(!1,t)}set(t,n,r,o){let l=t[n];const u=st(t)&&Io(n);if(!this._isShallow){const p=ti(l);if(!Te(r)&&!ti(r)&&(l=gt(l),r=gt(r)),!u&&Qt(l)&&!Qt(r))return p||(l.value=r),!0}const h=u?Number(n)<t.length:vt(t,n),f=Reflect.set(t,n,r,Qt(t)?t:o);return t===gt(o)&&(h?fi(r,l)&&Je(t,"set",n,r):Je(t,"add",n,r)),f}deleteProperty(t,n){const r=vt(t,n);t[n];const o=Reflect.deleteProperty(t,n);return o&&r&&Je(t,"delete",n,void 0),o}has(t,n){const r=Reflect.has(t,n);return(!mi(n)||!_u.has(n))&&Xt(t,"has",n),r}ownKeys(t){return Xt(t,"iterate",st(t)?"length":Ri),Reflect.ownKeys(t)}}class td extends mu{constructor(t=!1){super(!0,t)}set(t,n){return!0}deleteProperty(t,n){return!0}}const ed=new gu,id=new td,nd=new gu(!0);const co=i=>i,ks=i=>Reflect.getPrototypeOf(i);function sd(i,t,n){return function(...r){const o=this.__v_raw,l=gt(o),u=an(l),h=i==="entries"||i===Symbol.iterator&&u,f=i==="keys"&&u,p=o[i](...r),m=n?co:t?hn:Ce;return!t&&Xt(l,"iterate",f?uo:Ri),te(Object.create(p),{next(){const{value:g,done:w}=p.next();return w?{value:g,done:w}:{value:h?[m(g[0]),m(g[1])]:m(g),done:w}}})}}function Os(i){return function(...t){return i==="delete"?!1:i==="clear"?void 0:this}}function rd(i,t){const n={get(o){const l=this.__v_raw,u=gt(l),h=gt(o);i||(fi(o,h)&&Xt(u,"get",o),Xt(u,"get",h));const{has:f}=ks(u),p=t?co:i?hn:Ce;if(f.call(u,o))return p(l.get(o));if(f.call(u,h))return p(l.get(h));l!==u&&l.get(o)},get size(){const o=this.__v_raw;return!i&&Xt(gt(o),"iterate",Ri),o.size},has(o){const l=this.__v_raw,u=gt(l),h=gt(o);return i||(fi(o,h)&&Xt(u,"has",o),Xt(u,"has",h)),o===h?l.has(o):l.has(o)||l.has(h)},forEach(o,l){const u=this,h=u.__v_raw,f=gt(h),p=t?co:i?hn:Ce;return!i&&Xt(f,"iterate",Ri),h.forEach((m,g)=>o.call(l,p(m),p(g),u))}};return te(n,i?{add:Os("add"),set:Os("set"),delete:Os("delete"),clear:Os("clear")}:{add(o){!t&&!Te(o)&&!ti(o)&&(o=gt(o));const l=gt(this);return ks(l).has.call(l,o)||(l.add(o),Je(l,"add",o,o)),this},set(o,l){!t&&!Te(l)&&!ti(l)&&(l=gt(l));const u=gt(this),{has:h,get:f}=ks(u);let p=h.call(u,o);p||(o=gt(o),p=h.call(u,o));const m=f.call(u,o);return u.set(o,l),p?fi(l,m)&&Je(u,"set",o,l):Je(u,"add",o,l),this},delete(o){const l=gt(this),{has:u,get:h}=ks(l);let f=u.call(l,o);f||(o=gt(o),f=u.call(l,o)),h&&h.call(l,o);const p=l.delete(o);return f&&Je(l,"delete",o,void 0),p},clear(){const o=gt(this),l=o.size!==0,u=o.clear();return l&&Je(o,"clear",void 0,void 0),u}}),["keys","values","entries",Symbol.iterator].forEach(o=>{n[o]=sd(o,i,t)}),n}function $o(i,t){const n=rd(i,t);return(r,o,l)=>o==="__v_isReactive"?!i:o==="__v_isReadonly"?i:o==="__v_raw"?r:Reflect.get(vt(n,o)&&o in r?n:r,o,l)}const od={get:$o(!1,!1)},ad={get:$o(!1,!0)},ld={get:$o(!0,!1)};const vu=new WeakMap,yu=new WeakMap,wu=new WeakMap,ud=new WeakMap;function cd(i){switch(i){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function hd(i){return i.__v_skip||!Object.isExtensible(i)?0:cd(Dh(i))}function zo(i){return ti(i)?i:Fo(i,!1,ed,od,vu)}function dd(i){return Fo(i,!1,nd,ad,yu)}function ho(i){return Fo(i,!0,id,ld,wu)}function Fo(i,t,n,r,o){if(!kt(i)||i.__v_raw&&!(t&&i.__v_isReactive))return i;const l=hd(i);if(l===0)return i;const u=o.get(i);if(u)return u;const h=new Proxy(i,l===2?r:n);return o.set(i,h),h}function Ii(i){return ti(i)?Ii(i.__v_raw):!!(i&&i.__v_isReactive)}function ti(i){return!!(i&&i.__v_isReadonly)}function Te(i){return!!(i&&i.__v_isShallow)}function Zo(i){return i?!!i.__v_raw:!1}function gt(i){const t=i&&i.__v_raw;return t?gt(t):i}function fd(i){return!vt(i,"__v_skip")&&Object.isExtensible(i)&&nu(i,"__v_skip",!0),i}const Ce=i=>kt(i)?zo(i):i,hn=i=>kt(i)?ho(i):i;function Qt(i){return i?i.__v_isRef===!0:!1}function Gt(i){return pd(i,!1)}function pd(i,t){return Qt(i)?i:new _d(i,t)}class _d{constructor(t,n){this.dep=new Uo,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?t:gt(t),this._value=n?t:Ce(t),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(t){const n=this._rawValue,r=this.__v_isShallow||Te(t)||ti(t);t=r?t:gt(t),fi(t,n)&&(this._rawValue=t,this._value=r?t:Ce(t),this.dep.trigger())}}function md(i){return Qt(i)?i.value:i}const gd={get:(i,t,n)=>t==="__v_raw"?i:md(Reflect.get(i,t,n)),set:(i,t,n,r)=>{const o=i[t];return Qt(o)&&!Qt(n)?(o.value=n,!0):Reflect.set(i,t,n,r)}};function bu(i){return Ii(i)?i:new Proxy(i,gd)}class vd{constructor(t,n,r){this.fn=t,this.setter=n,this._value=void 0,this.dep=new Uo(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Hn-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&Pt!==this)return uu(this,!0),!0}get value(){const t=this.dep.track();return du(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function yd(i,t,n=!1){let r,o;return ot(i)?r=i:(r=i.get,o=i.set),new vd(r,o,n)}const Cs={},Ws=new WeakMap;let Ei;function wd(i,t=!1,n=Ei){if(n){let r=Ws.get(n);r||Ws.set(n,r=[]),r.push(i)}}function bd(i,t,n=Tt){const{immediate:r,deep:o,once:l,scheduler:u,augmentJob:h,call:f}=n,p=k=>o?k:Te(k)||o===!1||o===0?Ye(k,1):Ye(k);let m,g,w,b,S=!1,P=!1;if(Qt(i)?(g=()=>i.value,S=Te(i)):Ii(i)?(g=()=>p(i),S=!0):st(i)?(P=!0,S=i.some(k=>Ii(k)||Te(k)),g=()=>i.map(k=>{if(Qt(k))return k.value;if(Ii(k))return p(k);if(ot(k))return f?f(k,2):k()})):ot(i)?t?g=f?()=>f(i,2):i:g=()=>{if(w){Xe();try{w()}finally{Qe()}}const k=Ei;Ei=m;try{return f?f(i,3,[b]):i(b)}finally{Ei=k}}:g=Ue,t&&o){const k=g,H=o===!0?1/0:o;g=()=>Ye(k(),H)}const B=Kh(),j=()=>{m.stop(),B&&B.active&&Ro(B.effects,m)};if(l&&t){const k=t;t=(...H)=>{k(...H),j()}}let U=P?new Array(i.length).fill(Cs):Cs;const O=k=>{if(!(!(m.flags&1)||!m.dirty&&!k))if(t){const H=m.run();if(o||S||(P?H.some((A,V)=>fi(A,U[V])):fi(H,U))){w&&w();const A=Ei;Ei=m;try{const V=[H,U===Cs?void 0:P&&U[0]===Cs?[]:U,b];U=H,f?f(t,3,V):t(...V)}finally{Ei=A}}}else m.run()};return h&&h(O),m=new au(g),m.scheduler=u?()=>u(O,!1):O,b=k=>wd(k,!1,m),w=m.onStop=()=>{const k=Ws.get(m);if(k){if(f)f(k,4);else for(const H of k)H();Ws.delete(m)}},t?r?O(!0):U=m.run():u?u(O.bind(null,!0),!0):m.run(),j.pause=m.pause.bind(m),j.resume=m.resume.bind(m),j.stop=j,j}function Ye(i,t=1/0,n){if(t<=0||!kt(i)||i.__v_skip||(n=n||new Map,(n.get(i)||0)>=t))return i;if(n.set(i,t),t--,Qt(i))Ye(i.value,t,n);else if(st(i))for(let r=0;r<i.length;r++)Ye(i[r],t,n);else if(Xl(i)||an(i))i.forEach(r=>{Ye(r,t,n)});else if(eu(i)){for(const r in i)Ye(i[r],t,n);for(const r of Object.getOwnPropertySymbols(i))Object.prototype.propertyIsEnumerable.call(i,r)&&Ye(i[r],t,n)}return i}function ns(i,t,n,r){try{return r?i(...r):i()}catch(o){sr(o,t,n)}}function ze(i,t,n,r){if(ot(i)){const o=ns(i,t,n,r);return o&&Ql(o)&&o.catch(l=>{sr(l,t,n)}),o}if(st(i)){const o=[];for(let l=0;l<i.length;l++)o.push(ze(i[l],t,n,r));return o}}function sr(i,t,n,r=!0){const o=t?t.vnode:null,{errorHandler:l,throwUnhandledErrorInProduction:u}=t&&t.appContext.config||Tt;if(t){let h=t.parent;const f=t.proxy,p=`https://vuejs.org/error-reference/#runtime-${n}`;for(;h;){const m=h.ec;if(m){for(let g=0;g<m.length;g++)if(m[g](i,f,p)===!1)return}h=h.parent}if(l){Xe(),ns(l,null,10,[i,f,p]),Qe();return}}Td(i,n,o,r,u)}function Td(i,t,n,r=!0,o=!1){if(o)throw i;console.error(i)}const ne=[];let De=-1;const ln=[];let li=null,Qi=0;const Tu=Promise.resolve();let Hs=null;function xd(i){const t=Hs||Tu;return i?t.then(this?i.bind(this):i):t}function Sd(i){let t=De+1,n=ne.length;for(;t<n;){const r=t+n>>>1,o=ne[r],l=Kn(o);l<i||l===i&&o.flags&2?t=r+1:n=r}return t}function Wo(i){if(!(i.flags&1)){const t=Kn(i),n=ne[ne.length-1];!n||!(i.flags&2)&&t>=Kn(n)?ne.push(i):ne.splice(Sd(t),0,i),i.flags|=1,xu()}}function xu(){Hs||(Hs=Tu.then(Pu))}function Pd(i){st(i)?ln.push(...i):li&&i.id===-1?li.splice(Qi+1,0,i):i.flags&1||(ln.push(i),i.flags|=1),xu()}function Xa(i,t,n=De+1){for(;n<ne.length;n++){const r=ne[n];if(r&&r.flags&2){if(i&&r.id!==i.uid)continue;ne.splice(n,1),n--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function Su(i){if(ln.length){const t=[...new Set(ln)].sort((n,r)=>Kn(n)-Kn(r));if(ln.length=0,li){li.push(...t);return}for(li=t,Qi=0;Qi<li.length;Qi++){const n=li[Qi];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}li=null,Qi=0}}const Kn=i=>i.id==null?i.flags&2?-1:1/0:i.id;function Pu(i){try{for(De=0;De<ne.length;De++){const t=ne[De];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),ns(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;De<ne.length;De++){const t=ne[De];t&&(t.flags&=-2)}De=-1,ne.length=0,Su(),Hs=null,(ne.length||ln.length)&&Pu()}}let be=null,Eu=null;function qs(i){const t=be;return be=i,Eu=i&&i.type.__scopeId||null,t}function Ed(i,t=be,n){if(!t||i._n)return i;const r=(...o)=>{r._d&&ll(-1);const l=qs(t);let u;try{u=i(...o)}finally{qs(l),r._d&&ll(1)}return u};return r._n=!0,r._c=!0,r._d=!0,r}function As(i,t){if(be===null)return i;const n=lr(be),r=i.dirs||(i.dirs=[]);for(let o=0;o<t.length;o++){let[l,u,h,f=Tt]=t[o];l&&(ot(l)&&(l={mounted:l,updated:l}),l.deep&&Ye(u),r.push({dir:l,instance:n,value:u,oldValue:void 0,arg:h,modifiers:f}))}return i}function Ti(i,t,n,r){const o=i.dirs,l=t&&t.dirs;for(let u=0;u<o.length;u++){const h=o[u];l&&(h.oldValue=l[u].value);let f=h.dir[r];f&&(Xe(),ze(f,n,8,[i.el,h,i,t]),Qe())}}function kd(i,t){if(se){let n=se.provides;const r=se.parent&&se.parent.provides;r===n&&(n=se.provides=Object.create(r)),n[i]=t}}function zs(i,t,n=!1){const r=kf();if(r||un){let o=un?un._context.provides:r?r.parent==null||r.ce?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(o&&i in o)return o[i];if(arguments.length>1)return n&&ot(t)?t.call(r&&r.proxy):t}}const Od=Symbol.for("v-scx"),Cd=()=>zs(Od);function Hr(i,t,n){return ku(i,t,n)}function ku(i,t,n=Tt){const{immediate:r,deep:o,flush:l,once:u}=n,h=te({},n),f=t&&r||!t&&l!=="post";let p;if(Gn){if(l==="sync"){const b=Cd();p=b.__watcherHandles||(b.__watcherHandles=[])}else if(!f){const b=()=>{};return b.stop=Ue,b.resume=Ue,b.pause=Ue,b}}const m=se;h.call=(b,S,P)=>ze(b,m,S,P);let g=!1;l==="post"?h.scheduler=b=>{he(b,m&&m.suspense)}:l!=="sync"&&(g=!0,h.scheduler=(b,S)=>{S?b():Wo(b)}),h.augmentJob=b=>{t&&(b.flags|=4),g&&(b.flags|=2,m&&(b.id=m.uid,b.i=m))};const w=bd(i,t,h);return Gn&&(p?p.push(w):f&&w()),w}function Ad(i,t,n){const r=this.proxy,o=Bt(i)?i.includes(".")?Ou(r,i):()=>r[i]:i.bind(r,r);let l;ot(t)?l=t:(l=t.handler,n=t);const u=ss(this),h=ku(o,l.bind(r),n);return u(),h}function Ou(i,t){const n=t.split(".");return()=>{let r=i;for(let o=0;o<n.length&&r;o++)r=r[n[o]];return r}}const Ld=Symbol("_vte"),Rd=i=>i.__isTeleport,Id=Symbol("_leaveCb");function Ho(i,t){i.shapeFlag&6&&i.component?(i.transition=t,Ho(i.component.subTree,t)):i.shapeFlag&128?(i.ssContent.transition=t.clone(i.ssContent),i.ssFallback.transition=t.clone(i.ssFallback)):i.transition=t}function Cu(i){i.ids=[i.ids[0]+i.ids[2]+++"-",0,0]}const Ks=new WeakMap;function Dn(i,t,n,r,o=!1){if(st(i)){i.forEach((S,P)=>Dn(S,t&&(st(t)?t[P]:t),n,r,o));return}if(Bn(r)&&!o){r.shapeFlag&512&&r.type.__asyncResolved&&r.component.subTree.component&&Dn(i,t,n,r.component.subTree);return}const l=r.shapeFlag&4?lr(r.component):r.el,u=o?null:l,{i:h,r:f}=i,p=t&&t.r,m=h.refs===Tt?h.refs={}:h.refs,g=h.setupState,w=gt(g),b=g===Tt?Yl:S=>vt(w,S);if(p!=null&&p!==f){if(Qa(t),Bt(p))m[p]=null,b(p)&&(g[p]=null);else if(Qt(p)){p.value=null;const S=t;S.k&&(m[S.k]=null)}}if(ot(f))ns(f,h,12,[u,m]);else{const S=Bt(f),P=Qt(f);if(S||P){const B=()=>{if(i.f){const j=S?b(f)?g[f]:m[f]:f.value;if(o)st(j)&&Ro(j,l);else if(st(j))j.includes(l)||j.push(l);else if(S)m[f]=[l],b(f)&&(g[f]=m[f]);else{const U=[l];f.value=U,i.k&&(m[i.k]=U)}}else S?(m[f]=u,b(f)&&(g[f]=u)):P&&(f.value=u,i.k&&(m[i.k]=u))};if(u){const j=()=>{B(),Ks.delete(i)};j.id=-1,Ks.set(i,j),he(j,n)}else Qa(i),B()}}}function Qa(i){const t=Ks.get(i);t&&(t.flags|=8,Ks.delete(i))}ir().requestIdleCallback;ir().cancelIdleCallback;const Bn=i=>!!i.type.__asyncLoader,Au=i=>i.type.__isKeepAlive;function Md(i,t){Lu(i,"a",t)}function Nd(i,t){Lu(i,"da",t)}function Lu(i,t,n=se){const r=i.__wdc||(i.__wdc=()=>{let o=n;for(;o;){if(o.isDeactivated)return;o=o.parent}return i()});if(rr(t,r,n),n){let o=n.parent;for(;o&&o.parent;)Au(o.parent.vnode)&&jd(r,t,n,o),o=o.parent}}function jd(i,t,n,r){const o=rr(t,i,r,!0);Iu(()=>{Ro(r[t],o)},n)}function rr(i,t,n=se,r=!1){if(n){const o=n[i]||(n[i]=[]),l=t.__weh||(t.__weh=(...u)=>{Xe();const h=ss(n),f=ze(t,n,i,u);return h(),Qe(),f});return r?o.unshift(l):o.push(l),l}}const ei=i=>(t,n=se)=>{(!Gn||i==="sp")&&rr(i,(...r)=>t(...r),n)},Dd=ei("bm"),Ru=ei("m"),Bd=ei("bu"),Ud=ei("u"),$d=ei("bum"),Iu=ei("um"),zd=ei("sp"),Fd=ei("rtg"),Zd=ei("rtc");function Wd(i,t=se){rr("ec",i,t)}const Hd=Symbol.for("v-ndc");function qr(i,t,n,r){let o;const l=n,u=st(i);if(u||Bt(i)){const h=u&&Ii(i);let f=!1,p=!1;h&&(f=!Te(i),p=ti(i),i=nr(i)),o=new Array(i.length);for(let m=0,g=i.length;m<g;m++)o[m]=t(f?p?hn(Ce(i[m])):Ce(i[m]):i[m],m,void 0,l)}else if(typeof i=="number"){o=new Array(i);for(let h=0;h<i;h++)o[h]=t(h+1,h,void 0,l)}else if(kt(i))if(i[Symbol.iterator])o=Array.from(i,(h,f)=>t(h,f,void 0,l));else{const h=Object.keys(i);o=new Array(h.length);for(let f=0,p=h.length;f<p;f++){const m=h[f];o[f]=t(i[m],m,f,l)}}else o=[];return o}const fo=i=>i?Qu(i)?lr(i):fo(i.parent):null,Un=te(Object.create(null),{$:i=>i,$el:i=>i.vnode.el,$data:i=>i.data,$props:i=>i.props,$attrs:i=>i.attrs,$slots:i=>i.slots,$refs:i=>i.refs,$parent:i=>fo(i.parent),$root:i=>fo(i.root),$host:i=>i.ce,$emit:i=>i.emit,$options:i=>Nu(i),$forceUpdate:i=>i.f||(i.f=()=>{Wo(i.update)}),$nextTick:i=>i.n||(i.n=xd.bind(i.proxy)),$watch:i=>Ad.bind(i)}),Kr=(i,t)=>i!==Tt&&!i.__isScriptSetup&&vt(i,t),qd={get({_:i},t){if(t==="__v_skip")return!0;const{ctx:n,setupState:r,data:o,props:l,accessCache:u,type:h,appContext:f}=i;if(t[0]!=="$"){const w=u[t];if(w!==void 0)switch(w){case 1:return r[t];case 2:return o[t];case 4:return n[t];case 3:return l[t]}else{if(Kr(r,t))return u[t]=1,r[t];if(o!==Tt&&vt(o,t))return u[t]=2,o[t];if(vt(l,t))return u[t]=3,l[t];if(n!==Tt&&vt(n,t))return u[t]=4,n[t];po&&(u[t]=0)}}const p=Un[t];let m,g;if(p)return t==="$attrs"&&Xt(i.attrs,"get",""),p(i);if((m=h.__cssModules)&&(m=m[t]))return m;if(n!==Tt&&vt(n,t))return u[t]=4,n[t];if(g=f.config.globalProperties,vt(g,t))return g[t]},set({_:i},t,n){const{data:r,setupState:o,ctx:l}=i;return Kr(o,t)?(o[t]=n,!0):r!==Tt&&vt(r,t)?(r[t]=n,!0):vt(i.props,t)||t[0]==="$"&&t.slice(1)in i?!1:(l[t]=n,!0)},has({_:{data:i,setupState:t,accessCache:n,ctx:r,appContext:o,props:l,type:u}},h){let f;return!!(n[h]||i!==Tt&&h[0]!=="$"&&vt(i,h)||Kr(t,h)||vt(l,h)||vt(r,h)||vt(Un,h)||vt(o.config.globalProperties,h)||(f=u.__cssModules)&&f[h])},defineProperty(i,t,n){return n.get!=null?i._.accessCache[t]=0:vt(n,"value")&&this.set(i,t,n.value,null),Reflect.defineProperty(i,t,n)}};function tl(i){return st(i)?i.reduce((t,n)=>(t[n]=null,t),{}):i}let po=!0;function Kd(i){const t=Nu(i),n=i.proxy,r=i.ctx;po=!1,t.beforeCreate&&el(t.beforeCreate,i,"bc");const{data:o,computed:l,methods:u,watch:h,provide:f,inject:p,created:m,beforeMount:g,mounted:w,beforeUpdate:b,updated:S,activated:P,deactivated:B,beforeDestroy:j,beforeUnmount:U,destroyed:O,unmounted:k,render:H,renderTracked:A,renderTriggered:V,errorCaptured:_t,serverPrefetch:Lt,expose:Ae,inheritAttrs:It,components:Ft,directives:Ni,filters:le}=t;if(p&&Vd(p,r,null),u)for(const wt in u){const K=u[wt];ot(K)&&(r[wt]=K.bind(n))}if(o){const wt=o.call(n,n);kt(wt)&&(i.data=zo(wt))}if(po=!0,l)for(const wt in l){const K=l[wt],Le=ot(K)?K.bind(n,n):ot(K.get)?K.get.bind(n,n):Ue,tt=!ot(K)&&ot(K.set)?K.set.bind(n):Ue,pt=ec({get:Le,set:tt});Object.defineProperty(r,wt,{enumerable:!0,configurable:!0,get:()=>pt.value,set:Et=>pt.value=Et})}if(h)for(const wt in h)Mu(h[wt],r,n,wt);if(f){const wt=ot(f)?f.call(n):f;Reflect.ownKeys(wt).forEach(K=>{kd(K,wt[K])})}m&&el(m,i,"c");function yt(wt,K){st(K)?K.forEach(Le=>wt(Le.bind(n))):K&&wt(K.bind(n))}if(yt(Dd,g),yt(Ru,w),yt(Bd,b),yt(Ud,S),yt(Md,P),yt(Nd,B),yt(Wd,_t),yt(Zd,A),yt(Fd,V),yt($d,U),yt(Iu,k),yt(zd,Lt),st(Ae))if(Ae.length){const wt=i.exposed||(i.exposed={});Ae.forEach(K=>{Object.defineProperty(wt,K,{get:()=>n[K],set:Le=>n[K]=Le,enumerable:!0})})}else i.exposed||(i.exposed={});H&&i.render===Ue&&(i.render=H),It!=null&&(i.inheritAttrs=It),Ft&&(i.components=Ft),Ni&&(i.directives=Ni),Lt&&Cu(i)}function Vd(i,t,n=Ue){st(i)&&(i=_o(i));for(const r in i){const o=i[r];let l;kt(o)?"default"in o?l=zs(o.from||r,o.default,!0):l=zs(o.from||r):l=zs(o),Qt(l)?Object.defineProperty(t,r,{enumerable:!0,configurable:!0,get:()=>l.value,set:u=>l.value=u}):t[r]=l}}function el(i,t,n){ze(st(i)?i.map(r=>r.bind(t.proxy)):i.bind(t.proxy),t,n)}function Mu(i,t,n,r){let o=r.includes(".")?Ou(n,r):()=>n[r];if(Bt(i)){const l=t[i];ot(l)&&Hr(o,l)}else if(ot(i))Hr(o,i.bind(n));else if(kt(i))if(st(i))i.forEach(l=>Mu(l,t,n,r));else{const l=ot(i.handler)?i.handler.bind(n):t[i.handler];ot(l)&&Hr(o,l,i)}}function Nu(i){const t=i.type,{mixins:n,extends:r}=t,{mixins:o,optionsCache:l,config:{optionMergeStrategies:u}}=i.appContext,h=l.get(t);let f;return h?f=h:!o.length&&!n&&!r?f=t:(f={},o.length&&o.forEach(p=>Vs(f,p,u,!0)),Vs(f,t,u)),kt(t)&&l.set(t,f),f}function Vs(i,t,n,r=!1){const{mixins:o,extends:l}=t;l&&Vs(i,l,n,!0),o&&o.forEach(u=>Vs(i,u,n,!0));for(const u in t)if(!(r&&u==="expose")){const h=Gd[u]||n&&n[u];i[u]=h?h(i[u],t[u]):t[u]}return i}const Gd={data:il,props:nl,emits:nl,methods:An,computed:An,beforeCreate:ie,created:ie,beforeMount:ie,mounted:ie,beforeUpdate:ie,updated:ie,beforeDestroy:ie,beforeUnmount:ie,destroyed:ie,unmounted:ie,activated:ie,deactivated:ie,errorCaptured:ie,serverPrefetch:ie,components:An,directives:An,watch:Yd,provide:il,inject:Jd};function il(i,t){return t?i?function(){return te(ot(i)?i.call(this,this):i,ot(t)?t.call(this,this):t)}:t:i}function Jd(i,t){return An(_o(i),_o(t))}function _o(i){if(st(i)){const t={};for(let n=0;n<i.length;n++)t[i[n]]=i[n];return t}return i}function ie(i,t){return i?[...new Set([].concat(i,t))]:t}function An(i,t){return i?te(Object.create(null),i,t):t}function nl(i,t){return i?st(i)&&st(t)?[...new Set([...i,...t])]:te(Object.create(null),tl(i),tl(t??{})):t}function Yd(i,t){if(!i)return t;if(!t)return i;const n=te(Object.create(null),i);for(const r in t)n[r]=ie(i[r],t[r]);return n}function ju(){return{app:null,config:{isNativeTag:Yl,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Xd=0;function Qd(i,t){return function(r,o=null){ot(r)||(r=te({},r)),o!=null&&!kt(o)&&(o=null);const l=ju(),u=new WeakSet,h=[];let f=!1;const p=l.app={_uid:Xd++,_component:r,_props:o,_container:null,_context:l,_instance:null,version:If,get config(){return l.config},set config(m){},use(m,...g){return u.has(m)||(m&&ot(m.install)?(u.add(m),m.install(p,...g)):ot(m)&&(u.add(m),m(p,...g))),p},mixin(m){return l.mixins.includes(m)||l.mixins.push(m),p},component(m,g){return g?(l.components[m]=g,p):l.components[m]},directive(m,g){return g?(l.directives[m]=g,p):l.directives[m]},mount(m,g,w){if(!f){const b=p._ceVNode||$e(r,o);return b.appContext=l,w===!0?w="svg":w===!1&&(w=void 0),i(b,m,w),f=!0,p._container=m,m.__vue_app__=p,lr(b.component)}},onUnmount(m){h.push(m)},unmount(){f&&(ze(h,p._instance,16),i(null,p._container),delete p._container.__vue_app__)},provide(m,g){return l.provides[m]=g,p},runWithContext(m){const g=un;un=p;try{return m()}finally{un=g}}};return p}}let un=null;const tf=(i,t)=>t==="modelValue"||t==="model-value"?i.modelModifiers:i[`${t}Modifiers`]||i[`${pi(t)}Modifiers`]||i[`${Mi(t)}Modifiers`];function ef(i,t,...n){if(i.isUnmounted)return;const r=i.vnode.props||Tt;let o=n;const l=t.startsWith("update:"),u=l&&tf(r,t.slice(7));u&&(u.trim&&(o=n.map(m=>Bt(m)?m.trim():m)),u.number&&(o=n.map(Mo)));let h,f=r[h=$r(t)]||r[h=$r(pi(t))];!f&&l&&(f=r[h=$r(Mi(t))]),f&&ze(f,i,6,o);const p=r[h+"Once"];if(p){if(!i.emitted)i.emitted={};else if(i.emitted[h])return;i.emitted[h]=!0,ze(p,i,6,o)}}const nf=new WeakMap;function Du(i,t,n=!1){const r=n?nf:t.emitsCache,o=r.get(i);if(o!==void 0)return o;const l=i.emits;let u={},h=!1;if(!ot(i)){const f=p=>{const m=Du(p,t,!0);m&&(h=!0,te(u,m))};!n&&t.mixins.length&&t.mixins.forEach(f),i.extends&&f(i.extends),i.mixins&&i.mixins.forEach(f)}return!l&&!h?(kt(i)&&r.set(i,null),null):(st(l)?l.forEach(f=>u[f]=null):te(u,l),kt(i)&&r.set(i,u),u)}function or(i,t){return!i||!Qs(t)?!1:(t=t.slice(2).replace(/Once$/,""),vt(i,t[0].toLowerCase()+t.slice(1))||vt(i,Mi(t))||vt(i,t))}function sl(i){const{type:t,vnode:n,proxy:r,withProxy:o,propsOptions:[l],slots:u,attrs:h,emit:f,render:p,renderCache:m,props:g,data:w,setupState:b,ctx:S,inheritAttrs:P}=i,B=qs(i);let j,U;try{if(n.shapeFlag&4){const k=o||r,H=k;j=Be(p.call(H,k,m,g,b,w,S)),U=h}else{const k=t;j=Be(k.length>1?k(g,{attrs:h,slots:u,emit:f}):k(g,null)),U=t.props?h:sf(h)}}catch(k){$n.length=0,sr(k,i,1),j=$e(_i)}let O=j;if(U&&P!==!1){const k=Object.keys(U),{shapeFlag:H}=O;k.length&&H&7&&(l&&k.some(Lo)&&(U=rf(U,l)),O=dn(O,U,!1,!0))}return n.dirs&&(O=dn(O,null,!1,!0),O.dirs=O.dirs?O.dirs.concat(n.dirs):n.dirs),n.transition&&Ho(O,n.transition),j=O,qs(B),j}const sf=i=>{let t;for(const n in i)(n==="class"||n==="style"||Qs(n))&&((t||(t={}))[n]=i[n]);return t},rf=(i,t)=>{const n={};for(const r in i)(!Lo(r)||!(r.slice(9)in t))&&(n[r]=i[r]);return n};function of(i,t,n){const{props:r,children:o,component:l}=i,{props:u,children:h,patchFlag:f}=t,p=l.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&f>=0){if(f&1024)return!0;if(f&16)return r?rl(r,u,p):!!u;if(f&8){const m=t.dynamicProps;for(let g=0;g<m.length;g++){const w=m[g];if(u[w]!==r[w]&&!or(p,w))return!0}}}else return(o||h)&&(!h||!h.$stable)?!0:r===u?!1:r?u?rl(r,u,p):!0:!!u;return!1}function rl(i,t,n){const r=Object.keys(t);if(r.length!==Object.keys(i).length)return!0;for(let o=0;o<r.length;o++){const l=r[o];if(t[l]!==i[l]&&!or(n,l))return!0}return!1}function af({vnode:i,parent:t},n){for(;t;){const r=t.subTree;if(r.suspense&&r.suspense.activeBranch===i&&(r.el=i.el),r===i)(i=t.vnode).el=n,t=t.parent;else break}}const Bu={},Uu=()=>Object.create(Bu),$u=i=>Object.getPrototypeOf(i)===Bu;function lf(i,t,n,r=!1){const o={},l=Uu();i.propsDefaults=Object.create(null),zu(i,t,o,l);for(const u in i.propsOptions[0])u in o||(o[u]=void 0);n?i.props=r?o:dd(o):i.type.props?i.props=o:i.props=l,i.attrs=l}function uf(i,t,n,r){const{props:o,attrs:l,vnode:{patchFlag:u}}=i,h=gt(o),[f]=i.propsOptions;let p=!1;if((r||u>0)&&!(u&16)){if(u&8){const m=i.vnode.dynamicProps;for(let g=0;g<m.length;g++){let w=m[g];if(or(i.emitsOptions,w))continue;const b=t[w];if(f)if(vt(l,w))b!==l[w]&&(l[w]=b,p=!0);else{const S=pi(w);o[S]=mo(f,h,S,b,i,!1)}else b!==l[w]&&(l[w]=b,p=!0)}}}else{zu(i,t,o,l)&&(p=!0);let m;for(const g in h)(!t||!vt(t,g)&&((m=Mi(g))===g||!vt(t,m)))&&(f?n&&(n[g]!==void 0||n[m]!==void 0)&&(o[g]=mo(f,h,g,void 0,i,!0)):delete o[g]);if(l!==h)for(const g in l)(!t||!vt(t,g))&&(delete l[g],p=!0)}p&&Je(i.attrs,"set","")}function zu(i,t,n,r){const[o,l]=i.propsOptions;let u=!1,h;if(t)for(let f in t){if(Mn(f))continue;const p=t[f];let m;o&&vt(o,m=pi(f))?!l||!l.includes(m)?n[m]=p:(h||(h={}))[m]=p:or(i.emitsOptions,f)||(!(f in r)||p!==r[f])&&(r[f]=p,u=!0)}if(l){const f=gt(n),p=h||Tt;for(let m=0;m<l.length;m++){const g=l[m];n[g]=mo(o,f,g,p[g],i,!vt(p,g))}}return u}function mo(i,t,n,r,o,l){const u=i[n];if(u!=null){const h=vt(u,"default");if(h&&r===void 0){const f=u.default;if(u.type!==Function&&!u.skipFactory&&ot(f)){const{propsDefaults:p}=o;if(n in p)r=p[n];else{const m=ss(o);r=p[n]=f.call(null,t),m()}}else r=f;o.ce&&o.ce._setProp(n,r)}u[0]&&(l&&!h?r=!1:u[1]&&(r===""||r===Mi(n))&&(r=!0))}return r}const cf=new WeakMap;function Fu(i,t,n=!1){const r=n?cf:t.propsCache,o=r.get(i);if(o)return o;const l=i.props,u={},h=[];let f=!1;if(!ot(i)){const m=g=>{f=!0;const[w,b]=Fu(g,t,!0);te(u,w),b&&h.push(...b)};!n&&t.mixins.length&&t.mixins.forEach(m),i.extends&&m(i.extends),i.mixins&&i.mixins.forEach(m)}if(!l&&!f)return kt(i)&&r.set(i,on),on;if(st(l))for(let m=0;m<l.length;m++){const g=pi(l[m]);ol(g)&&(u[g]=Tt)}else if(l)for(const m in l){const g=pi(m);if(ol(g)){const w=l[m],b=u[g]=st(w)||ot(w)?{type:w}:te({},w),S=b.type;let P=!1,B=!0;if(st(S))for(let j=0;j<S.length;++j){const U=S[j],O=ot(U)&&U.name;if(O==="Boolean"){P=!0;break}else O==="String"&&(B=!1)}else P=ot(S)&&S.name==="Boolean";b[0]=P,b[1]=B,(P||vt(b,"default"))&&h.push(g)}}const p=[u,h];return kt(i)&&r.set(i,p),p}function ol(i){return i[0]!=="$"&&!Mn(i)}const qo=i=>i==="_"||i==="_ctx"||i==="$stable",Ko=i=>st(i)?i.map(Be):[Be(i)],hf=(i,t,n)=>{if(t._n)return t;const r=Ed((...o)=>Ko(t(...o)),n);return r._c=!1,r},Zu=(i,t,n)=>{const r=i._ctx;for(const o in i){if(qo(o))continue;const l=i[o];if(ot(l))t[o]=hf(o,l,r);else if(l!=null){const u=Ko(l);t[o]=()=>u}}},Wu=(i,t)=>{const n=Ko(t);i.slots.default=()=>n},Hu=(i,t,n)=>{for(const r in t)(n||!qo(r))&&(i[r]=t[r])},df=(i,t,n)=>{const r=i.slots=Uu();if(i.vnode.shapeFlag&32){const o=t._;o?(Hu(r,t,n),n&&nu(r,"_",o,!0)):Zu(t,r)}else t&&Wu(i,t)},ff=(i,t,n)=>{const{vnode:r,slots:o}=i;let l=!0,u=Tt;if(r.shapeFlag&32){const h=t._;h?n&&h===1?l=!1:Hu(o,t,n):(l=!t.$stable,Zu(t,o)),u=t}else t&&(Wu(i,t),u={default:1});if(l)for(const h in o)!qo(h)&&u[h]==null&&delete o[h]},he=vf;function pf(i){return _f(i)}function _f(i,t){const n=ir();n.__VUE__=!0;const{insert:r,remove:o,patchProp:l,createElement:u,createText:h,createComment:f,setText:p,setElementText:m,parentNode:g,nextSibling:w,setScopeId:b=Ue,insertStaticContent:S}=i,P=(v,T,C,D=null,I=null,M=null,Z=void 0,F=null,z=!!T.dynamicChildren)=>{if(v===T)return;v&&!On(v,T)&&(D=re(v),Et(v,I,M,!0),v=null),T.patchFlag===-2&&(z=!1,T.dynamicChildren=null);const{type:N,ref:X,shapeFlag:W}=T;switch(N){case ar:B(v,T,C,D);break;case _i:j(v,T,C,D);break;case Gr:v==null&&U(T,C,D,Z);break;case de:Ft(v,T,C,D,I,M,Z,F,z);break;default:W&1?H(v,T,C,D,I,M,Z,F,z):W&6?Ni(v,T,C,D,I,M,Z,F,z):(W&64||W&128)&&N.process(v,T,C,D,I,M,Z,F,z,Fe)}X!=null&&I?Dn(X,v&&v.ref,M,T||v,!T):X==null&&v&&v.ref!=null&&Dn(v.ref,null,M,v,!0)},B=(v,T,C,D)=>{if(v==null)r(T.el=h(T.children),C,D);else{const I=T.el=v.el;T.children!==v.children&&p(I,T.children)}},j=(v,T,C,D)=>{v==null?r(T.el=f(T.children||""),C,D):T.el=v.el},U=(v,T,C,D)=>{[v.el,v.anchor]=S(v.children,T,C,D,v.el,v.anchor)},O=({el:v,anchor:T},C,D)=>{let I;for(;v&&v!==T;)I=w(v),r(v,C,D),v=I;r(T,C,D)},k=({el:v,anchor:T})=>{let C;for(;v&&v!==T;)C=w(v),o(v),v=C;o(T)},H=(v,T,C,D,I,M,Z,F,z)=>{if(T.type==="svg"?Z="svg":T.type==="math"&&(Z="mathml"),v==null)A(T,C,D,I,M,Z,F,z);else{const N=v.el&&v.el._isVueCE?v.el:null;try{N&&N._beginPatch(),Lt(v,T,I,M,Z,F,z)}finally{N&&N._endPatch()}}},A=(v,T,C,D,I,M,Z,F)=>{let z,N;const{props:X,shapeFlag:W,transition:Y,dirs:nt}=v;if(z=v.el=u(v.type,M,X&&X.is,X),W&8?m(z,v.children):W&16&&_t(v.children,z,null,D,I,Vr(v,M),Z,F),nt&&Ti(v,null,D,"created"),V(z,v,v.scopeId,Z,D),X){for(const bt in X)bt!=="value"&&!Mn(bt)&&l(z,bt,null,X[bt],M,D);"value"in X&&l(z,"value",null,X.value,M),(N=X.onVnodeBeforeMount)&&je(N,D,v)}nt&&Ti(v,null,D,"beforeMount");const ut=mf(I,Y);ut&&Y.beforeEnter(z),r(z,T,C),((N=X&&X.onVnodeMounted)||ut||nt)&&he(()=>{N&&je(N,D,v),ut&&Y.enter(z),nt&&Ti(v,null,D,"mounted")},I)},V=(v,T,C,D,I)=>{if(C&&b(v,C),D)for(let M=0;M<D.length;M++)b(v,D[M]);if(I){let M=I.subTree;if(T===M||Gu(M.type)&&(M.ssContent===T||M.ssFallback===T)){const Z=I.vnode;V(v,Z,Z.scopeId,Z.slotScopeIds,I.parent)}}},_t=(v,T,C,D,I,M,Z,F,z=0)=>{for(let N=z;N<v.length;N++){const X=v[N]=F?ui(v[N]):Be(v[N]);P(null,X,T,C,D,I,M,Z,F)}},Lt=(v,T,C,D,I,M,Z)=>{const F=T.el=v.el;let{patchFlag:z,dynamicChildren:N,dirs:X}=T;z|=v.patchFlag&16;const W=v.props||Tt,Y=T.props||Tt;let nt;if(C&&xi(C,!1),(nt=Y.onVnodeBeforeUpdate)&&je(nt,C,T,v),X&&Ti(T,v,C,"beforeUpdate"),C&&xi(C,!0),(W.innerHTML&&Y.innerHTML==null||W.textContent&&Y.textContent==null)&&m(F,""),N?Ae(v.dynamicChildren,N,F,C,D,Vr(T,I),M):Z||K(v,T,F,null,C,D,Vr(T,I),M,!1),z>0){if(z&16)It(F,W,Y,C,I);else if(z&2&&W.class!==Y.class&&l(F,"class",null,Y.class,I),z&4&&l(F,"style",W.style,Y.style,I),z&8){const ut=T.dynamicProps;for(let bt=0;bt<ut.length;bt++){const dt=ut[bt],Jt=W[dt],Wt=Y[dt];(Wt!==Jt||dt==="value")&&l(F,dt,Jt,Wt,I,C)}}z&1&&v.children!==T.children&&m(F,T.children)}else!Z&&N==null&&It(F,W,Y,C,I);((nt=Y.onVnodeUpdated)||X)&&he(()=>{nt&&je(nt,C,T,v),X&&Ti(T,v,C,"updated")},D)},Ae=(v,T,C,D,I,M,Z)=>{for(let F=0;F<T.length;F++){const z=v[F],N=T[F],X=z.el&&(z.type===de||!On(z,N)||z.shapeFlag&198)?g(z.el):C;P(z,N,X,null,D,I,M,Z,!0)}},It=(v,T,C,D,I)=>{if(T!==C){if(T!==Tt)for(const M in T)!Mn(M)&&!(M in C)&&l(v,M,T[M],null,I,D);for(const M in C){if(Mn(M))continue;const Z=C[M],F=T[M];Z!==F&&M!=="value"&&l(v,M,F,Z,I,D)}"value"in C&&l(v,"value",T.value,C.value,I)}},Ft=(v,T,C,D,I,M,Z,F,z)=>{const N=T.el=v?v.el:h(""),X=T.anchor=v?v.anchor:h("");let{patchFlag:W,dynamicChildren:Y,slotScopeIds:nt}=T;nt&&(F=F?F.concat(nt):nt),v==null?(r(N,C,D),r(X,C,D),_t(T.children||[],C,X,I,M,Z,F,z)):W>0&&W&64&&Y&&v.dynamicChildren&&v.dynamicChildren.length===Y.length?(Ae(v.dynamicChildren,Y,C,I,M,Z,F),(T.key!=null||I&&T===I.subTree)&&qu(v,T,!0)):K(v,T,C,X,I,M,Z,F,z)},Ni=(v,T,C,D,I,M,Z,F,z)=>{T.slotScopeIds=F,v==null?T.shapeFlag&512?I.ctx.activate(T,C,D,Z,z):le(T,C,D,I,M,Z,z):os(v,T,z)},le=(v,T,C,D,I,M,Z)=>{const F=v.component=Ef(v,D,I);if(Au(v)&&(F.ctx.renderer=Fe),Of(F,!1,Z),F.asyncDep){if(I&&I.registerDep(F,yt,Z),!v.el){const z=F.subTree=$e(_i);j(null,z,T,C),v.placeholder=z.el}}else yt(F,v,T,C,I,M,Z)},os=(v,T,C)=>{const D=T.component=v.component;if(of(v,T,C))if(D.asyncDep&&!D.asyncResolved){wt(D,T,C);return}else D.next=T,D.update();else T.el=v.el,D.vnode=T},yt=(v,T,C,D,I,M,Z)=>{const F=()=>{if(v.isMounted){let{next:W,bu:Y,u:nt,parent:ut,vnode:bt}=v;{const me=Ku(v);if(me){W&&(W.el=bt.el,wt(v,W,Z)),me.asyncDep.then(()=>{v.isUnmounted||F()});return}}let dt=W,Jt;xi(v,!1),W?(W.el=bt.el,wt(v,W,Z)):W=bt,Y&&$s(Y),(Jt=W.props&&W.props.onVnodeBeforeUpdate)&&je(Jt,ut,W,bt),xi(v,!0);const Wt=sl(v),ue=v.subTree;v.subTree=Wt,P(ue,Wt,g(ue.el),re(ue),v,I,M),W.el=Wt.el,dt===null&&af(v,Wt.el),nt&&he(nt,I),(Jt=W.props&&W.props.onVnodeUpdated)&&he(()=>je(Jt,ut,W,bt),I)}else{let W;const{el:Y,props:nt}=T,{bm:ut,m:bt,parent:dt,root:Jt,type:Wt}=v,ue=Bn(T);xi(v,!1),ut&&$s(ut),!ue&&(W=nt&&nt.onVnodeBeforeMount)&&je(W,dt,T),xi(v,!0);{Jt.ce&&Jt.ce._def.shadowRoot!==!1&&Jt.ce._injectChildStyle(Wt);const me=v.subTree=sl(v);P(null,me,C,D,v,I,M),T.el=me.el}if(bt&&he(bt,I),!ue&&(W=nt&&nt.onVnodeMounted)){const me=T;he(()=>je(W,dt,me),I)}(T.shapeFlag&256||dt&&Bn(dt.vnode)&&dt.vnode.shapeFlag&256)&&v.a&&he(v.a,I),v.isMounted=!0,T=C=D=null}};v.scope.on();const z=v.effect=new au(F);v.scope.off();const N=v.update=z.run.bind(z),X=v.job=z.runIfDirty.bind(z);X.i=v,X.id=v.uid,z.scheduler=()=>Wo(X),xi(v,!0),N()},wt=(v,T,C)=>{T.component=v;const D=v.vnode.props;v.vnode=T,v.next=null,uf(v,T.props,D,C),ff(v,T.children,C),Xe(),Xa(v),Qe()},K=(v,T,C,D,I,M,Z,F,z=!1)=>{const N=v&&v.children,X=v?v.shapeFlag:0,W=T.children,{patchFlag:Y,shapeFlag:nt}=T;if(Y>0){if(Y&128){tt(N,W,C,D,I,M,Z,F,z);return}else if(Y&256){Le(N,W,C,D,I,M,Z,F,z);return}}nt&8?(X&16&&at(N,I,M),W!==N&&m(C,W)):X&16?nt&16?tt(N,W,C,D,I,M,Z,F,z):at(N,I,M,!0):(X&8&&m(C,""),nt&16&&_t(W,C,D,I,M,Z,F,z))},Le=(v,T,C,D,I,M,Z,F,z)=>{v=v||on,T=T||on;const N=v.length,X=T.length,W=Math.min(N,X);let Y;for(Y=0;Y<W;Y++){const nt=T[Y]=z?ui(T[Y]):Be(T[Y]);P(v[Y],nt,C,null,I,M,Z,F,z)}N>X?at(v,I,M,!0,!1,W):_t(T,C,D,I,M,Z,F,z,W)},tt=(v,T,C,D,I,M,Z,F,z)=>{let N=0;const X=T.length;let W=v.length-1,Y=X-1;for(;N<=W&&N<=Y;){const nt=v[N],ut=T[N]=z?ui(T[N]):Be(T[N]);if(On(nt,ut))P(nt,ut,C,null,I,M,Z,F,z);else break;N++}for(;N<=W&&N<=Y;){const nt=v[W],ut=T[Y]=z?ui(T[Y]):Be(T[Y]);if(On(nt,ut))P(nt,ut,C,null,I,M,Z,F,z);else break;W--,Y--}if(N>W){if(N<=Y){const nt=Y+1,ut=nt<X?T[nt].el:D;for(;N<=Y;)P(null,T[N]=z?ui(T[N]):Be(T[N]),C,ut,I,M,Z,F,z),N++}}else if(N>Y)for(;N<=W;)Et(v[N],I,M,!0),N++;else{const nt=N,ut=N,bt=new Map;for(N=ut;N<=Y;N++){const Yt=T[N]=z?ui(T[N]):Be(T[N]);Yt.key!=null&&bt.set(Yt.key,N)}let dt,Jt=0;const Wt=Y-ut+1;let ue=!1,me=0;const ni=new Array(Wt);for(N=0;N<Wt;N++)ni[N]=0;for(N=nt;N<=W;N++){const Yt=v[N];if(Jt>=Wt){Et(Yt,I,M,!0);continue}let ge;if(Yt.key!=null)ge=bt.get(Yt.key);else for(dt=ut;dt<=Y;dt++)if(ni[dt-ut]===0&&On(Yt,T[dt])){ge=dt;break}ge===void 0?Et(Yt,I,M,!0):(ni[ge-ut]=N+1,ge>=me?me=ge:ue=!0,P(Yt,T[ge],C,null,I,M,Z,F,z),Jt++)}const ji=ue?gf(ni):on;for(dt=ji.length-1,N=Wt-1;N>=0;N--){const Yt=ut+N,ge=T[Yt],si=T[Yt+1],ls=Yt+1<X?si.el||Vu(si):D;ni[N]===0?P(null,ge,C,ls,I,M,Z,F,z):ue&&(dt<0||N!==ji[dt]?pt(ge,C,ls,2):dt--)}}},pt=(v,T,C,D,I=null)=>{const{el:M,type:Z,transition:F,children:z,shapeFlag:N}=v;if(N&6){pt(v.component.subTree,T,C,D);return}if(N&128){v.suspense.move(T,C,D);return}if(N&64){Z.move(v,T,C,Fe);return}if(Z===de){r(M,T,C);for(let W=0;W<z.length;W++)pt(z[W],T,C,D);r(v.anchor,T,C);return}if(Z===Gr){O(v,T,C);return}if(D!==2&&N&1&&F)if(D===0)F.beforeEnter(M),r(M,T,C),he(()=>F.enter(M),I);else{const{leave:W,delayLeave:Y,afterLeave:nt}=F,ut=()=>{v.ctx.isUnmounted?o(M):r(M,T,C)},bt=()=>{M._isLeaving&&M[Id](!0),W(M,()=>{ut(),nt&&nt()})};Y?Y(M,ut,bt):bt()}else r(M,T,C)},Et=(v,T,C,D=!1,I=!1)=>{const{type:M,props:Z,ref:F,children:z,dynamicChildren:N,shapeFlag:X,patchFlag:W,dirs:Y,cacheIndex:nt}=v;if(W===-2&&(I=!1),F!=null&&(Xe(),Dn(F,null,C,v,!0),Qe()),nt!=null&&(T.renderCache[nt]=void 0),X&256){T.ctx.deactivate(v);return}const ut=X&1&&Y,bt=!Bn(v);let dt;if(bt&&(dt=Z&&Z.onVnodeBeforeUnmount)&&je(dt,T,v),X&6)mt(v.component,C,D);else{if(X&128){v.suspense.unmount(C,D);return}ut&&Ti(v,null,T,"beforeUnmount"),X&64?v.type.remove(v,T,C,Fe,D):N&&!N.hasOnce&&(M!==de||W>0&&W&64)?at(N,T,C,!1,!0):(M===de&&W&384||!I&&X&16)&&at(z,T,C),D&&Zt(v)}(bt&&(dt=Z&&Z.onVnodeUnmounted)||ut)&&he(()=>{dt&&je(dt,T,v),ut&&Ti(v,null,T,"unmounted")},C)},Zt=v=>{const{type:T,el:C,anchor:D,transition:I}=v;if(T===de){Ct(C,D);return}if(T===Gr){k(v);return}const M=()=>{o(C),I&&!I.persisted&&I.afterLeave&&I.afterLeave()};if(v.shapeFlag&1&&I&&!I.persisted){const{leave:Z,delayLeave:F}=I,z=()=>Z(C,M);F?F(v.el,M,z):z()}else M()},Ct=(v,T)=>{let C;for(;v!==T;)C=w(v),o(v),v=C;o(T)},mt=(v,T,C)=>{const{bum:D,scope:I,job:M,subTree:Z,um:F,m:z,a:N}=v;al(z),al(N),D&&$s(D),I.stop(),M&&(M.flags|=8,Et(Z,v,T,C)),F&&he(F,T),he(()=>{v.isUnmounted=!0},T)},at=(v,T,C,D=!1,I=!1,M=0)=>{for(let Z=M;Z<v.length;Z++)Et(v[Z],T,C,D,I)},re=v=>{if(v.shapeFlag&6)return re(v.component.subTree);if(v.shapeFlag&128)return v.suspense.next();const T=w(v.anchor||v.el),C=T&&T[Ld];return C?w(C):T};let _e=!1;const pn=(v,T,C)=>{let D;v==null?T._vnode&&(Et(T._vnode,null,null,!0),D=T._vnode.component):P(T._vnode||null,v,T,null,null,null,C),T._vnode=v,_e||(_e=!0,Xa(D),Su(),_e=!1)},Fe={p:P,um:Et,m:pt,r:Zt,mt:le,mc:_t,pc:K,pbc:Ae,n:re,o:i};return{render:pn,hydrate:void 0,createApp:Qd(pn)}}function Vr({type:i,props:t},n){return n==="svg"&&i==="foreignObject"||n==="mathml"&&i==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:n}function xi({effect:i,job:t},n){n?(i.flags|=32,t.flags|=4):(i.flags&=-33,t.flags&=-5)}function mf(i,t){return(!i||i&&!i.pendingBranch)&&t&&!t.persisted}function qu(i,t,n=!1){const r=i.children,o=t.children;if(st(r)&&st(o))for(let l=0;l<r.length;l++){const u=r[l];let h=o[l];h.shapeFlag&1&&!h.dynamicChildren&&((h.patchFlag<=0||h.patchFlag===32)&&(h=o[l]=ui(o[l]),h.el=u.el),!n&&h.patchFlag!==-2&&qu(u,h)),h.type===ar&&(h.patchFlag!==-1?h.el=u.el:h.__elIndex=l+(i.type===de?1:0)),h.type===_i&&!h.el&&(h.el=u.el)}}function gf(i){const t=i.slice(),n=[0];let r,o,l,u,h;const f=i.length;for(r=0;r<f;r++){const p=i[r];if(p!==0){if(o=n[n.length-1],i[o]<p){t[r]=o,n.push(r);continue}for(l=0,u=n.length-1;l<u;)h=l+u>>1,i[n[h]]<p?l=h+1:u=h;p<i[n[l]]&&(l>0&&(t[r]=n[l-1]),n[l]=r)}}for(l=n.length,u=n[l-1];l-- >0;)n[l]=u,u=t[u];return n}function Ku(i){const t=i.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:Ku(t)}function al(i){if(i)for(let t=0;t<i.length;t++)i[t].flags|=8}function Vu(i){if(i.placeholder)return i.placeholder;const t=i.component;return t?Vu(t.subTree):null}const Gu=i=>i.__isSuspense;function vf(i,t){t&&t.pendingBranch?st(i)?t.effects.push(...i):t.effects.push(i):Pd(i)}const de=Symbol.for("v-fgt"),ar=Symbol.for("v-txt"),_i=Symbol.for("v-cmt"),Gr=Symbol.for("v-stc"),$n=[];let pe=null;function jt(i=!1){$n.push(pe=i?null:[])}function yf(){$n.pop(),pe=$n[$n.length-1]||null}let Vn=1;function ll(i,t=!1){Vn+=i,i<0&&pe&&t&&(pe.hasOnce=!0)}function Ju(i){return i.dynamicChildren=Vn>0?pe||on:null,yf(),Vn>0&&pe&&pe.push(i),i}function $t(i,t,n,r,o,l){return Ju($(i,t,n,r,o,l,!0))}function wf(i,t,n,r,o){return Ju($e(i,t,n,r,o,!0))}function Yu(i){return i?i.__v_isVNode===!0:!1}function On(i,t){return i.type===t.type&&i.key===t.key}const Xu=({key:i})=>i??null,Fs=({ref:i,ref_key:t,ref_for:n})=>(typeof i=="number"&&(i=""+i),i!=null?Bt(i)||Qt(i)||ot(i)?{i:be,r:i,k:t,f:!!n}:i:null);function $(i,t=null,n=null,r=0,o=null,l=i===de?0:1,u=!1,h=!1){const f={__v_isVNode:!0,__v_skip:!0,type:i,props:t,key:t&&Xu(t),ref:t&&Fs(t),scopeId:Eu,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:l,patchFlag:r,dynamicProps:o,dynamicChildren:null,appContext:null,ctx:be};return h?(Vo(f,n),l&128&&i.normalize(f)):n&&(f.shapeFlag|=Bt(n)?8:16),Vn>0&&!u&&pe&&(f.patchFlag>0||l&6)&&f.patchFlag!==32&&pe.push(f),f}const $e=bf;function bf(i,t=null,n=null,r=0,o=null,l=!1){if((!i||i===Hd)&&(i=_i),Yu(i)){const h=dn(i,t,!0);return n&&Vo(h,n),Vn>0&&!l&&pe&&(h.shapeFlag&6?pe[pe.indexOf(i)]=h:pe.push(h)),h.patchFlag=-2,h}if(Rf(i)&&(i=i.__vccOpts),t){t=Tf(t);let{class:h,style:f}=t;h&&!Bt(h)&&(t.class=Wn(h)),kt(f)&&(Zo(f)&&!st(f)&&(f=te({},f)),t.style=No(f))}const u=Bt(i)?1:Gu(i)?128:Rd(i)?64:kt(i)?4:ot(i)?2:0;return $(i,t,n,r,o,u,l,!0)}function Tf(i){return i?Zo(i)||$u(i)?te({},i):i:null}function dn(i,t,n=!1,r=!1){const{props:o,ref:l,patchFlag:u,children:h,transition:f}=i,p=t?xf(o||{},t):o,m={__v_isVNode:!0,__v_skip:!0,type:i.type,props:p,key:p&&Xu(p),ref:t&&t.ref?n&&l?st(l)?l.concat(Fs(t)):[l,Fs(t)]:Fs(t):l,scopeId:i.scopeId,slotScopeIds:i.slotScopeIds,children:h,target:i.target,targetStart:i.targetStart,targetAnchor:i.targetAnchor,staticCount:i.staticCount,shapeFlag:i.shapeFlag,patchFlag:t&&i.type!==de?u===-1?16:u|16:u,dynamicProps:i.dynamicProps,dynamicChildren:i.dynamicChildren,appContext:i.appContext,dirs:i.dirs,transition:f,component:i.component,suspense:i.suspense,ssContent:i.ssContent&&dn(i.ssContent),ssFallback:i.ssFallback&&dn(i.ssFallback),placeholder:i.placeholder,el:i.el,anchor:i.anchor,ctx:i.ctx,ce:i.ce};return f&&r&&Ho(m,f.clone(m)),m}function zn(i=" ",t=0){return $e(ar,null,i,t)}function di(i="",t=!1){return t?(jt(),wf(_i,null,i)):$e(_i,null,i)}function Be(i){return i==null||typeof i=="boolean"?$e(_i):st(i)?$e(de,null,i.slice()):Yu(i)?ui(i):$e(ar,null,String(i))}function ui(i){return i.el===null&&i.patchFlag!==-1||i.memo?i:dn(i)}function Vo(i,t){let n=0;const{shapeFlag:r}=i;if(t==null)t=null;else if(st(t))n=16;else if(typeof t=="object")if(r&65){const o=t.default;o&&(o._c&&(o._d=!1),Vo(i,o()),o._c&&(o._d=!0));return}else{n=32;const o=t._;!o&&!$u(t)?t._ctx=be:o===3&&be&&(be.slots._===1?t._=1:(t._=2,i.patchFlag|=1024))}else ot(t)?(t={default:t,_ctx:be},n=32):(t=String(t),r&64?(n=16,t=[zn(t)]):n=8);i.children=t,i.shapeFlag|=n}function xf(...i){const t={};for(let n=0;n<i.length;n++){const r=i[n];for(const o in r)if(o==="class")t.class!==r.class&&(t.class=Wn([t.class,r.class]));else if(o==="style")t.style=No([t.style,r.style]);else if(Qs(o)){const l=t[o],u=r[o];u&&l!==u&&!(st(l)&&l.includes(u))&&(t[o]=l?[].concat(l,u):u)}else o!==""&&(t[o]=r[o])}return t}function je(i,t,n,r=null){ze(i,t,7,[n,r])}const Sf=ju();let Pf=0;function Ef(i,t,n){const r=i.type,o=(t?t.appContext:i.appContext)||Sf,l={uid:Pf++,vnode:i,type:r,parent:t,appContext:o,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new qh(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(o.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Fu(r,o),emitsOptions:Du(r,o),emit:null,emitted:null,propsDefaults:Tt,inheritAttrs:r.inheritAttrs,ctx:Tt,data:Tt,props:Tt,attrs:Tt,slots:Tt,refs:Tt,setupState:Tt,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return l.ctx={_:l},l.root=t?t.root:l,l.emit=ef.bind(null,l),i.ce&&i.ce(l),l}let se=null;const kf=()=>se||be;let Gs,go;{const i=ir(),t=(n,r)=>{let o;return(o=i[n])||(o=i[n]=[]),o.push(r),l=>{o.length>1?o.forEach(u=>u(l)):o[0](l)}};Gs=t("__VUE_INSTANCE_SETTERS__",n=>se=n),go=t("__VUE_SSR_SETTERS__",n=>Gn=n)}const ss=i=>{const t=se;return Gs(i),i.scope.on(),()=>{i.scope.off(),Gs(t)}},ul=()=>{se&&se.scope.off(),Gs(null)};function Qu(i){return i.vnode.shapeFlag&4}let Gn=!1;function Of(i,t=!1,n=!1){t&&go(t);const{props:r,children:o}=i.vnode,l=Qu(i);lf(i,r,l,t),df(i,o,n||t);const u=l?Cf(i,t):void 0;return t&&go(!1),u}function Cf(i,t){const n=i.type;i.accessCache=Object.create(null),i.proxy=new Proxy(i.ctx,qd);const{setup:r}=n;if(r){Xe();const o=i.setupContext=r.length>1?Lf(i):null,l=ss(i),u=ns(r,i,0,[i.props,o]),h=Ql(u);if(Qe(),l(),(h||i.sp)&&!Bn(i)&&Cu(i),h){if(u.then(ul,ul),t)return u.then(f=>{cl(i,f)}).catch(f=>{sr(f,i,0)});i.asyncDep=u}else cl(i,u)}else tc(i)}function cl(i,t,n){ot(t)?i.type.__ssrInlineRender?i.ssrRender=t:i.render=t:kt(t)&&(i.setupState=bu(t)),tc(i)}function tc(i,t,n){const r=i.type;i.render||(i.render=r.render||Ue);{const o=ss(i);Xe();try{Kd(i)}finally{Qe(),o()}}}const Af={get(i,t){return Xt(i,"get",""),i[t]}};function Lf(i){const t=n=>{i.exposed=n||{}};return{attrs:new Proxy(i.attrs,Af),slots:i.slots,emit:i.emit,expose:t}}function lr(i){return i.exposed?i.exposeProxy||(i.exposeProxy=new Proxy(bu(fd(i.exposed)),{get(t,n){if(n in t)return t[n];if(n in Un)return Un[n](i)},has(t,n){return n in t||n in Un}})):i.proxy}function Rf(i){return ot(i)&&"__vccOpts"in i}const ec=(i,t)=>yd(i,t,Gn),If="3.5.27";let vo;const hl=typeof window<"u"&&window.trustedTypes;if(hl)try{vo=hl.createPolicy("vue",{createHTML:i=>i})}catch{}const ic=vo?i=>vo.createHTML(i):i=>i,Mf="http://www.w3.org/2000/svg",Nf="http://www.w3.org/1998/Math/MathML",Ve=typeof document<"u"?document:null,dl=Ve&&Ve.createElement("template"),jf={insert:(i,t,n)=>{t.insertBefore(i,n||null)},remove:i=>{const t=i.parentNode;t&&t.removeChild(i)},createElement:(i,t,n,r)=>{const o=t==="svg"?Ve.createElementNS(Mf,i):t==="mathml"?Ve.createElementNS(Nf,i):n?Ve.createElement(i,{is:n}):Ve.createElement(i);return i==="select"&&r&&r.multiple!=null&&o.setAttribute("multiple",r.multiple),o},createText:i=>Ve.createTextNode(i),createComment:i=>Ve.createComment(i),setText:(i,t)=>{i.nodeValue=t},setElementText:(i,t)=>{i.textContent=t},parentNode:i=>i.parentNode,nextSibling:i=>i.nextSibling,querySelector:i=>Ve.querySelector(i),setScopeId(i,t){i.setAttribute(t,"")},insertStaticContent(i,t,n,r,o,l){const u=n?n.previousSibling:t.lastChild;if(o&&(o===l||o.nextSibling))for(;t.insertBefore(o.cloneNode(!0),n),!(o===l||!(o=o.nextSibling)););else{dl.innerHTML=ic(r==="svg"?`<svg>${i}</svg>`:r==="mathml"?`<math>${i}</math>`:i);const h=dl.content;if(r==="svg"||r==="mathml"){const f=h.firstChild;for(;f.firstChild;)h.appendChild(f.firstChild);h.removeChild(f)}t.insertBefore(h,n)}return[u?u.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},Df=Symbol("_vtc");function Bf(i,t,n){const r=i[Df];r&&(t=(t?[t,...r]:[...r]).join(" ")),t==null?i.removeAttribute("class"):n?i.setAttribute("class",t):i.className=t}const fl=Symbol("_vod"),Uf=Symbol("_vsh"),$f=Symbol(""),zf=/(?:^|;)\s*display\s*:/;function Ff(i,t,n){const r=i.style,o=Bt(n);let l=!1;if(n&&!o){if(t)if(Bt(t))for(const u of t.split(";")){const h=u.slice(0,u.indexOf(":")).trim();n[h]==null&&Zs(r,h,"")}else for(const u in t)n[u]==null&&Zs(r,u,"");for(const u in n)u==="display"&&(l=!0),Zs(r,u,n[u])}else if(o){if(t!==n){const u=r[$f];u&&(n+=";"+u),r.cssText=n,l=zf.test(n)}}else t&&i.removeAttribute("style");fl in i&&(i[fl]=l?r.display:"",i[Uf]&&(r.display="none"))}const pl=/\s*!important$/;function Zs(i,t,n){if(st(n))n.forEach(r=>Zs(i,t,r));else if(n==null&&(n=""),t.startsWith("--"))i.setProperty(t,n);else{const r=Zf(i,t);pl.test(n)?i.setProperty(Mi(r),n.replace(pl,""),"important"):i[r]=n}}const _l=["Webkit","Moz","ms"],Jr={};function Zf(i,t){const n=Jr[t];if(n)return n;let r=pi(t);if(r!=="filter"&&r in i)return Jr[t]=r;r=iu(r);for(let o=0;o<_l.length;o++){const l=_l[o]+r;if(l in i)return Jr[t]=l}return t}const ml="http://www.w3.org/1999/xlink";function gl(i,t,n,r,o,l=Hh(t)){r&&t.startsWith("xlink:")?n==null?i.removeAttributeNS(ml,t.slice(6,t.length)):i.setAttributeNS(ml,t,n):n==null||l&&!su(n)?i.removeAttribute(t):i.setAttribute(t,l?"":mi(n)?String(n):n)}function vl(i,t,n,r,o){if(t==="innerHTML"||t==="textContent"){n!=null&&(i[t]=t==="innerHTML"?ic(n):n);return}const l=i.tagName;if(t==="value"&&l!=="PROGRESS"&&!l.includes("-")){const h=l==="OPTION"?i.getAttribute("value")||"":i.value,f=n==null?i.type==="checkbox"?"on":"":String(n);(h!==f||!("_value"in i))&&(i.value=f),n==null&&i.removeAttribute(t),i._value=n;return}let u=!1;if(n===""||n==null){const h=typeof i[t];h==="boolean"?n=su(n):n==null&&h==="string"?(n="",u=!0):h==="number"&&(n=0,u=!0)}try{i[t]=n}catch{}u&&i.removeAttribute(o||t)}function tn(i,t,n,r){i.addEventListener(t,n,r)}function Wf(i,t,n,r){i.removeEventListener(t,n,r)}const yl=Symbol("_vei");function Hf(i,t,n,r,o=null){const l=i[yl]||(i[yl]={}),u=l[t];if(r&&u)u.value=r;else{const[h,f]=qf(t);if(r){const p=l[t]=Gf(r,o);tn(i,h,p,f)}else u&&(Wf(i,h,u,f),l[t]=void 0)}}const wl=/(?:Once|Passive|Capture)$/;function qf(i){let t;if(wl.test(i)){t={};let r;for(;r=i.match(wl);)i=i.slice(0,i.length-r[0].length),t[r[0].toLowerCase()]=!0}return[i[2]===":"?i.slice(3):Mi(i.slice(2)),t]}let Yr=0;const Kf=Promise.resolve(),Vf=()=>Yr||(Kf.then(()=>Yr=0),Yr=Date.now());function Gf(i,t){const n=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=n.attached)return;ze(Jf(r,n.value),t,5,[r])};return n.value=i,n.attached=Vf(),n}function Jf(i,t){if(st(t)){const n=i.stopImmediatePropagation;return i.stopImmediatePropagation=()=>{n.call(i),i._stopped=!0},t.map(r=>o=>!o._stopped&&r&&r(o))}else return t}const bl=i=>i.charCodeAt(0)===111&&i.charCodeAt(1)===110&&i.charCodeAt(2)>96&&i.charCodeAt(2)<123,Yf=(i,t,n,r,o,l)=>{const u=o==="svg";t==="class"?Bf(i,r,u):t==="style"?Ff(i,n,r):Qs(t)?Lo(t)||Hf(i,t,n,r,l):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Xf(i,t,r,u))?(vl(i,t,r),!i.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&gl(i,t,r,u,l,t!=="value")):i._isVueCE&&(/[A-Z]/.test(t)||!Bt(r))?vl(i,pi(t),r,l,t):(t==="true-value"?i._trueValue=r:t==="false-value"&&(i._falseValue=r),gl(i,t,r,u))};function Xf(i,t,n,r){if(r)return!!(t==="innerHTML"||t==="textContent"||t in i&&bl(t)&&ot(n));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="sandbox"&&i.tagName==="IFRAME"||t==="form"||t==="list"&&i.tagName==="INPUT"||t==="type"&&i.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const o=i.tagName;if(o==="IMG"||o==="VIDEO"||o==="CANVAS"||o==="SOURCE")return!1}return bl(t)&&Bt(n)?!1:t in i}const Tl=i=>{const t=i.props["onUpdate:modelValue"]||!1;return st(t)?n=>$s(t,n):t};function Qf(i){i.target.composing=!0}function xl(i){const t=i.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Xr=Symbol("_assign");function Sl(i,t,n){return t&&(i=i.trim()),n&&(i=Mo(i)),i}const Ls={created(i,{modifiers:{lazy:t,trim:n,number:r}},o){i[Xr]=Tl(o);const l=r||o.props&&o.props.type==="number";tn(i,t?"change":"input",u=>{u.target.composing||i[Xr](Sl(i.value,n,l))}),(n||l)&&tn(i,"change",()=>{i.value=Sl(i.value,n,l)}),t||(tn(i,"compositionstart",Qf),tn(i,"compositionend",xl),tn(i,"change",xl))},mounted(i,{value:t}){i.value=t??""},beforeUpdate(i,{value:t,oldValue:n,modifiers:{lazy:r,trim:o,number:l}},u){if(i[Xr]=Tl(u),i.composing)return;const h=(l||i.type==="number")&&!/^0\d/.test(i.value)?Mo(i.value):i.value,f=t??"";h!==f&&(document.activeElement===i&&i.type!=="range"&&(r&&t===n||o&&i.value.trim()===f)||(i.value=f))}},tp=["ctrl","shift","alt","meta"],ep={stop:i=>i.stopPropagation(),prevent:i=>i.preventDefault(),self:i=>i.target!==i.currentTarget,ctrl:i=>!i.ctrlKey,shift:i=>!i.shiftKey,alt:i=>!i.altKey,meta:i=>!i.metaKey,left:i=>"button"in i&&i.button!==0,middle:i=>"button"in i&&i.button!==1,right:i=>"button"in i&&i.button!==2,exact:(i,t)=>tp.some(n=>i[`${n}Key`]&&!t.includes(n))},Ln=(i,t)=>{const n=i._withMods||(i._withMods={}),r=t.join(".");return n[r]||(n[r]=((o,...l)=>{for(let u=0;u<t.length;u++){const h=ep[t[u]];if(h&&h(o,t))return}return i(o,...l)}))},ip=te({patchProp:Yf},jf);let Pl;function np(){return Pl||(Pl=pf(ip))}const sp=((...i)=>{const t=np().createApp(...i),{mount:n}=t;return t.mount=r=>{const o=op(r);if(!o)return;const l=t._component;!ot(l)&&!l.render&&!l.template&&(l.template=o.innerHTML),o.nodeType===1&&(o.textContent="");const u=n(o,!1,rp(o));return o instanceof Element&&(o.removeAttribute("v-cloak"),o.setAttribute("data-v-app","")),u},t});function rp(i){if(i instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&i instanceof MathMLElement)return"mathml"}function op(i){return Bt(i)?document.querySelector(i):i}function ap(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Rn={exports:{}};var lp=Rn.exports,El;function up(){return El||(El=1,(function(i,t){(function(n,r){r(t)})(lp,(function(n){var r="1.9.4";function o(e){var s,a,c,d;for(a=1,c=arguments.length;a<c;a++){d=arguments[a];for(s in d)e[s]=d[s]}return e}var l=Object.create||(function(){function e(){}return function(s){return e.prototype=s,new e}})();function u(e,s){var a=Array.prototype.slice;if(e.bind)return e.bind.apply(e,a.call(arguments,1));var c=a.call(arguments,2);return function(){return e.apply(s,c.length?c.concat(a.call(arguments)):arguments)}}var h=0;function f(e){return"_leaflet_id"in e||(e._leaflet_id=++h),e._leaflet_id}function p(e,s,a){var c,d,_,y;return y=function(){c=!1,d&&(_.apply(a,d),d=!1)},_=function(){c?d=arguments:(e.apply(a,arguments),setTimeout(y,s),c=!0)},_}function m(e,s,a){var c=s[1],d=s[0],_=c-d;return e===c&&a?e:((e-d)%_+_)%_+d}function g(){return!1}function w(e,s){if(s===!1)return e;var a=Math.pow(10,s===void 0?6:s);return Math.round(e*a)/a}function b(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function S(e){return b(e).split(/\s+/)}function P(e,s){Object.prototype.hasOwnProperty.call(e,"options")||(e.options=e.options?l(e.options):{});for(var a in s)e.options[a]=s[a];return e.options}function B(e,s,a){var c=[];for(var d in e)c.push(encodeURIComponent(a?d.toUpperCase():d)+"="+encodeURIComponent(e[d]));return(!s||s.indexOf("?")===-1?"?":"&")+c.join("&")}var j=/\{ *([\w_ -]+) *\}/g;function U(e,s){return e.replace(j,function(a,c){var d=s[c];if(d===void 0)throw new Error("No value provided for variable "+a);return typeof d=="function"&&(d=d(s)),d})}var O=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};function k(e,s){for(var a=0;a<e.length;a++)if(e[a]===s)return a;return-1}var H="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function A(e){return window["webkit"+e]||window["moz"+e]||window["ms"+e]}var V=0;function _t(e){var s=+new Date,a=Math.max(0,16-(s-V));return V=s+a,window.setTimeout(e,a)}var Lt=window.requestAnimationFrame||A("RequestAnimationFrame")||_t,Ae=window.cancelAnimationFrame||A("CancelAnimationFrame")||A("CancelRequestAnimationFrame")||function(e){window.clearTimeout(e)};function It(e,s,a){if(a&&Lt===_t)e.call(s);else return Lt.call(window,u(e,s))}function Ft(e){e&&Ae.call(window,e)}var Ni={__proto__:null,extend:o,create:l,bind:u,get lastId(){return h},stamp:f,throttle:p,wrapNum:m,falseFn:g,formatNum:w,trim:b,splitWords:S,setOptions:P,getParamString:B,template:U,isArray:O,indexOf:k,emptyImageUrl:H,requestFn:Lt,cancelFn:Ae,requestAnimFrame:It,cancelAnimFrame:Ft};function le(){}le.extend=function(e){var s=function(){P(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},a=s.__super__=this.prototype,c=l(a);c.constructor=s,s.prototype=c;for(var d in this)Object.prototype.hasOwnProperty.call(this,d)&&d!=="prototype"&&d!=="__super__"&&(s[d]=this[d]);return e.statics&&o(s,e.statics),e.includes&&(os(e.includes),o.apply(null,[c].concat(e.includes))),o(c,e),delete c.statics,delete c.includes,c.options&&(c.options=a.options?l(a.options):{},o(c.options,e.options)),c._initHooks=[],c.callInitHooks=function(){if(!this._initHooksCalled){a.callInitHooks&&a.callInitHooks.call(this),this._initHooksCalled=!0;for(var _=0,y=c._initHooks.length;_<y;_++)c._initHooks[_].call(this)}},s},le.include=function(e){var s=this.prototype.options;return o(this.prototype,e),e.options&&(this.prototype.options=s,this.mergeOptions(e.options)),this},le.mergeOptions=function(e){return o(this.prototype.options,e),this},le.addInitHook=function(e){var s=Array.prototype.slice.call(arguments,1),a=typeof e=="function"?e:function(){this[e].apply(this,s)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(a),this};function os(e){if(!(typeof L>"u"||!L||!L.Mixin)){e=O(e)?e:[e];for(var s=0;s<e.length;s++)e[s]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var yt={on:function(e,s,a){if(typeof e=="object")for(var c in e)this._on(c,e[c],s);else{e=S(e);for(var d=0,_=e.length;d<_;d++)this._on(e[d],s,a)}return this},off:function(e,s,a){if(!arguments.length)delete this._events;else if(typeof e=="object")for(var c in e)this._off(c,e[c],s);else{e=S(e);for(var d=arguments.length===1,_=0,y=e.length;_<y;_++)d?this._off(e[_]):this._off(e[_],s,a)}return this},_on:function(e,s,a,c){if(typeof s!="function"){console.warn("wrong listener type: "+typeof s);return}if(this._listens(e,s,a)===!1){a===this&&(a=void 0);var d={fn:s,ctx:a};c&&(d.once=!0),this._events=this._events||{},this._events[e]=this._events[e]||[],this._events[e].push(d)}},_off:function(e,s,a){var c,d,_;if(this._events&&(c=this._events[e],!!c)){if(arguments.length===1){if(this._firingCount)for(d=0,_=c.length;d<_;d++)c[d].fn=g;delete this._events[e];return}if(typeof s!="function"){console.warn("wrong listener type: "+typeof s);return}var y=this._listens(e,s,a);if(y!==!1){var x=c[y];this._firingCount&&(x.fn=g,this._events[e]=c=c.slice()),c.splice(y,1)}}},fire:function(e,s,a){if(!this.listens(e,a))return this;var c=o({},s,{type:e,target:this,sourceTarget:s&&s.sourceTarget||this});if(this._events){var d=this._events[e];if(d){this._firingCount=this._firingCount+1||1;for(var _=0,y=d.length;_<y;_++){var x=d[_],E=x.fn;x.once&&this.off(e,E,x.ctx),E.call(x.ctx||this,c)}this._firingCount--}}return a&&this._propagateEvent(c),this},listens:function(e,s,a,c){typeof e!="string"&&console.warn('"string" type argument expected');var d=s;typeof s!="function"&&(c=!!s,d=void 0,a=void 0);var _=this._events&&this._events[e];if(_&&_.length&&this._listens(e,d,a)!==!1)return!0;if(c){for(var y in this._eventParents)if(this._eventParents[y].listens(e,s,a,c))return!0}return!1},_listens:function(e,s,a){if(!this._events)return!1;var c=this._events[e]||[];if(!s)return!!c.length;a===this&&(a=void 0);for(var d=0,_=c.length;d<_;d++)if(c[d].fn===s&&c[d].ctx===a)return d;return!1},once:function(e,s,a){if(typeof e=="object")for(var c in e)this._on(c,e[c],s,!0);else{e=S(e);for(var d=0,_=e.length;d<_;d++)this._on(e[d],s,a,!0)}return this},addEventParent:function(e){return this._eventParents=this._eventParents||{},this._eventParents[f(e)]=e,this},removeEventParent:function(e){return this._eventParents&&delete this._eventParents[f(e)],this},_propagateEvent:function(e){for(var s in this._eventParents)this._eventParents[s].fire(e.type,o({layer:e.target,propagatedFrom:e.target},e),!0)}};yt.addEventListener=yt.on,yt.removeEventListener=yt.clearAllEventListeners=yt.off,yt.addOneTimeEventListener=yt.once,yt.fireEvent=yt.fire,yt.hasEventListeners=yt.listens;var wt=le.extend(yt);function K(e,s,a){this.x=a?Math.round(e):e,this.y=a?Math.round(s):s}var Le=Math.trunc||function(e){return e>0?Math.floor(e):Math.ceil(e)};K.prototype={clone:function(){return new K(this.x,this.y)},add:function(e){return this.clone()._add(tt(e))},_add:function(e){return this.x+=e.x,this.y+=e.y,this},subtract:function(e){return this.clone()._subtract(tt(e))},_subtract:function(e){return this.x-=e.x,this.y-=e.y,this},divideBy:function(e){return this.clone()._divideBy(e)},_divideBy:function(e){return this.x/=e,this.y/=e,this},multiplyBy:function(e){return this.clone()._multiplyBy(e)},_multiplyBy:function(e){return this.x*=e,this.y*=e,this},scaleBy:function(e){return new K(this.x*e.x,this.y*e.y)},unscaleBy:function(e){return new K(this.x/e.x,this.y/e.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Le(this.x),this.y=Le(this.y),this},distanceTo:function(e){e=tt(e);var s=e.x-this.x,a=e.y-this.y;return Math.sqrt(s*s+a*a)},equals:function(e){return e=tt(e),e.x===this.x&&e.y===this.y},contains:function(e){return e=tt(e),Math.abs(e.x)<=Math.abs(this.x)&&Math.abs(e.y)<=Math.abs(this.y)},toString:function(){return"Point("+w(this.x)+", "+w(this.y)+")"}};function tt(e,s,a){return e instanceof K?e:O(e)?new K(e[0],e[1]):e==null?e:typeof e=="object"&&"x"in e&&"y"in e?new K(e.x,e.y):new K(e,s,a)}function pt(e,s){if(e)for(var a=s?[e,s]:e,c=0,d=a.length;c<d;c++)this.extend(a[c])}pt.prototype={extend:function(e){var s,a;if(!e)return this;if(e instanceof K||typeof e[0]=="number"||"x"in e)s=a=tt(e);else if(e=Et(e),s=e.min,a=e.max,!s||!a)return this;return!this.min&&!this.max?(this.min=s.clone(),this.max=a.clone()):(this.min.x=Math.min(s.x,this.min.x),this.max.x=Math.max(a.x,this.max.x),this.min.y=Math.min(s.y,this.min.y),this.max.y=Math.max(a.y,this.max.y)),this},getCenter:function(e){return tt((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,e)},getBottomLeft:function(){return tt(this.min.x,this.max.y)},getTopRight:function(){return tt(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(e){var s,a;return typeof e[0]=="number"||e instanceof K?e=tt(e):e=Et(e),e instanceof pt?(s=e.min,a=e.max):s=a=e,s.x>=this.min.x&&a.x<=this.max.x&&s.y>=this.min.y&&a.y<=this.max.y},intersects:function(e){e=Et(e);var s=this.min,a=this.max,c=e.min,d=e.max,_=d.x>=s.x&&c.x<=a.x,y=d.y>=s.y&&c.y<=a.y;return _&&y},overlaps:function(e){e=Et(e);var s=this.min,a=this.max,c=e.min,d=e.max,_=d.x>s.x&&c.x<a.x,y=d.y>s.y&&c.y<a.y;return _&&y},isValid:function(){return!!(this.min&&this.max)},pad:function(e){var s=this.min,a=this.max,c=Math.abs(s.x-a.x)*e,d=Math.abs(s.y-a.y)*e;return Et(tt(s.x-c,s.y-d),tt(a.x+c,a.y+d))},equals:function(e){return e?(e=Et(e),this.min.equals(e.getTopLeft())&&this.max.equals(e.getBottomRight())):!1}};function Et(e,s){return!e||e instanceof pt?e:new pt(e,s)}function Zt(e,s){if(e)for(var a=s?[e,s]:e,c=0,d=a.length;c<d;c++)this.extend(a[c])}Zt.prototype={extend:function(e){var s=this._southWest,a=this._northEast,c,d;if(e instanceof mt)c=e,d=e;else if(e instanceof Zt){if(c=e._southWest,d=e._northEast,!c||!d)return this}else return e?this.extend(at(e)||Ct(e)):this;return!s&&!a?(this._southWest=new mt(c.lat,c.lng),this._northEast=new mt(d.lat,d.lng)):(s.lat=Math.min(c.lat,s.lat),s.lng=Math.min(c.lng,s.lng),a.lat=Math.max(d.lat,a.lat),a.lng=Math.max(d.lng,a.lng)),this},pad:function(e){var s=this._southWest,a=this._northEast,c=Math.abs(s.lat-a.lat)*e,d=Math.abs(s.lng-a.lng)*e;return new Zt(new mt(s.lat-c,s.lng-d),new mt(a.lat+c,a.lng+d))},getCenter:function(){return new mt((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new mt(this.getNorth(),this.getWest())},getSouthEast:function(){return new mt(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(e){typeof e[0]=="number"||e instanceof mt||"lat"in e?e=at(e):e=Ct(e);var s=this._southWest,a=this._northEast,c,d;return e instanceof Zt?(c=e.getSouthWest(),d=e.getNorthEast()):c=d=e,c.lat>=s.lat&&d.lat<=a.lat&&c.lng>=s.lng&&d.lng<=a.lng},intersects:function(e){e=Ct(e);var s=this._southWest,a=this._northEast,c=e.getSouthWest(),d=e.getNorthEast(),_=d.lat>=s.lat&&c.lat<=a.lat,y=d.lng>=s.lng&&c.lng<=a.lng;return _&&y},overlaps:function(e){e=Ct(e);var s=this._southWest,a=this._northEast,c=e.getSouthWest(),d=e.getNorthEast(),_=d.lat>s.lat&&c.lat<a.lat,y=d.lng>s.lng&&c.lng<a.lng;return _&&y},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(e,s){return e?(e=Ct(e),this._southWest.equals(e.getSouthWest(),s)&&this._northEast.equals(e.getNorthEast(),s)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Ct(e,s){return e instanceof Zt?e:new Zt(e,s)}function mt(e,s,a){if(isNaN(e)||isNaN(s))throw new Error("Invalid LatLng object: ("+e+", "+s+")");this.lat=+e,this.lng=+s,a!==void 0&&(this.alt=+a)}mt.prototype={equals:function(e,s){if(!e)return!1;e=at(e);var a=Math.max(Math.abs(this.lat-e.lat),Math.abs(this.lng-e.lng));return a<=(s===void 0?1e-9:s)},toString:function(e){return"LatLng("+w(this.lat,e)+", "+w(this.lng,e)+")"},distanceTo:function(e){return _e.distance(this,at(e))},wrap:function(){return _e.wrapLatLng(this)},toBounds:function(e){var s=180*e/40075017,a=s/Math.cos(Math.PI/180*this.lat);return Ct([this.lat-s,this.lng-a],[this.lat+s,this.lng+a])},clone:function(){return new mt(this.lat,this.lng,this.alt)}};function at(e,s,a){return e instanceof mt?e:O(e)&&typeof e[0]!="object"?e.length===3?new mt(e[0],e[1],e[2]):e.length===2?new mt(e[0],e[1]):null:e==null?e:typeof e=="object"&&"lat"in e?new mt(e.lat,"lng"in e?e.lng:e.lon,e.alt):s===void 0?null:new mt(e,s,a)}var re={latLngToPoint:function(e,s){var a=this.projection.project(e),c=this.scale(s);return this.transformation._transform(a,c)},pointToLatLng:function(e,s){var a=this.scale(s),c=this.transformation.untransform(e,a);return this.projection.unproject(c)},project:function(e){return this.projection.project(e)},unproject:function(e){return this.projection.unproject(e)},scale:function(e){return 256*Math.pow(2,e)},zoom:function(e){return Math.log(e/256)/Math.LN2},getProjectedBounds:function(e){if(this.infinite)return null;var s=this.projection.bounds,a=this.scale(e),c=this.transformation.transform(s.min,a),d=this.transformation.transform(s.max,a);return new pt(c,d)},infinite:!1,wrapLatLng:function(e){var s=this.wrapLng?m(e.lng,this.wrapLng,!0):e.lng,a=this.wrapLat?m(e.lat,this.wrapLat,!0):e.lat,c=e.alt;return new mt(a,s,c)},wrapLatLngBounds:function(e){var s=e.getCenter(),a=this.wrapLatLng(s),c=s.lat-a.lat,d=s.lng-a.lng;if(c===0&&d===0)return e;var _=e.getSouthWest(),y=e.getNorthEast(),x=new mt(_.lat-c,_.lng-d),E=new mt(y.lat-c,y.lng-d);return new Zt(x,E)}},_e=o({},re,{wrapLng:[-180,180],R:6371e3,distance:function(e,s){var a=Math.PI/180,c=e.lat*a,d=s.lat*a,_=Math.sin((s.lat-e.lat)*a/2),y=Math.sin((s.lng-e.lng)*a/2),x=_*_+Math.cos(c)*Math.cos(d)*y*y,E=2*Math.atan2(Math.sqrt(x),Math.sqrt(1-x));return this.R*E}}),pn=6378137,Fe={R:pn,MAX_LATITUDE:85.0511287798,project:function(e){var s=Math.PI/180,a=this.MAX_LATITUDE,c=Math.max(Math.min(a,e.lat),-a),d=Math.sin(c*s);return new K(this.R*e.lng*s,this.R*Math.log((1+d)/(1-d))/2)},unproject:function(e){var s=180/Math.PI;return new mt((2*Math.atan(Math.exp(e.y/this.R))-Math.PI/2)*s,e.x*s/this.R)},bounds:(function(){var e=pn*Math.PI;return new pt([-e,-e],[e,e])})()};function as(e,s,a,c){if(O(e)){this._a=e[0],this._b=e[1],this._c=e[2],this._d=e[3];return}this._a=e,this._b=s,this._c=a,this._d=c}as.prototype={transform:function(e,s){return this._transform(e.clone(),s)},_transform:function(e,s){return s=s||1,e.x=s*(this._a*e.x+this._b),e.y=s*(this._c*e.y+this._d),e},untransform:function(e,s){return s=s||1,new K((e.x/s-this._b)/this._a,(e.y/s-this._d)/this._c)}};function v(e,s,a,c){return new as(e,s,a,c)}var T=o({},_e,{code:"EPSG:3857",projection:Fe,transformation:(function(){var e=.5/(Math.PI*Fe.R);return v(e,.5,-e,.5)})()}),C=o({},T,{code:"EPSG:900913"});function D(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function I(e,s){var a="",c,d,_,y,x,E;for(c=0,_=e.length;c<_;c++){for(x=e[c],d=0,y=x.length;d<y;d++)E=x[d],a+=(d?"L":"M")+E.x+" "+E.y;a+=s?J.svg?"z":"x":""}return a||"M0 0"}var M=document.documentElement.style,Z="ActiveXObject"in window,F=Z&&!document.addEventListener,z="msLaunchUri"in navigator&&!("documentMode"in document),N=Re("webkit"),X=Re("android"),W=Re("android 2")||Re("android 3"),Y=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),nt=X&&Re("Google")&&Y<537&&!("AudioNode"in window),ut=!!window.opera,bt=!z&&Re("chrome"),dt=Re("gecko")&&!N&&!ut&&!Z,Jt=!bt&&Re("safari"),Wt=Re("phantom"),ue="OTransition"in M,me=navigator.platform.indexOf("Win")===0,ni=Z&&"transition"in M,ji="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!W,Yt="MozPerspective"in M,ge=!window.L_DISABLE_3D&&(ni||ji||Yt)&&!ue&&!Wt,si=typeof orientation<"u"||Re("mobile"),ls=si&&N,wc=si&&ji,Yo=!window.PointerEvent&&window.MSPointerEvent,Xo=!!(window.PointerEvent||Yo),Qo="ontouchstart"in window||!!window.TouchEvent,bc=!window.L_NO_TOUCH&&(Qo||Xo),Tc=si&&ut,xc=si&&dt,Sc=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Pc=(function(){var e=!1;try{var s=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("testPassiveEventSupport",g,s),window.removeEventListener("testPassiveEventSupport",g,s)}catch{}return e})(),Ec=(function(){return!!document.createElement("canvas").getContext})(),fr=!!(document.createElementNS&&D("svg").createSVGRect),kc=!!fr&&(function(){var e=document.createElement("div");return e.innerHTML="<svg/>",(e.firstChild&&e.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),Oc=!fr&&(function(){try{var e=document.createElement("div");e.innerHTML='<v:shape adj="1"/>';var s=e.firstChild;return s.style.behavior="url(#default#VML)",s&&typeof s.adj=="object"}catch{return!1}})(),Cc=navigator.platform.indexOf("Mac")===0,Ac=navigator.platform.indexOf("Linux")===0;function Re(e){return navigator.userAgent.toLowerCase().indexOf(e)>=0}var J={ie:Z,ielt9:F,edge:z,webkit:N,android:X,android23:W,androidStock:nt,opera:ut,chrome:bt,gecko:dt,safari:Jt,phantom:Wt,opera12:ue,win:me,ie3d:ni,webkit3d:ji,gecko3d:Yt,any3d:ge,mobile:si,mobileWebkit:ls,mobileWebkit3d:wc,msPointer:Yo,pointer:Xo,touch:bc,touchNative:Qo,mobileOpera:Tc,mobileGecko:xc,retina:Sc,passiveEvents:Pc,canvas:Ec,svg:fr,vml:Oc,inlineSvg:kc,mac:Cc,linux:Ac},ta=J.msPointer?"MSPointerDown":"pointerdown",ea=J.msPointer?"MSPointerMove":"pointermove",ia=J.msPointer?"MSPointerUp":"pointerup",na=J.msPointer?"MSPointerCancel":"pointercancel",pr={touchstart:ta,touchmove:ea,touchend:ia,touchcancel:na},sa={touchstart:jc,touchmove:us,touchend:us,touchcancel:us},Di={},ra=!1;function Lc(e,s,a){return s==="touchstart"&&Nc(),sa[s]?(a=sa[s].bind(this,a),e.addEventListener(pr[s],a,!1),a):(console.warn("wrong event specified:",s),g)}function Rc(e,s,a){if(!pr[s]){console.warn("wrong event specified:",s);return}e.removeEventListener(pr[s],a,!1)}function Ic(e){Di[e.pointerId]=e}function Mc(e){Di[e.pointerId]&&(Di[e.pointerId]=e)}function oa(e){delete Di[e.pointerId]}function Nc(){ra||(document.addEventListener(ta,Ic,!0),document.addEventListener(ea,Mc,!0),document.addEventListener(ia,oa,!0),document.addEventListener(na,oa,!0),ra=!0)}function us(e,s){if(s.pointerType!==(s.MSPOINTER_TYPE_MOUSE||"mouse")){s.touches=[];for(var a in Di)s.touches.push(Di[a]);s.changedTouches=[s],e(s)}}function jc(e,s){s.MSPOINTER_TYPE_TOUCH&&s.pointerType===s.MSPOINTER_TYPE_TOUCH&&Ht(s),us(e,s)}function Dc(e){var s={},a,c;for(c in e)a=e[c],s[c]=a&&a.bind?a.bind(e):a;return e=s,s.type="dblclick",s.detail=2,s.isTrusted=!1,s._simulated=!0,s}var Bc=200;function Uc(e,s){e.addEventListener("dblclick",s);var a=0,c;function d(_){if(_.detail!==1){c=_.detail;return}if(!(_.pointerType==="mouse"||_.sourceCapabilities&&!_.sourceCapabilities.firesTouchEvents)){var y=ha(_);if(!(y.some(function(E){return E instanceof HTMLLabelElement&&E.attributes.for})&&!y.some(function(E){return E instanceof HTMLInputElement||E instanceof HTMLSelectElement}))){var x=Date.now();x-a<=Bc?(c++,c===2&&s(Dc(_))):c=1,a=x}}}return e.addEventListener("click",d),{dblclick:s,simDblclick:d}}function $c(e,s){e.removeEventListener("dblclick",s.dblclick),e.removeEventListener("click",s.simDblclick)}var _r=ds(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),_n=ds(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),aa=_n==="webkitTransition"||_n==="OTransition"?_n+"End":"transitionend";function la(e){return typeof e=="string"?document.getElementById(e):e}function mn(e,s){var a=e.style[s]||e.currentStyle&&e.currentStyle[s];if((!a||a==="auto")&&document.defaultView){var c=document.defaultView.getComputedStyle(e,null);a=c?c[s]:null}return a==="auto"?null:a}function ft(e,s,a){var c=document.createElement(e);return c.className=s||"",a&&a.appendChild(c),c}function Ot(e){var s=e.parentNode;s&&s.removeChild(e)}function cs(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function Bi(e){var s=e.parentNode;s&&s.lastChild!==e&&s.appendChild(e)}function Ui(e){var s=e.parentNode;s&&s.firstChild!==e&&s.insertBefore(e,s.firstChild)}function mr(e,s){if(e.classList!==void 0)return e.classList.contains(s);var a=hs(e);return a.length>0&&new RegExp("(^|\\s)"+s+"(\\s|$)").test(a)}function lt(e,s){if(e.classList!==void 0)for(var a=S(s),c=0,d=a.length;c<d;c++)e.classList.add(a[c]);else if(!mr(e,s)){var _=hs(e);gr(e,(_?_+" ":"")+s)}}function Rt(e,s){e.classList!==void 0?e.classList.remove(s):gr(e,b((" "+hs(e)+" ").replace(" "+s+" "," ")))}function gr(e,s){e.className.baseVal===void 0?e.className=s:e.className.baseVal=s}function hs(e){return e.correspondingElement&&(e=e.correspondingElement),e.className.baseVal===void 0?e.className:e.className.baseVal}function ve(e,s){"opacity"in e.style?e.style.opacity=s:"filter"in e.style&&zc(e,s)}function zc(e,s){var a=!1,c="DXImageTransform.Microsoft.Alpha";try{a=e.filters.item(c)}catch{if(s===1)return}s=Math.round(s*100),a?(a.Enabled=s!==100,a.Opacity=s):e.style.filter+=" progid:"+c+"(opacity="+s+")"}function ds(e){for(var s=document.documentElement.style,a=0;a<e.length;a++)if(e[a]in s)return e[a];return!1}function gi(e,s,a){var c=s||new K(0,0);e.style[_r]=(J.ie3d?"translate("+c.x+"px,"+c.y+"px)":"translate3d("+c.x+"px,"+c.y+"px,0)")+(a?" scale("+a+")":"")}function Mt(e,s){e._leaflet_pos=s,J.any3d?gi(e,s):(e.style.left=s.x+"px",e.style.top=s.y+"px")}function vi(e){return e._leaflet_pos||new K(0,0)}var gn,vn,vr;if("onselectstart"in document)gn=function(){rt(window,"selectstart",Ht)},vn=function(){xt(window,"selectstart",Ht)};else{var yn=ds(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);gn=function(){if(yn){var e=document.documentElement.style;vr=e[yn],e[yn]="none"}},vn=function(){yn&&(document.documentElement.style[yn]=vr,vr=void 0)}}function yr(){rt(window,"dragstart",Ht)}function wr(){xt(window,"dragstart",Ht)}var fs,br;function Tr(e){for(;e.tabIndex===-1;)e=e.parentNode;e.style&&(ps(),fs=e,br=e.style.outlineStyle,e.style.outlineStyle="none",rt(window,"keydown",ps))}function ps(){fs&&(fs.style.outlineStyle=br,fs=void 0,br=void 0,xt(window,"keydown",ps))}function ua(e){do e=e.parentNode;while((!e.offsetWidth||!e.offsetHeight)&&e!==document.body);return e}function xr(e){var s=e.getBoundingClientRect();return{x:s.width/e.offsetWidth||1,y:s.height/e.offsetHeight||1,boundingClientRect:s}}var Fc={__proto__:null,TRANSFORM:_r,TRANSITION:_n,TRANSITION_END:aa,get:la,getStyle:mn,create:ft,remove:Ot,empty:cs,toFront:Bi,toBack:Ui,hasClass:mr,addClass:lt,removeClass:Rt,setClass:gr,getClass:hs,setOpacity:ve,testProp:ds,setTransform:gi,setPosition:Mt,getPosition:vi,get disableTextSelection(){return gn},get enableTextSelection(){return vn},disableImageDrag:yr,enableImageDrag:wr,preventOutline:Tr,restoreOutline:ps,getSizedParentNode:ua,getScale:xr};function rt(e,s,a,c){if(s&&typeof s=="object")for(var d in s)Pr(e,d,s[d],a);else{s=S(s);for(var _=0,y=s.length;_<y;_++)Pr(e,s[_],a,c)}return this}var Ie="_leaflet_events";function xt(e,s,a,c){if(arguments.length===1)ca(e),delete e[Ie];else if(s&&typeof s=="object")for(var d in s)Er(e,d,s[d],a);else if(s=S(s),arguments.length===2)ca(e,function(x){return k(s,x)!==-1});else for(var _=0,y=s.length;_<y;_++)Er(e,s[_],a,c);return this}function ca(e,s){for(var a in e[Ie]){var c=a.split(/\d/)[0];(!s||s(c))&&Er(e,c,null,null,a)}}var Sr={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Pr(e,s,a,c){var d=s+f(a)+(c?"_"+f(c):"");if(e[Ie]&&e[Ie][d])return this;var _=function(x){return a.call(c||e,x||window.event)},y=_;!J.touchNative&&J.pointer&&s.indexOf("touch")===0?_=Lc(e,s,_):J.touch&&s==="dblclick"?_=Uc(e,_):"addEventListener"in e?s==="touchstart"||s==="touchmove"||s==="wheel"||s==="mousewheel"?e.addEventListener(Sr[s]||s,_,J.passiveEvents?{passive:!1}:!1):s==="mouseenter"||s==="mouseleave"?(_=function(x){x=x||window.event,Or(e,x)&&y(x)},e.addEventListener(Sr[s],_,!1)):e.addEventListener(s,y,!1):e.attachEvent("on"+s,_),e[Ie]=e[Ie]||{},e[Ie][d]=_}function Er(e,s,a,c,d){d=d||s+f(a)+(c?"_"+f(c):"");var _=e[Ie]&&e[Ie][d];if(!_)return this;!J.touchNative&&J.pointer&&s.indexOf("touch")===0?Rc(e,s,_):J.touch&&s==="dblclick"?$c(e,_):"removeEventListener"in e?e.removeEventListener(Sr[s]||s,_,!1):e.detachEvent("on"+s,_),e[Ie][d]=null}function yi(e){return e.stopPropagation?e.stopPropagation():e.originalEvent?e.originalEvent._stopped=!0:e.cancelBubble=!0,this}function kr(e){return Pr(e,"wheel",yi),this}function wn(e){return rt(e,"mousedown touchstart dblclick contextmenu",yi),e._leaflet_disable_click=!0,this}function Ht(e){return e.preventDefault?e.preventDefault():e.returnValue=!1,this}function wi(e){return Ht(e),yi(e),this}function ha(e){if(e.composedPath)return e.composedPath();for(var s=[],a=e.target;a;)s.push(a),a=a.parentNode;return s}function da(e,s){if(!s)return new K(e.clientX,e.clientY);var a=xr(s),c=a.boundingClientRect;return new K((e.clientX-c.left)/a.x-s.clientLeft,(e.clientY-c.top)/a.y-s.clientTop)}var Zc=J.linux&&J.chrome?window.devicePixelRatio:J.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function fa(e){return J.edge?e.wheelDeltaY/2:e.deltaY&&e.deltaMode===0?-e.deltaY/Zc:e.deltaY&&e.deltaMode===1?-e.deltaY*20:e.deltaY&&e.deltaMode===2?-e.deltaY*60:e.deltaX||e.deltaZ?0:e.wheelDelta?(e.wheelDeltaY||e.wheelDelta)/2:e.detail&&Math.abs(e.detail)<32765?-e.detail*20:e.detail?e.detail/-32765*60:0}function Or(e,s){var a=s.relatedTarget;if(!a)return!0;try{for(;a&&a!==e;)a=a.parentNode}catch{return!1}return a!==e}var Wc={__proto__:null,on:rt,off:xt,stopPropagation:yi,disableScrollPropagation:kr,disableClickPropagation:wn,preventDefault:Ht,stop:wi,getPropagationPath:ha,getMousePosition:da,getWheelDelta:fa,isExternalTarget:Or,addListener:rt,removeListener:xt},pa=wt.extend({run:function(e,s,a,c){this.stop(),this._el=e,this._inProgress=!0,this._duration=a||.25,this._easeOutPower=1/Math.max(c||.5,.2),this._startPos=vi(e),this._offset=s.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=It(this._animate,this),this._step()},_step:function(e){var s=+new Date-this._startTime,a=this._duration*1e3;s<a?this._runFrame(this._easeOut(s/a),e):(this._runFrame(1),this._complete())},_runFrame:function(e,s){var a=this._startPos.add(this._offset.multiplyBy(e));s&&a._round(),Mt(this._el,a),this.fire("step")},_complete:function(){Ft(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(e){return 1-Math.pow(1-e,this._easeOutPower)}}),ht=wt.extend({options:{crs:T,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(e,s){s=P(this,s),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(e),this._initLayout(),this._onResize=u(this._onResize,this),this._initEvents(),s.maxBounds&&this.setMaxBounds(s.maxBounds),s.zoom!==void 0&&(this._zoom=this._limitZoom(s.zoom)),s.center&&s.zoom!==void 0&&this.setView(at(s.center),s.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=_n&&J.any3d&&!J.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),rt(this._proxy,aa,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(e,s,a){if(s=s===void 0?this._zoom:this._limitZoom(s),e=this._limitCenter(at(e),s,this.options.maxBounds),a=a||{},this._stop(),this._loaded&&!a.reset&&a!==!0){a.animate!==void 0&&(a.zoom=o({animate:a.animate},a.zoom),a.pan=o({animate:a.animate,duration:a.duration},a.pan));var c=this._zoom!==s?this._tryAnimatedZoom&&this._tryAnimatedZoom(e,s,a.zoom):this._tryAnimatedPan(e,a.pan);if(c)return clearTimeout(this._sizeTimer),this}return this._resetView(e,s,a.pan&&a.pan.noMoveStart),this},setZoom:function(e,s){return this._loaded?this.setView(this.getCenter(),e,{zoom:s}):(this._zoom=e,this)},zoomIn:function(e,s){return e=e||(J.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+e,s)},zoomOut:function(e,s){return e=e||(J.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-e,s)},setZoomAround:function(e,s,a){var c=this.getZoomScale(s),d=this.getSize().divideBy(2),_=e instanceof K?e:this.latLngToContainerPoint(e),y=_.subtract(d).multiplyBy(1-1/c),x=this.containerPointToLatLng(d.add(y));return this.setView(x,s,{zoom:a})},_getBoundsCenterZoom:function(e,s){s=s||{},e=e.getBounds?e.getBounds():Ct(e);var a=tt(s.paddingTopLeft||s.padding||[0,0]),c=tt(s.paddingBottomRight||s.padding||[0,0]),d=this.getBoundsZoom(e,!1,a.add(c));if(d=typeof s.maxZoom=="number"?Math.min(s.maxZoom,d):d,d===1/0)return{center:e.getCenter(),zoom:d};var _=c.subtract(a).divideBy(2),y=this.project(e.getSouthWest(),d),x=this.project(e.getNorthEast(),d),E=this.unproject(y.add(x).divideBy(2).add(_),d);return{center:E,zoom:d}},fitBounds:function(e,s){if(e=Ct(e),!e.isValid())throw new Error("Bounds are not valid.");var a=this._getBoundsCenterZoom(e,s);return this.setView(a.center,a.zoom,s)},fitWorld:function(e){return this.fitBounds([[-90,-180],[90,180]],e)},panTo:function(e,s){return this.setView(e,this._zoom,{pan:s})},panBy:function(e,s){if(e=tt(e).round(),s=s||{},!e.x&&!e.y)return this.fire("moveend");if(s.animate!==!0&&!this.getSize().contains(e))return this._resetView(this.unproject(this.project(this.getCenter()).add(e)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new pa,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),s.noMoveStart||this.fire("movestart"),s.animate!==!1){lt(this._mapPane,"leaflet-pan-anim");var a=this._getMapPanePos().subtract(e).round();this._panAnim.run(this._mapPane,a,s.duration||.25,s.easeLinearity)}else this._rawPanBy(e),this.fire("move").fire("moveend");return this},flyTo:function(e,s,a){if(a=a||{},a.animate===!1||!J.any3d)return this.setView(e,s,a);this._stop();var c=this.project(this.getCenter()),d=this.project(e),_=this.getSize(),y=this._zoom;e=at(e),s=s===void 0?y:s;var x=Math.max(_.x,_.y),E=x*this.getZoomScale(y,s),R=d.distanceTo(c)||1,q=1.42,et=q*q;function ct(Nt){var Es=Nt?-1:1,Rh=Nt?E:x,Ih=E*E-x*x+Es*et*et*R*R,Mh=2*Rh*et*R,Ur=Ih/Mh,Va=Math.sqrt(Ur*Ur+1)-Ur,Nh=Va<1e-9?-18:Math.log(Va);return Nh}function ee(Nt){return(Math.exp(Nt)-Math.exp(-Nt))/2}function zt(Nt){return(Math.exp(Nt)+Math.exp(-Nt))/2}function we(Nt){return ee(Nt)/zt(Nt)}var oe=ct(0);function Hi(Nt){return x*(zt(oe)/zt(oe+q*Nt))}function Oh(Nt){return x*(zt(oe)*we(oe+q*Nt)-ee(oe))/et}function Ch(Nt){return 1-Math.pow(1-Nt,1.5)}var Ah=Date.now(),qa=(ct(1)-oe)/q,Lh=a.duration?1e3*a.duration:1e3*qa*.8;function Ka(){var Nt=(Date.now()-Ah)/Lh,Es=Ch(Nt)*qa;Nt<=1?(this._flyToFrame=It(Ka,this),this._move(this.unproject(c.add(d.subtract(c).multiplyBy(Oh(Es)/R)),y),this.getScaleZoom(x/Hi(Es),y),{flyTo:!0})):this._move(e,s)._moveEnd(!0)}return this._moveStart(!0,a.noMoveStart),Ka.call(this),this},flyToBounds:function(e,s){var a=this._getBoundsCenterZoom(e,s);return this.flyTo(a.center,a.zoom,s)},setMaxBounds:function(e){return e=Ct(e),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),e.isValid()?(this.options.maxBounds=e,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(e){var s=this.options.minZoom;return this.options.minZoom=e,this._loaded&&s!==e&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(e):this},setMaxZoom:function(e){var s=this.options.maxZoom;return this.options.maxZoom=e,this._loaded&&s!==e&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(e):this},panInsideBounds:function(e,s){this._enforcingBounds=!0;var a=this.getCenter(),c=this._limitCenter(a,this._zoom,Ct(e));return a.equals(c)||this.panTo(c,s),this._enforcingBounds=!1,this},panInside:function(e,s){s=s||{};var a=tt(s.paddingTopLeft||s.padding||[0,0]),c=tt(s.paddingBottomRight||s.padding||[0,0]),d=this.project(this.getCenter()),_=this.project(e),y=this.getPixelBounds(),x=Et([y.min.add(a),y.max.subtract(c)]),E=x.getSize();if(!x.contains(_)){this._enforcingBounds=!0;var R=_.subtract(x.getCenter()),q=x.extend(_).getSize().subtract(E);d.x+=R.x<0?-q.x:q.x,d.y+=R.y<0?-q.y:q.y,this.panTo(this.unproject(d),s),this._enforcingBounds=!1}return this},invalidateSize:function(e){if(!this._loaded)return this;e=o({animate:!1,pan:!0},e===!0?{animate:!0}:e);var s=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var a=this.getSize(),c=s.divideBy(2).round(),d=a.divideBy(2).round(),_=c.subtract(d);return!_.x&&!_.y?this:(e.animate&&e.pan?this.panBy(_):(e.pan&&this._rawPanBy(_),this.fire("move"),e.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(u(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:s,newSize:a}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(e){if(e=this._locateOptions=o({timeout:1e4,watch:!1},e),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var s=u(this._handleGeolocationResponse,this),a=u(this._handleGeolocationError,this);return e.watch?this._locationWatchId=navigator.geolocation.watchPosition(s,a,e):navigator.geolocation.getCurrentPosition(s,a,e),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(e){if(this._container._leaflet_id){var s=e.code,a=e.message||(s===1?"permission denied":s===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:s,message:"Geolocation error: "+a+"."})}},_handleGeolocationResponse:function(e){if(this._container._leaflet_id){var s=e.coords.latitude,a=e.coords.longitude,c=new mt(s,a),d=c.toBounds(e.coords.accuracy*2),_=this._locateOptions;if(_.setView){var y=this.getBoundsZoom(d);this.setView(c,_.maxZoom?Math.min(y,_.maxZoom):y)}var x={latlng:c,bounds:d,timestamp:e.timestamp};for(var E in e.coords)typeof e.coords[E]=="number"&&(x[E]=e.coords[E]);this.fire("locationfound",x)}},addHandler:function(e,s){if(!s)return this;var a=this[e]=new s(this);return this._handlers.push(a),this.options[e]&&a.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Ot(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(Ft(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var e;for(e in this._layers)this._layers[e].remove();for(e in this._panes)Ot(this._panes[e]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(e,s){var a="leaflet-pane"+(e?" leaflet-"+e.replace("Pane","")+"-pane":""),c=ft("div",a,s||this._mapPane);return e&&(this._panes[e]=c),c},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var e=this.getPixelBounds(),s=this.unproject(e.getBottomLeft()),a=this.unproject(e.getTopRight());return new Zt(s,a)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(e,s,a){e=Ct(e),a=tt(a||[0,0]);var c=this.getZoom()||0,d=this.getMinZoom(),_=this.getMaxZoom(),y=e.getNorthWest(),x=e.getSouthEast(),E=this.getSize().subtract(a),R=Et(this.project(x,c),this.project(y,c)).getSize(),q=J.any3d?this.options.zoomSnap:1,et=E.x/R.x,ct=E.y/R.y,ee=s?Math.max(et,ct):Math.min(et,ct);return c=this.getScaleZoom(ee,c),q&&(c=Math.round(c/(q/100))*(q/100),c=s?Math.ceil(c/q)*q:Math.floor(c/q)*q),Math.max(d,Math.min(_,c))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new K(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(e,s){var a=this._getTopLeftPoint(e,s);return new pt(a,a.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(e){return this.options.crs.getProjectedBounds(e===void 0?this.getZoom():e)},getPane:function(e){return typeof e=="string"?this._panes[e]:e},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(e,s){var a=this.options.crs;return s=s===void 0?this._zoom:s,a.scale(e)/a.scale(s)},getScaleZoom:function(e,s){var a=this.options.crs;s=s===void 0?this._zoom:s;var c=a.zoom(e*a.scale(s));return isNaN(c)?1/0:c},project:function(e,s){return s=s===void 0?this._zoom:s,this.options.crs.latLngToPoint(at(e),s)},unproject:function(e,s){return s=s===void 0?this._zoom:s,this.options.crs.pointToLatLng(tt(e),s)},layerPointToLatLng:function(e){var s=tt(e).add(this.getPixelOrigin());return this.unproject(s)},latLngToLayerPoint:function(e){var s=this.project(at(e))._round();return s._subtract(this.getPixelOrigin())},wrapLatLng:function(e){return this.options.crs.wrapLatLng(at(e))},wrapLatLngBounds:function(e){return this.options.crs.wrapLatLngBounds(Ct(e))},distance:function(e,s){return this.options.crs.distance(at(e),at(s))},containerPointToLayerPoint:function(e){return tt(e).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(e){return tt(e).add(this._getMapPanePos())},containerPointToLatLng:function(e){var s=this.containerPointToLayerPoint(tt(e));return this.layerPointToLatLng(s)},latLngToContainerPoint:function(e){return this.layerPointToContainerPoint(this.latLngToLayerPoint(at(e)))},mouseEventToContainerPoint:function(e){return da(e,this._container)},mouseEventToLayerPoint:function(e){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(e))},mouseEventToLatLng:function(e){return this.layerPointToLatLng(this.mouseEventToLayerPoint(e))},_initContainer:function(e){var s=this._container=la(e);if(s){if(s._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");rt(s,"scroll",this._onScroll,this),this._containerId=f(s)},_initLayout:function(){var e=this._container;this._fadeAnimated=this.options.fadeAnimation&&J.any3d,lt(e,"leaflet-container"+(J.touch?" leaflet-touch":"")+(J.retina?" leaflet-retina":"")+(J.ielt9?" leaflet-oldie":"")+(J.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var s=mn(e,"position");s!=="absolute"&&s!=="relative"&&s!=="fixed"&&s!=="sticky"&&(e.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var e=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Mt(this._mapPane,new K(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(lt(e.markerPane,"leaflet-zoom-hide"),lt(e.shadowPane,"leaflet-zoom-hide"))},_resetView:function(e,s,a){Mt(this._mapPane,new K(0,0));var c=!this._loaded;this._loaded=!0,s=this._limitZoom(s),this.fire("viewprereset");var d=this._zoom!==s;this._moveStart(d,a)._move(e,s)._moveEnd(d),this.fire("viewreset"),c&&this.fire("load")},_moveStart:function(e,s){return e&&this.fire("zoomstart"),s||this.fire("movestart"),this},_move:function(e,s,a,c){s===void 0&&(s=this._zoom);var d=this._zoom!==s;return this._zoom=s,this._lastCenter=e,this._pixelOrigin=this._getNewPixelOrigin(e),c?a&&a.pinch&&this.fire("zoom",a):((d||a&&a.pinch)&&this.fire("zoom",a),this.fire("move",a)),this},_moveEnd:function(e){return e&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return Ft(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(e){Mt(this._mapPane,this._getMapPanePos().subtract(e))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(e){this._targets={},this._targets[f(this._container)]=this;var s=e?xt:rt;s(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&s(window,"resize",this._onResize,this),J.any3d&&this.options.transform3DLimit&&(e?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){Ft(this._resizeRequest),this._resizeRequest=It(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var e=this._getMapPanePos();Math.max(Math.abs(e.x),Math.abs(e.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(e,s){for(var a=[],c,d=s==="mouseout"||s==="mouseover",_=e.target||e.srcElement,y=!1;_;){if(c=this._targets[f(_)],c&&(s==="click"||s==="preclick")&&this._draggableMoved(c)){y=!0;break}if(c&&c.listens(s,!0)&&(d&&!Or(_,e)||(a.push(c),d))||_===this._container)break;_=_.parentNode}return!a.length&&!y&&!d&&this.listens(s,!0)&&(a=[this]),a},_isClickDisabled:function(e){for(;e&&e!==this._container;){if(e._leaflet_disable_click)return!0;e=e.parentNode}},_handleDOMEvent:function(e){var s=e.target||e.srcElement;if(!(!this._loaded||s._leaflet_disable_events||e.type==="click"&&this._isClickDisabled(s))){var a=e.type;a==="mousedown"&&Tr(s),this._fireDOMEvent(e,a)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(e,s,a){if(e.type==="click"){var c=o({},e);c.type="preclick",this._fireDOMEvent(c,c.type,a)}var d=this._findEventTargets(e,s);if(a){for(var _=[],y=0;y<a.length;y++)a[y].listens(s,!0)&&_.push(a[y]);d=_.concat(d)}if(d.length){s==="contextmenu"&&Ht(e);var x=d[0],E={originalEvent:e};if(e.type!=="keypress"&&e.type!=="keydown"&&e.type!=="keyup"){var R=x.getLatLng&&(!x._radius||x._radius<=10);E.containerPoint=R?this.latLngToContainerPoint(x.getLatLng()):this.mouseEventToContainerPoint(e),E.layerPoint=this.containerPointToLayerPoint(E.containerPoint),E.latlng=R?x.getLatLng():this.layerPointToLatLng(E.layerPoint)}for(y=0;y<d.length;y++)if(d[y].fire(s,E,!0),E.originalEvent._stopped||d[y].options.bubblingMouseEvents===!1&&k(this._mouseEvents,s)!==-1)return}},_draggableMoved:function(e){return e=e.dragging&&e.dragging.enabled()?e:this,e.dragging&&e.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var e=0,s=this._handlers.length;e<s;e++)this._handlers[e].disable()},whenReady:function(e,s){return this._loaded?e.call(s||this,{target:this}):this.on("load",e,s),this},_getMapPanePos:function(){return vi(this._mapPane)||new K(0,0)},_moved:function(){var e=this._getMapPanePos();return e&&!e.equals([0,0])},_getTopLeftPoint:function(e,s){var a=e&&s!==void 0?this._getNewPixelOrigin(e,s):this.getPixelOrigin();return a.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(e,s){var a=this.getSize()._divideBy(2);return this.project(e,s)._subtract(a)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(e,s,a){var c=this._getNewPixelOrigin(a,s);return this.project(e,s)._subtract(c)},_latLngBoundsToNewLayerBounds:function(e,s,a){var c=this._getNewPixelOrigin(a,s);return Et([this.project(e.getSouthWest(),s)._subtract(c),this.project(e.getNorthWest(),s)._subtract(c),this.project(e.getSouthEast(),s)._subtract(c),this.project(e.getNorthEast(),s)._subtract(c)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(e){return this.latLngToLayerPoint(e).subtract(this._getCenterLayerPoint())},_limitCenter:function(e,s,a){if(!a)return e;var c=this.project(e,s),d=this.getSize().divideBy(2),_=new pt(c.subtract(d),c.add(d)),y=this._getBoundsOffset(_,a,s);return Math.abs(y.x)<=1&&Math.abs(y.y)<=1?e:this.unproject(c.add(y),s)},_limitOffset:function(e,s){if(!s)return e;var a=this.getPixelBounds(),c=new pt(a.min.add(e),a.max.add(e));return e.add(this._getBoundsOffset(c,s))},_getBoundsOffset:function(e,s,a){var c=Et(this.project(s.getNorthEast(),a),this.project(s.getSouthWest(),a)),d=c.min.subtract(e.min),_=c.max.subtract(e.max),y=this._rebound(d.x,-_.x),x=this._rebound(d.y,-_.y);return new K(y,x)},_rebound:function(e,s){return e+s>0?Math.round(e-s)/2:Math.max(0,Math.ceil(e))-Math.max(0,Math.floor(s))},_limitZoom:function(e){var s=this.getMinZoom(),a=this.getMaxZoom(),c=J.any3d?this.options.zoomSnap:1;return c&&(e=Math.round(e/c)*c),Math.max(s,Math.min(a,e))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Rt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(e,s){var a=this._getCenterOffset(e)._trunc();return(s&&s.animate)!==!0&&!this.getSize().contains(a)?!1:(this.panBy(a,s),!0)},_createAnimProxy:function(){var e=this._proxy=ft("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(e),this.on("zoomanim",function(s){var a=_r,c=this._proxy.style[a];gi(this._proxy,this.project(s.center,s.zoom),this.getZoomScale(s.zoom,1)),c===this._proxy.style[a]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Ot(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var e=this.getCenter(),s=this.getZoom();gi(this._proxy,this.project(e,s),this.getZoomScale(s,1))},_catchTransitionEnd:function(e){this._animatingZoom&&e.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(e,s,a){if(this._animatingZoom)return!0;if(a=a||{},!this._zoomAnimated||a.animate===!1||this._nothingToAnimate()||Math.abs(s-this._zoom)>this.options.zoomAnimationThreshold)return!1;var c=this.getZoomScale(s),d=this._getCenterOffset(e)._divideBy(1-1/c);return a.animate!==!0&&!this.getSize().contains(d)?!1:(It(function(){this._moveStart(!0,a.noMoveStart||!1)._animateZoom(e,s,!0)},this),!0)},_animateZoom:function(e,s,a,c){this._mapPane&&(a&&(this._animatingZoom=!0,this._animateToCenter=e,this._animateToZoom=s,lt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:e,zoom:s,noUpdate:c}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(u(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Rt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Hc(e,s){return new ht(e,s)}var xe=le.extend({options:{position:"topright"},initialize:function(e){P(this,e)},getPosition:function(){return this.options.position},setPosition:function(e){var s=this._map;return s&&s.removeControl(this),this.options.position=e,s&&s.addControl(this),this},getContainer:function(){return this._container},addTo:function(e){this.remove(),this._map=e;var s=this._container=this.onAdd(e),a=this.getPosition(),c=e._controlCorners[a];return lt(s,"leaflet-control"),a.indexOf("bottom")!==-1?c.insertBefore(s,c.firstChild):c.appendChild(s),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Ot(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(e){this._map&&e&&e.screenX>0&&e.screenY>0&&this._map.getContainer().focus()}}),bn=function(e){return new xe(e)};ht.include({addControl:function(e){return e.addTo(this),this},removeControl:function(e){return e.remove(),this},_initControlPos:function(){var e=this._controlCorners={},s="leaflet-",a=this._controlContainer=ft("div",s+"control-container",this._container);function c(d,_){var y=s+d+" "+s+_;e[d+_]=ft("div",y,a)}c("top","left"),c("top","right"),c("bottom","left"),c("bottom","right")},_clearControlPos:function(){for(var e in this._controlCorners)Ot(this._controlCorners[e]);Ot(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var _a=xe.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(e,s,a,c){return a<c?-1:c<a?1:0}},initialize:function(e,s,a){P(this,a),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var c in e)this._addLayer(e[c],c);for(c in s)this._addLayer(s[c],c,!0)},onAdd:function(e){this._initLayout(),this._update(),this._map=e,e.on("zoomend",this._checkDisabledLayers,this);for(var s=0;s<this._layers.length;s++)this._layers[s].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(e){return xe.prototype.addTo.call(this,e),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(e,s){return this._addLayer(e,s),this._map?this._update():this},addOverlay:function(e,s){return this._addLayer(e,s,!0),this._map?this._update():this},removeLayer:function(e){e.off("add remove",this._onLayerChange,this);var s=this._getLayer(f(e));return s&&this._layers.splice(this._layers.indexOf(s),1),this._map?this._update():this},expand:function(){lt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var e=this._map.getSize().y-(this._container.offsetTop+50);return e<this._section.clientHeight?(lt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=e+"px"):Rt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Rt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var e="leaflet-control-layers",s=this._container=ft("div",e),a=this.options.collapsed;s.setAttribute("aria-haspopup",!0),wn(s),kr(s);var c=this._section=ft("section",e+"-list");a&&(this._map.on("click",this.collapse,this),rt(s,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var d=this._layersLink=ft("a",e+"-toggle",s);d.href="#",d.title="Layers",d.setAttribute("role","button"),rt(d,{keydown:function(_){_.keyCode===13&&this._expandSafely()},click:function(_){Ht(_),this._expandSafely()}},this),a||this.expand(),this._baseLayersList=ft("div",e+"-base",c),this._separator=ft("div",e+"-separator",c),this._overlaysList=ft("div",e+"-overlays",c),s.appendChild(c)},_getLayer:function(e){for(var s=0;s<this._layers.length;s++)if(this._layers[s]&&f(this._layers[s].layer)===e)return this._layers[s]},_addLayer:function(e,s,a){this._map&&e.on("add remove",this._onLayerChange,this),this._layers.push({layer:e,name:s,overlay:a}),this.options.sortLayers&&this._layers.sort(u(function(c,d){return this.options.sortFunction(c.layer,d.layer,c.name,d.name)},this)),this.options.autoZIndex&&e.setZIndex&&(this._lastZIndex++,e.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;cs(this._baseLayersList),cs(this._overlaysList),this._layerControlInputs=[];var e,s,a,c,d=0;for(a=0;a<this._layers.length;a++)c=this._layers[a],this._addItem(c),s=s||c.overlay,e=e||!c.overlay,d+=c.overlay?0:1;return this.options.hideSingleBase&&(e=e&&d>1,this._baseLayersList.style.display=e?"":"none"),this._separator.style.display=s&&e?"":"none",this},_onLayerChange:function(e){this._handlingClick||this._update();var s=this._getLayer(f(e.target)),a=s.overlay?e.type==="add"?"overlayadd":"overlayremove":e.type==="add"?"baselayerchange":null;a&&this._map.fire(a,s)},_createRadioElement:function(e,s){var a='<input type="radio" class="leaflet-control-layers-selector" name="'+e+'"'+(s?' checked="checked"':"")+"/>",c=document.createElement("div");return c.innerHTML=a,c.firstChild},_addItem:function(e){var s=document.createElement("label"),a=this._map.hasLayer(e.layer),c;e.overlay?(c=document.createElement("input"),c.type="checkbox",c.className="leaflet-control-layers-selector",c.defaultChecked=a):c=this._createRadioElement("leaflet-base-layers_"+f(this),a),this._layerControlInputs.push(c),c.layerId=f(e.layer),rt(c,"click",this._onInputClick,this);var d=document.createElement("span");d.innerHTML=" "+e.name;var _=document.createElement("span");s.appendChild(_),_.appendChild(c),_.appendChild(d);var y=e.overlay?this._overlaysList:this._baseLayersList;return y.appendChild(s),this._checkDisabledLayers(),s},_onInputClick:function(){if(!this._preventClick){var e=this._layerControlInputs,s,a,c=[],d=[];this._handlingClick=!0;for(var _=e.length-1;_>=0;_--)s=e[_],a=this._getLayer(s.layerId).layer,s.checked?c.push(a):s.checked||d.push(a);for(_=0;_<d.length;_++)this._map.hasLayer(d[_])&&this._map.removeLayer(d[_]);for(_=0;_<c.length;_++)this._map.hasLayer(c[_])||this._map.addLayer(c[_]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var e=this._layerControlInputs,s,a,c=this._map.getZoom(),d=e.length-1;d>=0;d--)s=e[d],a=this._getLayer(s.layerId).layer,s.disabled=a.options.minZoom!==void 0&&c<a.options.minZoom||a.options.maxZoom!==void 0&&c>a.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var e=this._section;this._preventClick=!0,rt(e,"click",Ht),this.expand();var s=this;setTimeout(function(){xt(e,"click",Ht),s._preventClick=!1})}}),qc=function(e,s,a){return new _a(e,s,a)},Cr=xe.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(e){var s="leaflet-control-zoom",a=ft("div",s+" leaflet-bar"),c=this.options;return this._zoomInButton=this._createButton(c.zoomInText,c.zoomInTitle,s+"-in",a,this._zoomIn),this._zoomOutButton=this._createButton(c.zoomOutText,c.zoomOutTitle,s+"-out",a,this._zoomOut),this._updateDisabled(),e.on("zoomend zoomlevelschange",this._updateDisabled,this),a},onRemove:function(e){e.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(e){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(e.shiftKey?3:1))},_zoomOut:function(e){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(e.shiftKey?3:1))},_createButton:function(e,s,a,c,d){var _=ft("a",a,c);return _.innerHTML=e,_.href="#",_.title=s,_.setAttribute("role","button"),_.setAttribute("aria-label",s),wn(_),rt(_,"click",wi),rt(_,"click",d,this),rt(_,"click",this._refocusOnMap,this),_},_updateDisabled:function(){var e=this._map,s="leaflet-disabled";Rt(this._zoomInButton,s),Rt(this._zoomOutButton,s),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||e._zoom===e.getMinZoom())&&(lt(this._zoomOutButton,s),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||e._zoom===e.getMaxZoom())&&(lt(this._zoomInButton,s),this._zoomInButton.setAttribute("aria-disabled","true"))}});ht.mergeOptions({zoomControl:!0}),ht.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Cr,this.addControl(this.zoomControl))});var Kc=function(e){return new Cr(e)},ma=xe.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(e){var s="leaflet-control-scale",a=ft("div",s),c=this.options;return this._addScales(c,s+"-line",a),e.on(c.updateWhenIdle?"moveend":"move",this._update,this),e.whenReady(this._update,this),a},onRemove:function(e){e.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(e,s,a){e.metric&&(this._mScale=ft("div",s,a)),e.imperial&&(this._iScale=ft("div",s,a))},_update:function(){var e=this._map,s=e.getSize().y/2,a=e.distance(e.containerPointToLatLng([0,s]),e.containerPointToLatLng([this.options.maxWidth,s]));this._updateScales(a)},_updateScales:function(e){this.options.metric&&e&&this._updateMetric(e),this.options.imperial&&e&&this._updateImperial(e)},_updateMetric:function(e){var s=this._getRoundNum(e),a=s<1e3?s+" m":s/1e3+" km";this._updateScale(this._mScale,a,s/e)},_updateImperial:function(e){var s=e*3.2808399,a,c,d;s>5280?(a=s/5280,c=this._getRoundNum(a),this._updateScale(this._iScale,c+" mi",c/a)):(d=this._getRoundNum(s),this._updateScale(this._iScale,d+" ft",d/s))},_updateScale:function(e,s,a){e.style.width=Math.round(this.options.maxWidth*a)+"px",e.innerHTML=s},_getRoundNum:function(e){var s=Math.pow(10,(Math.floor(e)+"").length-1),a=e/s;return a=a>=10?10:a>=5?5:a>=3?3:a>=2?2:1,s*a}}),Vc=function(e){return new ma(e)},Gc='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Ar=xe.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(J.inlineSvg?Gc+" ":"")+"Leaflet</a>"},initialize:function(e){P(this,e),this._attributions={}},onAdd:function(e){e.attributionControl=this,this._container=ft("div","leaflet-control-attribution"),wn(this._container);for(var s in e._layers)e._layers[s].getAttribution&&this.addAttribution(e._layers[s].getAttribution());return this._update(),e.on("layeradd",this._addAttribution,this),this._container},onRemove:function(e){e.off("layeradd",this._addAttribution,this)},_addAttribution:function(e){e.layer.getAttribution&&(this.addAttribution(e.layer.getAttribution()),e.layer.once("remove",function(){this.removeAttribution(e.layer.getAttribution())},this))},setPrefix:function(e){return this.options.prefix=e,this._update(),this},addAttribution:function(e){return e?(this._attributions[e]||(this._attributions[e]=0),this._attributions[e]++,this._update(),this):this},removeAttribution:function(e){return e?(this._attributions[e]&&(this._attributions[e]--,this._update()),this):this},_update:function(){if(this._map){var e=[];for(var s in this._attributions)this._attributions[s]&&e.push(s);var a=[];this.options.prefix&&a.push(this.options.prefix),e.length&&a.push(e.join(", ")),this._container.innerHTML=a.join(' <span aria-hidden="true">|</span> ')}}});ht.mergeOptions({attributionControl:!0}),ht.addInitHook(function(){this.options.attributionControl&&new Ar().addTo(this)});var Jc=function(e){return new Ar(e)};xe.Layers=_a,xe.Zoom=Cr,xe.Scale=ma,xe.Attribution=Ar,bn.layers=qc,bn.zoom=Kc,bn.scale=Vc,bn.attribution=Jc;var Me=le.extend({initialize:function(e){this._map=e},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Me.addTo=function(e,s){return e.addHandler(s,this),this};var Yc={Events:yt},ga=J.touch?"touchstart mousedown":"mousedown",ri=wt.extend({options:{clickTolerance:3},initialize:function(e,s,a,c){P(this,c),this._element=e,this._dragStartTarget=s||e,this._preventOutline=a},enable:function(){this._enabled||(rt(this._dragStartTarget,ga,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(ri._dragging===this&&this.finishDrag(!0),xt(this._dragStartTarget,ga,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(e){if(this._enabled&&(this._moved=!1,!mr(this._element,"leaflet-zoom-anim"))){if(e.touches&&e.touches.length!==1){ri._dragging===this&&this.finishDrag();return}if(!(ri._dragging||e.shiftKey||e.which!==1&&e.button!==1&&!e.touches)&&(ri._dragging=this,this._preventOutline&&Tr(this._element),yr(),gn(),!this._moving)){this.fire("down");var s=e.touches?e.touches[0]:e,a=ua(this._element);this._startPoint=new K(s.clientX,s.clientY),this._startPos=vi(this._element),this._parentScale=xr(a);var c=e.type==="mousedown";rt(document,c?"mousemove":"touchmove",this._onMove,this),rt(document,c?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(e){if(this._enabled){if(e.touches&&e.touches.length>1){this._moved=!0;return}var s=e.touches&&e.touches.length===1?e.touches[0]:e,a=new K(s.clientX,s.clientY)._subtract(this._startPoint);!a.x&&!a.y||Math.abs(a.x)+Math.abs(a.y)<this.options.clickTolerance||(a.x/=this._parentScale.x,a.y/=this._parentScale.y,Ht(e),this._moved||(this.fire("dragstart"),this._moved=!0,lt(document.body,"leaflet-dragging"),this._lastTarget=e.target||e.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),lt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(a),this._moving=!0,this._lastEvent=e,this._updatePosition())}},_updatePosition:function(){var e={originalEvent:this._lastEvent};this.fire("predrag",e),Mt(this._element,this._newPos),this.fire("drag",e)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(e){Rt(document.body,"leaflet-dragging"),this._lastTarget&&(Rt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),xt(document,"mousemove touchmove",this._onMove,this),xt(document,"mouseup touchend touchcancel",this._onUp,this),wr(),vn();var s=this._moved&&this._moving;this._moving=!1,ri._dragging=!1,s&&this.fire("dragend",{noInertia:e,distance:this._newPos.distanceTo(this._startPos)})}});function va(e,s,a){var c,d=[1,4,2,8],_,y,x,E,R,q,et,ct;for(_=0,q=e.length;_<q;_++)e[_]._code=bi(e[_],s);for(x=0;x<4;x++){for(et=d[x],c=[],_=0,q=e.length,y=q-1;_<q;y=_++)E=e[_],R=e[y],E._code&et?R._code&et||(ct=_s(R,E,et,s,a),ct._code=bi(ct,s),c.push(ct)):(R._code&et&&(ct=_s(R,E,et,s,a),ct._code=bi(ct,s),c.push(ct)),c.push(E));e=c}return e}function ya(e,s){var a,c,d,_,y,x,E,R,q;if(!e||e.length===0)throw new Error("latlngs not passed");ye(e)||(console.warn("latlngs are not flat! Only the first ring will be used"),e=e[0]);var et=at([0,0]),ct=Ct(e),ee=ct.getNorthWest().distanceTo(ct.getSouthWest())*ct.getNorthEast().distanceTo(ct.getNorthWest());ee<1700&&(et=Lr(e));var zt=e.length,we=[];for(a=0;a<zt;a++){var oe=at(e[a]);we.push(s.project(at([oe.lat-et.lat,oe.lng-et.lng])))}for(x=E=R=0,a=0,c=zt-1;a<zt;c=a++)d=we[a],_=we[c],y=d.y*_.x-_.y*d.x,E+=(d.x+_.x)*y,R+=(d.y+_.y)*y,x+=y*3;x===0?q=we[0]:q=[E/x,R/x];var Hi=s.unproject(tt(q));return at([Hi.lat+et.lat,Hi.lng+et.lng])}function Lr(e){for(var s=0,a=0,c=0,d=0;d<e.length;d++){var _=at(e[d]);s+=_.lat,a+=_.lng,c++}return at([s/c,a/c])}var Xc={__proto__:null,clipPolygon:va,polygonCenter:ya,centroid:Lr};function wa(e,s){if(!s||!e.length)return e.slice();var a=s*s;return e=eh(e,a),e=th(e,a),e}function ba(e,s,a){return Math.sqrt(Tn(e,s,a,!0))}function Qc(e,s,a){return Tn(e,s,a)}function th(e,s){var a=e.length,c=typeof Uint8Array<"u"?Uint8Array:Array,d=new c(a);d[0]=d[a-1]=1,Rr(e,d,s,0,a-1);var _,y=[];for(_=0;_<a;_++)d[_]&&y.push(e[_]);return y}function Rr(e,s,a,c,d){var _=0,y,x,E;for(x=c+1;x<=d-1;x++)E=Tn(e[x],e[c],e[d],!0),E>_&&(y=x,_=E);_>a&&(s[y]=1,Rr(e,s,a,c,y),Rr(e,s,a,y,d))}function eh(e,s){for(var a=[e[0]],c=1,d=0,_=e.length;c<_;c++)ih(e[c],e[d])>s&&(a.push(e[c]),d=c);return d<_-1&&a.push(e[_-1]),a}var Ta;function xa(e,s,a,c,d){var _=c?Ta:bi(e,a),y=bi(s,a),x,E,R;for(Ta=y;;){if(!(_|y))return[e,s];if(_&y)return!1;x=_||y,E=_s(e,s,x,a,d),R=bi(E,a),x===_?(e=E,_=R):(s=E,y=R)}}function _s(e,s,a,c,d){var _=s.x-e.x,y=s.y-e.y,x=c.min,E=c.max,R,q;return a&8?(R=e.x+_*(E.y-e.y)/y,q=E.y):a&4?(R=e.x+_*(x.y-e.y)/y,q=x.y):a&2?(R=E.x,q=e.y+y*(E.x-e.x)/_):a&1&&(R=x.x,q=e.y+y*(x.x-e.x)/_),new K(R,q,d)}function bi(e,s){var a=0;return e.x<s.min.x?a|=1:e.x>s.max.x&&(a|=2),e.y<s.min.y?a|=4:e.y>s.max.y&&(a|=8),a}function ih(e,s){var a=s.x-e.x,c=s.y-e.y;return a*a+c*c}function Tn(e,s,a,c){var d=s.x,_=s.y,y=a.x-d,x=a.y-_,E=y*y+x*x,R;return E>0&&(R=((e.x-d)*y+(e.y-_)*x)/E,R>1?(d=a.x,_=a.y):R>0&&(d+=y*R,_+=x*R)),y=e.x-d,x=e.y-_,c?y*y+x*x:new K(d,_)}function ye(e){return!O(e[0])||typeof e[0][0]!="object"&&typeof e[0][0]<"u"}function Sa(e){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),ye(e)}function Pa(e,s){var a,c,d,_,y,x,E,R;if(!e||e.length===0)throw new Error("latlngs not passed");ye(e)||(console.warn("latlngs are not flat! Only the first ring will be used"),e=e[0]);var q=at([0,0]),et=Ct(e),ct=et.getNorthWest().distanceTo(et.getSouthWest())*et.getNorthEast().distanceTo(et.getNorthWest());ct<1700&&(q=Lr(e));var ee=e.length,zt=[];for(a=0;a<ee;a++){var we=at(e[a]);zt.push(s.project(at([we.lat-q.lat,we.lng-q.lng])))}for(a=0,c=0;a<ee-1;a++)c+=zt[a].distanceTo(zt[a+1])/2;if(c===0)R=zt[0];else for(a=0,_=0;a<ee-1;a++)if(y=zt[a],x=zt[a+1],d=y.distanceTo(x),_+=d,_>c){E=(_-c)/d,R=[x.x-E*(x.x-y.x),x.y-E*(x.y-y.y)];break}var oe=s.unproject(tt(R));return at([oe.lat+q.lat,oe.lng+q.lng])}var nh={__proto__:null,simplify:wa,pointToSegmentDistance:ba,closestPointOnSegment:Qc,clipSegment:xa,_getEdgeIntersection:_s,_getBitCode:bi,_sqClosestPointOnSegment:Tn,isFlat:ye,_flat:Sa,polylineCenter:Pa},Ir={project:function(e){return new K(e.lng,e.lat)},unproject:function(e){return new mt(e.y,e.x)},bounds:new pt([-180,-90],[180,90])},Mr={R:6378137,R_MINOR:6356752314245179e-9,bounds:new pt([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(e){var s=Math.PI/180,a=this.R,c=e.lat*s,d=this.R_MINOR/a,_=Math.sqrt(1-d*d),y=_*Math.sin(c),x=Math.tan(Math.PI/4-c/2)/Math.pow((1-y)/(1+y),_/2);return c=-a*Math.log(Math.max(x,1e-10)),new K(e.lng*s*a,c)},unproject:function(e){for(var s=180/Math.PI,a=this.R,c=this.R_MINOR/a,d=Math.sqrt(1-c*c),_=Math.exp(-e.y/a),y=Math.PI/2-2*Math.atan(_),x=0,E=.1,R;x<15&&Math.abs(E)>1e-7;x++)R=d*Math.sin(y),R=Math.pow((1-R)/(1+R),d/2),E=Math.PI/2-2*Math.atan(_*R)-y,y+=E;return new mt(y*s,e.x*s/a)}},sh={__proto__:null,LonLat:Ir,Mercator:Mr,SphericalMercator:Fe},rh=o({},_e,{code:"EPSG:3395",projection:Mr,transformation:(function(){var e=.5/(Math.PI*Mr.R);return v(e,.5,-e,.5)})()}),Ea=o({},_e,{code:"EPSG:4326",projection:Ir,transformation:v(1/180,1,-1/180,.5)}),oh=o({},re,{projection:Ir,transformation:v(1,0,-1,0),scale:function(e){return Math.pow(2,e)},zoom:function(e){return Math.log(e)/Math.LN2},distance:function(e,s){var a=s.lng-e.lng,c=s.lat-e.lat;return Math.sqrt(a*a+c*c)},infinite:!0});re.Earth=_e,re.EPSG3395=rh,re.EPSG3857=T,re.EPSG900913=C,re.EPSG4326=Ea,re.Simple=oh;var Se=wt.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(e){return e.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(e){return e&&e.removeLayer(this),this},getPane:function(e){return this._map.getPane(e?this.options[e]||e:this.options.pane)},addInteractiveTarget:function(e){return this._map._targets[f(e)]=this,this},removeInteractiveTarget:function(e){return delete this._map._targets[f(e)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(e){var s=e.target;if(s.hasLayer(this)){if(this._map=s,this._zoomAnimated=s._zoomAnimated,this.getEvents){var a=this.getEvents();s.on(a,this),this.once("remove",function(){s.off(a,this)},this)}this.onAdd(s),this.fire("add"),s.fire("layeradd",{layer:this})}}});ht.include({addLayer:function(e){if(!e._layerAdd)throw new Error("The provided object is not a Layer.");var s=f(e);return this._layers[s]?this:(this._layers[s]=e,e._mapToAdd=this,e.beforeAdd&&e.beforeAdd(this),this.whenReady(e._layerAdd,e),this)},removeLayer:function(e){var s=f(e);return this._layers[s]?(this._loaded&&e.onRemove(this),delete this._layers[s],this._loaded&&(this.fire("layerremove",{layer:e}),e.fire("remove")),e._map=e._mapToAdd=null,this):this},hasLayer:function(e){return f(e)in this._layers},eachLayer:function(e,s){for(var a in this._layers)e.call(s,this._layers[a]);return this},_addLayers:function(e){e=e?O(e)?e:[e]:[];for(var s=0,a=e.length;s<a;s++)this.addLayer(e[s])},_addZoomLimit:function(e){(!isNaN(e.options.maxZoom)||!isNaN(e.options.minZoom))&&(this._zoomBoundLayers[f(e)]=e,this._updateZoomLevels())},_removeZoomLimit:function(e){var s=f(e);this._zoomBoundLayers[s]&&(delete this._zoomBoundLayers[s],this._updateZoomLevels())},_updateZoomLevels:function(){var e=1/0,s=-1/0,a=this._getZoomSpan();for(var c in this._zoomBoundLayers){var d=this._zoomBoundLayers[c].options;e=d.minZoom===void 0?e:Math.min(e,d.minZoom),s=d.maxZoom===void 0?s:Math.max(s,d.maxZoom)}this._layersMaxZoom=s===-1/0?void 0:s,this._layersMinZoom=e===1/0?void 0:e,a!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var $i=Se.extend({initialize:function(e,s){P(this,s),this._layers={};var a,c;if(e)for(a=0,c=e.length;a<c;a++)this.addLayer(e[a])},addLayer:function(e){var s=this.getLayerId(e);return this._layers[s]=e,this._map&&this._map.addLayer(e),this},removeLayer:function(e){var s=e in this._layers?e:this.getLayerId(e);return this._map&&this._layers[s]&&this._map.removeLayer(this._layers[s]),delete this._layers[s],this},hasLayer:function(e){var s=typeof e=="number"?e:this.getLayerId(e);return s in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(e){var s=Array.prototype.slice.call(arguments,1),a,c;for(a in this._layers)c=this._layers[a],c[e]&&c[e].apply(c,s);return this},onAdd:function(e){this.eachLayer(e.addLayer,e)},onRemove:function(e){this.eachLayer(e.removeLayer,e)},eachLayer:function(e,s){for(var a in this._layers)e.call(s,this._layers[a]);return this},getLayer:function(e){return this._layers[e]},getLayers:function(){var e=[];return this.eachLayer(e.push,e),e},setZIndex:function(e){return this.invoke("setZIndex",e)},getLayerId:function(e){return f(e)}}),ah=function(e,s){return new $i(e,s)},Ze=$i.extend({addLayer:function(e){return this.hasLayer(e)?this:(e.addEventParent(this),$i.prototype.addLayer.call(this,e),this.fire("layeradd",{layer:e}))},removeLayer:function(e){return this.hasLayer(e)?(e in this._layers&&(e=this._layers[e]),e.removeEventParent(this),$i.prototype.removeLayer.call(this,e),this.fire("layerremove",{layer:e})):this},setStyle:function(e){return this.invoke("setStyle",e)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var e=new Zt;for(var s in this._layers){var a=this._layers[s];e.extend(a.getBounds?a.getBounds():a.getLatLng())}return e}}),lh=function(e,s){return new Ze(e,s)},zi=le.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(e){P(this,e)},createIcon:function(e){return this._createIcon("icon",e)},createShadow:function(e){return this._createIcon("shadow",e)},_createIcon:function(e,s){var a=this._getIconUrl(e);if(!a){if(e==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var c=this._createImg(a,s&&s.tagName==="IMG"?s:null);return this._setIconStyles(c,e),(this.options.crossOrigin||this.options.crossOrigin==="")&&(c.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),c},_setIconStyles:function(e,s){var a=this.options,c=a[s+"Size"];typeof c=="number"&&(c=[c,c]);var d=tt(c),_=tt(s==="shadow"&&a.shadowAnchor||a.iconAnchor||d&&d.divideBy(2,!0));e.className="leaflet-marker-"+s+" "+(a.className||""),_&&(e.style.marginLeft=-_.x+"px",e.style.marginTop=-_.y+"px"),d&&(e.style.width=d.x+"px",e.style.height=d.y+"px")},_createImg:function(e,s){return s=s||document.createElement("img"),s.src=e,s},_getIconUrl:function(e){return J.retina&&this.options[e+"RetinaUrl"]||this.options[e+"Url"]}});function uh(e){return new zi(e)}var xn=zi.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(e){return typeof xn.imagePath!="string"&&(xn.imagePath=this._detectIconPath()),(this.options.imagePath||xn.imagePath)+zi.prototype._getIconUrl.call(this,e)},_stripUrl:function(e){var s=function(a,c,d){var _=c.exec(a);return _&&_[d]};return e=s(e,/^url\((['"])?(.+)\1\)$/,2),e&&s(e,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var e=ft("div","leaflet-default-icon-path",document.body),s=mn(e,"background-image")||mn(e,"backgroundImage");if(document.body.removeChild(e),s=this._stripUrl(s),s)return s;var a=document.querySelector('link[href$="leaflet.css"]');return a?a.href.substring(0,a.href.length-11-1):""}}),ka=Me.extend({initialize:function(e){this._marker=e},addHooks:function(){var e=this._marker._icon;this._draggable||(this._draggable=new ri(e,e,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),lt(e,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Rt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(e){var s=this._marker,a=s._map,c=this._marker.options.autoPanSpeed,d=this._marker.options.autoPanPadding,_=vi(s._icon),y=a.getPixelBounds(),x=a.getPixelOrigin(),E=Et(y.min._subtract(x).add(d),y.max._subtract(x).subtract(d));if(!E.contains(_)){var R=tt((Math.max(E.max.x,_.x)-E.max.x)/(y.max.x-E.max.x)-(Math.min(E.min.x,_.x)-E.min.x)/(y.min.x-E.min.x),(Math.max(E.max.y,_.y)-E.max.y)/(y.max.y-E.max.y)-(Math.min(E.min.y,_.y)-E.min.y)/(y.min.y-E.min.y)).multiplyBy(c);a.panBy(R,{animate:!1}),this._draggable._newPos._add(R),this._draggable._startPos._add(R),Mt(s._icon,this._draggable._newPos),this._onDrag(e),this._panRequest=It(this._adjustPan.bind(this,e))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(e){this._marker.options.autoPan&&(Ft(this._panRequest),this._panRequest=It(this._adjustPan.bind(this,e)))},_onDrag:function(e){var s=this._marker,a=s._shadow,c=vi(s._icon),d=s._map.layerPointToLatLng(c);a&&Mt(a,c),s._latlng=d,e.latlng=d,e.oldLatLng=this._oldLatLng,s.fire("move",e).fire("drag",e)},_onDragEnd:function(e){Ft(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",e)}}),ms=Se.extend({options:{icon:new xn,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(e,s){P(this,s),this._latlng=at(e)},onAdd:function(e){this._zoomAnimated=this._zoomAnimated&&e.options.markerZoomAnimation,this._zoomAnimated&&e.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(e){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&e.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(e){var s=this._latlng;return this._latlng=at(e),this.update(),this.fire("move",{oldLatLng:s,latlng:this._latlng})},setZIndexOffset:function(e){return this.options.zIndexOffset=e,this.update()},getIcon:function(){return this.options.icon},setIcon:function(e){return this.options.icon=e,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var e=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(e)}return this},_initIcon:function(){var e=this.options,s="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),a=e.icon.createIcon(this._icon),c=!1;a!==this._icon&&(this._icon&&this._removeIcon(),c=!0,e.title&&(a.title=e.title),a.tagName==="IMG"&&(a.alt=e.alt||"")),lt(a,s),e.keyboard&&(a.tabIndex="0",a.setAttribute("role","button")),this._icon=a,e.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&rt(a,"focus",this._panOnFocus,this);var d=e.icon.createShadow(this._shadow),_=!1;d!==this._shadow&&(this._removeShadow(),_=!0),d&&(lt(d,s),d.alt=""),this._shadow=d,e.opacity<1&&this._updateOpacity(),c&&this.getPane().appendChild(this._icon),this._initInteraction(),d&&_&&this.getPane(e.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&xt(this._icon,"focus",this._panOnFocus,this),Ot(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Ot(this._shadow),this._shadow=null},_setPos:function(e){this._icon&&Mt(this._icon,e),this._shadow&&Mt(this._shadow,e),this._zIndex=e.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(e){this._icon&&(this._icon.style.zIndex=this._zIndex+e)},_animateZoom:function(e){var s=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center).round();this._setPos(s)},_initInteraction:function(){if(this.options.interactive&&(lt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),ka)){var e=this.options.draggable;this.dragging&&(e=this.dragging.enabled(),this.dragging.disable()),this.dragging=new ka(this),e&&this.dragging.enable()}},setOpacity:function(e){return this.options.opacity=e,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var e=this.options.opacity;this._icon&&ve(this._icon,e),this._shadow&&ve(this._shadow,e)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var e=this._map;if(e){var s=this.options.icon.options,a=s.iconSize?tt(s.iconSize):tt(0,0),c=s.iconAnchor?tt(s.iconAnchor):tt(0,0);e.panInside(this._latlng,{paddingTopLeft:c,paddingBottomRight:a.subtract(c)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function ch(e,s){return new ms(e,s)}var oi=Se.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(e){this._renderer=e.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(e){return P(this,e),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&e&&Object.prototype.hasOwnProperty.call(e,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),gs=oi.extend({options:{fill:!0,radius:10},initialize:function(e,s){P(this,s),this._latlng=at(e),this._radius=this.options.radius},setLatLng:function(e){var s=this._latlng;return this._latlng=at(e),this.redraw(),this.fire("move",{oldLatLng:s,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(e){return this.options.radius=this._radius=e,this.redraw()},getRadius:function(){return this._radius},setStyle:function(e){var s=e&&e.radius||this._radius;return oi.prototype.setStyle.call(this,e),this.setRadius(s),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var e=this._radius,s=this._radiusY||e,a=this._clickTolerance(),c=[e+a,s+a];this._pxBounds=new pt(this._point.subtract(c),this._point.add(c))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(e){return e.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function hh(e,s){return new gs(e,s)}var Nr=gs.extend({initialize:function(e,s,a){if(typeof s=="number"&&(s=o({},a,{radius:s})),P(this,s),this._latlng=at(e),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(e){return this._mRadius=e,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var e=[this._radius,this._radiusY||this._radius];return new Zt(this._map.layerPointToLatLng(this._point.subtract(e)),this._map.layerPointToLatLng(this._point.add(e)))},setStyle:oi.prototype.setStyle,_project:function(){var e=this._latlng.lng,s=this._latlng.lat,a=this._map,c=a.options.crs;if(c.distance===_e.distance){var d=Math.PI/180,_=this._mRadius/_e.R/d,y=a.project([s+_,e]),x=a.project([s-_,e]),E=y.add(x).divideBy(2),R=a.unproject(E).lat,q=Math.acos((Math.cos(_*d)-Math.sin(s*d)*Math.sin(R*d))/(Math.cos(s*d)*Math.cos(R*d)))/d;(isNaN(q)||q===0)&&(q=_/Math.cos(Math.PI/180*s)),this._point=E.subtract(a.getPixelOrigin()),this._radius=isNaN(q)?0:E.x-a.project([R,e-q]).x,this._radiusY=E.y-y.y}else{var et=c.unproject(c.project(this._latlng).subtract([this._mRadius,0]));this._point=a.latLngToLayerPoint(this._latlng),this._radius=this._point.x-a.latLngToLayerPoint(et).x}this._updateBounds()}});function dh(e,s,a){return new Nr(e,s,a)}var We=oi.extend({options:{smoothFactor:1,noClip:!1},initialize:function(e,s){P(this,s),this._setLatLngs(e)},getLatLngs:function(){return this._latlngs},setLatLngs:function(e){return this._setLatLngs(e),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(e){for(var s=1/0,a=null,c=Tn,d,_,y=0,x=this._parts.length;y<x;y++)for(var E=this._parts[y],R=1,q=E.length;R<q;R++){d=E[R-1],_=E[R];var et=c(e,d,_,!0);et<s&&(s=et,a=c(e,d,_))}return a&&(a.distance=Math.sqrt(s)),a},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Pa(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(e,s){return s=s||this._defaultShape(),e=at(e),s.push(e),this._bounds.extend(e),this.redraw()},_setLatLngs:function(e){this._bounds=new Zt,this._latlngs=this._convertLatLngs(e)},_defaultShape:function(){return ye(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(e){for(var s=[],a=ye(e),c=0,d=e.length;c<d;c++)a?(s[c]=at(e[c]),this._bounds.extend(s[c])):s[c]=this._convertLatLngs(e[c]);return s},_project:function(){var e=new pt;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,e),this._bounds.isValid()&&e.isValid()&&(this._rawPxBounds=e,this._updateBounds())},_updateBounds:function(){var e=this._clickTolerance(),s=new K(e,e);this._rawPxBounds&&(this._pxBounds=new pt([this._rawPxBounds.min.subtract(s),this._rawPxBounds.max.add(s)]))},_projectLatlngs:function(e,s,a){var c=e[0]instanceof mt,d=e.length,_,y;if(c){for(y=[],_=0;_<d;_++)y[_]=this._map.latLngToLayerPoint(e[_]),a.extend(y[_]);s.push(y)}else for(_=0;_<d;_++)this._projectLatlngs(e[_],s,a)},_clipPoints:function(){var e=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(e))){if(this.options.noClip){this._parts=this._rings;return}var s=this._parts,a,c,d,_,y,x,E;for(a=0,d=0,_=this._rings.length;a<_;a++)for(E=this._rings[a],c=0,y=E.length;c<y-1;c++)x=xa(E[c],E[c+1],e,c,!0),x&&(s[d]=s[d]||[],s[d].push(x[0]),(x[1]!==E[c+1]||c===y-2)&&(s[d].push(x[1]),d++))}},_simplifyPoints:function(){for(var e=this._parts,s=this.options.smoothFactor,a=0,c=e.length;a<c;a++)e[a]=wa(e[a],s)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(e,s){var a,c,d,_,y,x,E=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(e))return!1;for(a=0,_=this._parts.length;a<_;a++)for(x=this._parts[a],c=0,y=x.length,d=y-1;c<y;d=c++)if(!(!s&&c===0)&&ba(e,x[d],x[c])<=E)return!0;return!1}});function fh(e,s){return new We(e,s)}We._flat=Sa;var Fi=We.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return ya(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(e){var s=We.prototype._convertLatLngs.call(this,e),a=s.length;return a>=2&&s[0]instanceof mt&&s[0].equals(s[a-1])&&s.pop(),s},_setLatLngs:function(e){We.prototype._setLatLngs.call(this,e),ye(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return ye(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var e=this._renderer._bounds,s=this.options.weight,a=new K(s,s);if(e=new pt(e.min.subtract(a),e.max.add(a)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(e))){if(this.options.noClip){this._parts=this._rings;return}for(var c=0,d=this._rings.length,_;c<d;c++)_=va(this._rings[c],e,!0),_.length&&this._parts.push(_)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(e){var s=!1,a,c,d,_,y,x,E,R;if(!this._pxBounds||!this._pxBounds.contains(e))return!1;for(_=0,E=this._parts.length;_<E;_++)for(a=this._parts[_],y=0,R=a.length,x=R-1;y<R;x=y++)c=a[y],d=a[x],c.y>e.y!=d.y>e.y&&e.x<(d.x-c.x)*(e.y-c.y)/(d.y-c.y)+c.x&&(s=!s);return s||We.prototype._containsPoint.call(this,e,!0)}});function ph(e,s){return new Fi(e,s)}var He=Ze.extend({initialize:function(e,s){P(this,s),this._layers={},e&&this.addData(e)},addData:function(e){var s=O(e)?e:e.features,a,c,d;if(s){for(a=0,c=s.length;a<c;a++)d=s[a],(d.geometries||d.geometry||d.features||d.coordinates)&&this.addData(d);return this}var _=this.options;if(_.filter&&!_.filter(e))return this;var y=vs(e,_);return y?(y.feature=bs(e),y.defaultOptions=y.options,this.resetStyle(y),_.onEachFeature&&_.onEachFeature(e,y),this.addLayer(y)):this},resetStyle:function(e){return e===void 0?this.eachLayer(this.resetStyle,this):(e.options=o({},e.defaultOptions),this._setLayerStyle(e,this.options.style),this)},setStyle:function(e){return this.eachLayer(function(s){this._setLayerStyle(s,e)},this)},_setLayerStyle:function(e,s){e.setStyle&&(typeof s=="function"&&(s=s(e.feature)),e.setStyle(s))}});function vs(e,s){var a=e.type==="Feature"?e.geometry:e,c=a?a.coordinates:null,d=[],_=s&&s.pointToLayer,y=s&&s.coordsToLatLng||jr,x,E,R,q;if(!c&&!a)return null;switch(a.type){case"Point":return x=y(c),Oa(_,e,x,s);case"MultiPoint":for(R=0,q=c.length;R<q;R++)x=y(c[R]),d.push(Oa(_,e,x,s));return new Ze(d);case"LineString":case"MultiLineString":return E=ys(c,a.type==="LineString"?0:1,y),new We(E,s);case"Polygon":case"MultiPolygon":return E=ys(c,a.type==="Polygon"?1:2,y),new Fi(E,s);case"GeometryCollection":for(R=0,q=a.geometries.length;R<q;R++){var et=vs({geometry:a.geometries[R],type:"Feature",properties:e.properties},s);et&&d.push(et)}return new Ze(d);case"FeatureCollection":for(R=0,q=a.features.length;R<q;R++){var ct=vs(a.features[R],s);ct&&d.push(ct)}return new Ze(d);default:throw new Error("Invalid GeoJSON object.")}}function Oa(e,s,a,c){return e?e(s,a):new ms(a,c&&c.markersInheritOptions&&c)}function jr(e){return new mt(e[1],e[0],e[2])}function ys(e,s,a){for(var c=[],d=0,_=e.length,y;d<_;d++)y=s?ys(e[d],s-1,a):(a||jr)(e[d]),c.push(y);return c}function Dr(e,s){return e=at(e),e.alt!==void 0?[w(e.lng,s),w(e.lat,s),w(e.alt,s)]:[w(e.lng,s),w(e.lat,s)]}function ws(e,s,a,c){for(var d=[],_=0,y=e.length;_<y;_++)d.push(s?ws(e[_],ye(e[_])?0:s-1,a,c):Dr(e[_],c));return!s&&a&&d.length>0&&d.push(d[0].slice()),d}function Zi(e,s){return e.feature?o({},e.feature,{geometry:s}):bs(s)}function bs(e){return e.type==="Feature"||e.type==="FeatureCollection"?e:{type:"Feature",properties:{},geometry:e}}var Br={toGeoJSON:function(e){return Zi(this,{type:"Point",coordinates:Dr(this.getLatLng(),e)})}};ms.include(Br),Nr.include(Br),gs.include(Br),We.include({toGeoJSON:function(e){var s=!ye(this._latlngs),a=ws(this._latlngs,s?1:0,!1,e);return Zi(this,{type:(s?"Multi":"")+"LineString",coordinates:a})}}),Fi.include({toGeoJSON:function(e){var s=!ye(this._latlngs),a=s&&!ye(this._latlngs[0]),c=ws(this._latlngs,a?2:s?1:0,!0,e);return s||(c=[c]),Zi(this,{type:(a?"Multi":"")+"Polygon",coordinates:c})}}),$i.include({toMultiPoint:function(e){var s=[];return this.eachLayer(function(a){s.push(a.toGeoJSON(e).geometry.coordinates)}),Zi(this,{type:"MultiPoint",coordinates:s})},toGeoJSON:function(e){var s=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(s==="MultiPoint")return this.toMultiPoint(e);var a=s==="GeometryCollection",c=[];return this.eachLayer(function(d){if(d.toGeoJSON){var _=d.toGeoJSON(e);if(a)c.push(_.geometry);else{var y=bs(_);y.type==="FeatureCollection"?c.push.apply(c,y.features):c.push(y)}}}),a?Zi(this,{geometries:c,type:"GeometryCollection"}):{type:"FeatureCollection",features:c}}});function Ca(e,s){return new He(e,s)}var _h=Ca,Ts=Se.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(e,s,a){this._url=e,this._bounds=Ct(s),P(this,a)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(lt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Ot(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(e){return this.options.opacity=e,this._image&&this._updateOpacity(),this},setStyle:function(e){return e.opacity&&this.setOpacity(e.opacity),this},bringToFront:function(){return this._map&&Bi(this._image),this},bringToBack:function(){return this._map&&Ui(this._image),this},setUrl:function(e){return this._url=e,this._image&&(this._image.src=e),this},setBounds:function(e){return this._bounds=Ct(e),this._map&&this._reset(),this},getEvents:function(){var e={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},setZIndex:function(e){return this.options.zIndex=e,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var e=this._url.tagName==="IMG",s=this._image=e?this._url:ft("img");if(lt(s,"leaflet-image-layer"),this._zoomAnimated&&lt(s,"leaflet-zoom-animated"),this.options.className&&lt(s,this.options.className),s.onselectstart=g,s.onmousemove=g,s.onload=u(this.fire,this,"load"),s.onerror=u(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(s.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),e){this._url=s.src;return}s.src=this._url,s.alt=this.options.alt},_animateZoom:function(e){var s=this._map.getZoomScale(e.zoom),a=this._map._latLngBoundsToNewLayerBounds(this._bounds,e.zoom,e.center).min;gi(this._image,a,s)},_reset:function(){var e=this._image,s=new pt(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),a=s.getSize();Mt(e,s.min),e.style.width=a.x+"px",e.style.height=a.y+"px"},_updateOpacity:function(){ve(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var e=this.options.errorOverlayUrl;e&&this._url!==e&&(this._url=e,this._image.src=e)},getCenter:function(){return this._bounds.getCenter()}}),mh=function(e,s,a){return new Ts(e,s,a)},Aa=Ts.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var e=this._url.tagName==="VIDEO",s=this._image=e?this._url:ft("video");if(lt(s,"leaflet-image-layer"),this._zoomAnimated&&lt(s,"leaflet-zoom-animated"),this.options.className&&lt(s,this.options.className),s.onselectstart=g,s.onmousemove=g,s.onloadeddata=u(this.fire,this,"load"),e){for(var a=s.getElementsByTagName("source"),c=[],d=0;d<a.length;d++)c.push(a[d].src);this._url=a.length>0?c:[s.src];return}O(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(s.style,"objectFit")&&(s.style.objectFit="fill"),s.autoplay=!!this.options.autoplay,s.loop=!!this.options.loop,s.muted=!!this.options.muted,s.playsInline=!!this.options.playsInline;for(var _=0;_<this._url.length;_++){var y=ft("source");y.src=this._url[_],s.appendChild(y)}}});function gh(e,s,a){return new Aa(e,s,a)}var La=Ts.extend({_initImage:function(){var e=this._image=this._url;lt(e,"leaflet-image-layer"),this._zoomAnimated&&lt(e,"leaflet-zoom-animated"),this.options.className&&lt(e,this.options.className),e.onselectstart=g,e.onmousemove=g}});function vh(e,s,a){return new La(e,s,a)}var Ne=Se.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(e,s){e&&(e instanceof mt||O(e))?(this._latlng=at(e),P(this,s)):(P(this,e),this._source=s),this.options.content&&(this._content=this.options.content)},openOn:function(e){return e=arguments.length?e:this._source._map,e.hasLayer(this)||e.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(e){return this._map?this.close():(arguments.length?this._source=e:e=this._source,this._prepareOpen(),this.openOn(e._map)),this},onAdd:function(e){this._zoomAnimated=e._zoomAnimated,this._container||this._initLayout(),e._fadeAnimated&&ve(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),e._fadeAnimated&&ve(this._container,1),this.bringToFront(),this.options.interactive&&(lt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(e){e._fadeAnimated?(ve(this._container,0),this._removeTimeout=setTimeout(u(Ot,void 0,this._container),200)):Ot(this._container),this.options.interactive&&(Rt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(e){return this._latlng=at(e),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(e){return this._content=e,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var e={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Bi(this._container),this},bringToBack:function(){return this._map&&Ui(this._container),this},_prepareOpen:function(e){var s=this._source;if(!s._map)return!1;if(s instanceof Ze){s=null;var a=this._source._layers;for(var c in a)if(a[c]._map){s=a[c];break}if(!s)return!1;this._source=s}if(!e)if(s.getCenter)e=s.getCenter();else if(s.getLatLng)e=s.getLatLng();else if(s.getBounds)e=s.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(e),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var e=this._contentNode,s=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof s=="string")e.innerHTML=s;else{for(;e.hasChildNodes();)e.removeChild(e.firstChild);e.appendChild(s)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var e=this._map.latLngToLayerPoint(this._latlng),s=tt(this.options.offset),a=this._getAnchor();this._zoomAnimated?Mt(this._container,e.add(a)):s=s.add(e).add(a);var c=this._containerBottom=-s.y,d=this._containerLeft=-Math.round(this._containerWidth/2)+s.x;this._container.style.bottom=c+"px",this._container.style.left=d+"px"}},_getAnchor:function(){return[0,0]}});ht.include({_initOverlay:function(e,s,a,c){var d=s;return d instanceof e||(d=new e(c).setContent(s)),a&&d.setLatLng(a),d}}),Se.include({_initOverlay:function(e,s,a,c){var d=a;return d instanceof e?(P(d,c),d._source=this):(d=s&&!c?s:new e(c,this),d.setContent(a)),d}});var xs=Ne.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(e){return e=arguments.length?e:this._source._map,!e.hasLayer(this)&&e._popup&&e._popup.options.autoClose&&e.removeLayer(e._popup),e._popup=this,Ne.prototype.openOn.call(this,e)},onAdd:function(e){Ne.prototype.onAdd.call(this,e),e.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof oi||this._source.on("preclick",yi))},onRemove:function(e){Ne.prototype.onRemove.call(this,e),e.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof oi||this._source.off("preclick",yi))},getEvents:function(){var e=Ne.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(e.preclick=this.close),this.options.keepInView&&(e.moveend=this._adjustPan),e},_initLayout:function(){var e="leaflet-popup",s=this._container=ft("div",e+" "+(this.options.className||"")+" leaflet-zoom-animated"),a=this._wrapper=ft("div",e+"-content-wrapper",s);if(this._contentNode=ft("div",e+"-content",a),wn(s),kr(this._contentNode),rt(s,"contextmenu",yi),this._tipContainer=ft("div",e+"-tip-container",s),this._tip=ft("div",e+"-tip",this._tipContainer),this.options.closeButton){var c=this._closeButton=ft("a",e+"-close-button",s);c.setAttribute("role","button"),c.setAttribute("aria-label","Close popup"),c.href="#close",c.innerHTML='<span aria-hidden="true">&#215;</span>',rt(c,"click",function(d){Ht(d),this.close()},this)}},_updateLayout:function(){var e=this._contentNode,s=e.style;s.width="",s.whiteSpace="nowrap";var a=e.offsetWidth;a=Math.min(a,this.options.maxWidth),a=Math.max(a,this.options.minWidth),s.width=a+1+"px",s.whiteSpace="",s.height="";var c=e.offsetHeight,d=this.options.maxHeight,_="leaflet-popup-scrolled";d&&c>d?(s.height=d+"px",lt(e,_)):Rt(e,_),this._containerWidth=this._container.offsetWidth},_animateZoom:function(e){var s=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center),a=this._getAnchor();Mt(this._container,s.add(a))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var e=this._map,s=parseInt(mn(this._container,"marginBottom"),10)||0,a=this._container.offsetHeight+s,c=this._containerWidth,d=new K(this._containerLeft,-a-this._containerBottom);d._add(vi(this._container));var _=e.layerPointToContainerPoint(d),y=tt(this.options.autoPanPadding),x=tt(this.options.autoPanPaddingTopLeft||y),E=tt(this.options.autoPanPaddingBottomRight||y),R=e.getSize(),q=0,et=0;_.x+c+E.x>R.x&&(q=_.x+c-R.x+E.x),_.x-q-x.x<0&&(q=_.x-x.x),_.y+a+E.y>R.y&&(et=_.y+a-R.y+E.y),_.y-et-x.y<0&&(et=_.y-x.y),(q||et)&&(this.options.keepInView&&(this._autopanning=!0),e.fire("autopanstart").panBy([q,et]))}},_getAnchor:function(){return tt(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),yh=function(e,s){return new xs(e,s)};ht.mergeOptions({closePopupOnClick:!0}),ht.include({openPopup:function(e,s,a){return this._initOverlay(xs,e,s,a).openOn(this),this},closePopup:function(e){return e=arguments.length?e:this._popup,e&&e.close(),this}}),Se.include({bindPopup:function(e,s){return this._popup=this._initOverlay(xs,this._popup,e,s),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(e){return this._popup&&(this instanceof Ze||(this._popup._source=this),this._popup._prepareOpen(e||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(e){return this._popup&&this._popup.setContent(e),this},getPopup:function(){return this._popup},_openPopup:function(e){if(!(!this._popup||!this._map)){wi(e);var s=e.layer||e.target;if(this._popup._source===s&&!(s instanceof oi)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(e.latlng);return}this._popup._source=s,this.openPopup(e.latlng)}},_movePopup:function(e){this._popup.setLatLng(e.latlng)},_onKeyPress:function(e){e.originalEvent.keyCode===13&&this._openPopup(e)}});var Ss=Ne.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(e){Ne.prototype.onAdd.call(this,e),this.setOpacity(this.options.opacity),e.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(e){Ne.prototype.onRemove.call(this,e),e.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var e=Ne.prototype.getEvents.call(this);return this.options.permanent||(e.preclick=this.close),e},_initLayout:function(){var e="leaflet-tooltip",s=e+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=ft("div",s),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+f(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(e){var s,a,c=this._map,d=this._container,_=c.latLngToContainerPoint(c.getCenter()),y=c.layerPointToContainerPoint(e),x=this.options.direction,E=d.offsetWidth,R=d.offsetHeight,q=tt(this.options.offset),et=this._getAnchor();x==="top"?(s=E/2,a=R):x==="bottom"?(s=E/2,a=0):x==="center"?(s=E/2,a=R/2):x==="right"?(s=0,a=R/2):x==="left"?(s=E,a=R/2):y.x<_.x?(x="right",s=0,a=R/2):(x="left",s=E+(q.x+et.x)*2,a=R/2),e=e.subtract(tt(s,a,!0)).add(q).add(et),Rt(d,"leaflet-tooltip-right"),Rt(d,"leaflet-tooltip-left"),Rt(d,"leaflet-tooltip-top"),Rt(d,"leaflet-tooltip-bottom"),lt(d,"leaflet-tooltip-"+x),Mt(d,e)},_updatePosition:function(){var e=this._map.latLngToLayerPoint(this._latlng);this._setPosition(e)},setOpacity:function(e){this.options.opacity=e,this._container&&ve(this._container,e)},_animateZoom:function(e){var s=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center);this._setPosition(s)},_getAnchor:function(){return tt(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),wh=function(e,s){return new Ss(e,s)};ht.include({openTooltip:function(e,s,a){return this._initOverlay(Ss,e,s,a).openOn(this),this},closeTooltip:function(e){return e.close(),this}}),Se.include({bindTooltip:function(e,s){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Ss,this._tooltip,e,s),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(e){if(!(!e&&this._tooltipHandlersAdded)){var s=e?"off":"on",a={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?a.add=this._openTooltip:(a.mouseover=this._openTooltip,a.mouseout=this.closeTooltip,a.click=this._openTooltip,this._map?this._addFocusListeners():a.add=this._addFocusListeners),this._tooltip.options.sticky&&(a.mousemove=this._moveTooltip),this[s](a),this._tooltipHandlersAdded=!e}},openTooltip:function(e){return this._tooltip&&(this instanceof Ze||(this._tooltip._source=this),this._tooltip._prepareOpen(e)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(e){return this._tooltip&&this._tooltip.setContent(e),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(e){var s=typeof e.getElement=="function"&&e.getElement();s&&(rt(s,"focus",function(){this._tooltip._source=e,this.openTooltip()},this),rt(s,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(e){var s=typeof e.getElement=="function"&&e.getElement();s&&s.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(e){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var s=this;this._map.once("moveend",function(){s._openOnceFlag=!1,s._openTooltip(e)});return}this._tooltip._source=e.layer||e.target,this.openTooltip(this._tooltip.options.sticky?e.latlng:void 0)}},_moveTooltip:function(e){var s=e.latlng,a,c;this._tooltip.options.sticky&&e.originalEvent&&(a=this._map.mouseEventToContainerPoint(e.originalEvent),c=this._map.containerPointToLayerPoint(a),s=this._map.layerPointToLatLng(c)),this._tooltip.setLatLng(s)}});var Ra=zi.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(e){var s=e&&e.tagName==="DIV"?e:document.createElement("div"),a=this.options;if(a.html instanceof Element?(cs(s),s.appendChild(a.html)):s.innerHTML=a.html!==!1?a.html:"",a.bgPos){var c=tt(a.bgPos);s.style.backgroundPosition=-c.x+"px "+-c.y+"px"}return this._setIconStyles(s,"icon"),s},createShadow:function(){return null}});function bh(e){return new Ra(e)}zi.Default=xn;var Sn=Se.extend({options:{tileSize:256,opacity:1,updateWhenIdle:J.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(e){P(this,e)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(e){e._addZoomLimit(this)},onRemove:function(e){this._removeAllTiles(),Ot(this._container),e._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Bi(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Ui(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(e){return this.options.opacity=e,this._updateOpacity(),this},setZIndex:function(e){return this.options.zIndex=e,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var e=this._clampZoom(this._map.getZoom());e!==this._tileZoom&&(this._tileZoom=e,this._updateLevels()),this._update()}return this},getEvents:function(){var e={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=p(this._onMoveEnd,this.options.updateInterval,this)),e.move=this._onMove),this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},createTile:function(){return document.createElement("div")},getTileSize:function(){var e=this.options.tileSize;return e instanceof K?e:new K(e,e)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(e){for(var s=this.getPane().children,a=-e(-1/0,1/0),c=0,d=s.length,_;c<d;c++)_=s[c].style.zIndex,s[c]!==this._container&&_&&(a=e(a,+_));isFinite(a)&&(this.options.zIndex=a+e(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!J.ielt9){ve(this._container,this.options.opacity);var e=+new Date,s=!1,a=!1;for(var c in this._tiles){var d=this._tiles[c];if(!(!d.current||!d.loaded)){var _=Math.min(1,(e-d.loaded)/200);ve(d.el,_),_<1?s=!0:(d.active?a=!0:this._onOpaqueTile(d),d.active=!0)}}a&&!this._noPrune&&this._pruneTiles(),s&&(Ft(this._fadeFrame),this._fadeFrame=It(this._updateOpacity,this))}},_onOpaqueTile:g,_initContainer:function(){this._container||(this._container=ft("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var e=this._tileZoom,s=this.options.maxZoom;if(e!==void 0){for(var a in this._levels)a=Number(a),this._levels[a].el.children.length||a===e?(this._levels[a].el.style.zIndex=s-Math.abs(e-a),this._onUpdateLevel(a)):(Ot(this._levels[a].el),this._removeTilesAtZoom(a),this._onRemoveLevel(a),delete this._levels[a]);var c=this._levels[e],d=this._map;return c||(c=this._levels[e]={},c.el=ft("div","leaflet-tile-container leaflet-zoom-animated",this._container),c.el.style.zIndex=s,c.origin=d.project(d.unproject(d.getPixelOrigin()),e).round(),c.zoom=e,this._setZoomTransform(c,d.getCenter(),d.getZoom()),g(c.el.offsetWidth),this._onCreateLevel(c)),this._level=c,c}},_onUpdateLevel:g,_onRemoveLevel:g,_onCreateLevel:g,_pruneTiles:function(){if(this._map){var e,s,a=this._map.getZoom();if(a>this.options.maxZoom||a<this.options.minZoom){this._removeAllTiles();return}for(e in this._tiles)s=this._tiles[e],s.retain=s.current;for(e in this._tiles)if(s=this._tiles[e],s.current&&!s.active){var c=s.coords;this._retainParent(c.x,c.y,c.z,c.z-5)||this._retainChildren(c.x,c.y,c.z,c.z+2)}for(e in this._tiles)this._tiles[e].retain||this._removeTile(e)}},_removeTilesAtZoom:function(e){for(var s in this._tiles)this._tiles[s].coords.z===e&&this._removeTile(s)},_removeAllTiles:function(){for(var e in this._tiles)this._removeTile(e)},_invalidateAll:function(){for(var e in this._levels)Ot(this._levels[e].el),this._onRemoveLevel(Number(e)),delete this._levels[e];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(e,s,a,c){var d=Math.floor(e/2),_=Math.floor(s/2),y=a-1,x=new K(+d,+_);x.z=+y;var E=this._tileCoordsToKey(x),R=this._tiles[E];return R&&R.active?(R.retain=!0,!0):(R&&R.loaded&&(R.retain=!0),y>c?this._retainParent(d,_,y,c):!1)},_retainChildren:function(e,s,a,c){for(var d=2*e;d<2*e+2;d++)for(var _=2*s;_<2*s+2;_++){var y=new K(d,_);y.z=a+1;var x=this._tileCoordsToKey(y),E=this._tiles[x];if(E&&E.active){E.retain=!0;continue}else E&&E.loaded&&(E.retain=!0);a+1<c&&this._retainChildren(d,_,a+1,c)}},_resetView:function(e){var s=e&&(e.pinch||e.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),s,s)},_animateZoom:function(e){this._setView(e.center,e.zoom,!0,e.noUpdate)},_clampZoom:function(e){var s=this.options;return s.minNativeZoom!==void 0&&e<s.minNativeZoom?s.minNativeZoom:s.maxNativeZoom!==void 0&&s.maxNativeZoom<e?s.maxNativeZoom:e},_setView:function(e,s,a,c){var d=Math.round(s);this.options.maxZoom!==void 0&&d>this.options.maxZoom||this.options.minZoom!==void 0&&d<this.options.minZoom?d=void 0:d=this._clampZoom(d);var _=this.options.updateWhenZooming&&d!==this._tileZoom;(!c||_)&&(this._tileZoom=d,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),d!==void 0&&this._update(e),a||this._pruneTiles(),this._noPrune=!!a),this._setZoomTransforms(e,s)},_setZoomTransforms:function(e,s){for(var a in this._levels)this._setZoomTransform(this._levels[a],e,s)},_setZoomTransform:function(e,s,a){var c=this._map.getZoomScale(a,e.zoom),d=e.origin.multiplyBy(c).subtract(this._map._getNewPixelOrigin(s,a)).round();J.any3d?gi(e.el,d,c):Mt(e.el,d)},_resetGrid:function(){var e=this._map,s=e.options.crs,a=this._tileSize=this.getTileSize(),c=this._tileZoom,d=this._map.getPixelWorldBounds(this._tileZoom);d&&(this._globalTileRange=this._pxBoundsToTileRange(d)),this._wrapX=s.wrapLng&&!this.options.noWrap&&[Math.floor(e.project([0,s.wrapLng[0]],c).x/a.x),Math.ceil(e.project([0,s.wrapLng[1]],c).x/a.y)],this._wrapY=s.wrapLat&&!this.options.noWrap&&[Math.floor(e.project([s.wrapLat[0],0],c).y/a.x),Math.ceil(e.project([s.wrapLat[1],0],c).y/a.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(e){var s=this._map,a=s._animatingZoom?Math.max(s._animateToZoom,s.getZoom()):s.getZoom(),c=s.getZoomScale(a,this._tileZoom),d=s.project(e,this._tileZoom).floor(),_=s.getSize().divideBy(c*2);return new pt(d.subtract(_),d.add(_))},_update:function(e){var s=this._map;if(s){var a=this._clampZoom(s.getZoom());if(e===void 0&&(e=s.getCenter()),this._tileZoom!==void 0){var c=this._getTiledPixelBounds(e),d=this._pxBoundsToTileRange(c),_=d.getCenter(),y=[],x=this.options.keepBuffer,E=new pt(d.getBottomLeft().subtract([x,-x]),d.getTopRight().add([x,-x]));if(!(isFinite(d.min.x)&&isFinite(d.min.y)&&isFinite(d.max.x)&&isFinite(d.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var R in this._tiles){var q=this._tiles[R].coords;(q.z!==this._tileZoom||!E.contains(new K(q.x,q.y)))&&(this._tiles[R].current=!1)}if(Math.abs(a-this._tileZoom)>1){this._setView(e,a);return}for(var et=d.min.y;et<=d.max.y;et++)for(var ct=d.min.x;ct<=d.max.x;ct++){var ee=new K(ct,et);if(ee.z=this._tileZoom,!!this._isValidTile(ee)){var zt=this._tiles[this._tileCoordsToKey(ee)];zt?zt.current=!0:y.push(ee)}}if(y.sort(function(oe,Hi){return oe.distanceTo(_)-Hi.distanceTo(_)}),y.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var we=document.createDocumentFragment();for(ct=0;ct<y.length;ct++)this._addTile(y[ct],we);this._level.el.appendChild(we)}}}},_isValidTile:function(e){var s=this._map.options.crs;if(!s.infinite){var a=this._globalTileRange;if(!s.wrapLng&&(e.x<a.min.x||e.x>a.max.x)||!s.wrapLat&&(e.y<a.min.y||e.y>a.max.y))return!1}if(!this.options.bounds)return!0;var c=this._tileCoordsToBounds(e);return Ct(this.options.bounds).overlaps(c)},_keyToBounds:function(e){return this._tileCoordsToBounds(this._keyToTileCoords(e))},_tileCoordsToNwSe:function(e){var s=this._map,a=this.getTileSize(),c=e.scaleBy(a),d=c.add(a),_=s.unproject(c,e.z),y=s.unproject(d,e.z);return[_,y]},_tileCoordsToBounds:function(e){var s=this._tileCoordsToNwSe(e),a=new Zt(s[0],s[1]);return this.options.noWrap||(a=this._map.wrapLatLngBounds(a)),a},_tileCoordsToKey:function(e){return e.x+":"+e.y+":"+e.z},_keyToTileCoords:function(e){var s=e.split(":"),a=new K(+s[0],+s[1]);return a.z=+s[2],a},_removeTile:function(e){var s=this._tiles[e];s&&(Ot(s.el),delete this._tiles[e],this.fire("tileunload",{tile:s.el,coords:this._keyToTileCoords(e)}))},_initTile:function(e){lt(e,"leaflet-tile");var s=this.getTileSize();e.style.width=s.x+"px",e.style.height=s.y+"px",e.onselectstart=g,e.onmousemove=g,J.ielt9&&this.options.opacity<1&&ve(e,this.options.opacity)},_addTile:function(e,s){var a=this._getTilePos(e),c=this._tileCoordsToKey(e),d=this.createTile(this._wrapCoords(e),u(this._tileReady,this,e));this._initTile(d),this.createTile.length<2&&It(u(this._tileReady,this,e,null,d)),Mt(d,a),this._tiles[c]={el:d,coords:e,current:!0},s.appendChild(d),this.fire("tileloadstart",{tile:d,coords:e})},_tileReady:function(e,s,a){s&&this.fire("tileerror",{error:s,tile:a,coords:e});var c=this._tileCoordsToKey(e);a=this._tiles[c],a&&(a.loaded=+new Date,this._map._fadeAnimated?(ve(a.el,0),Ft(this._fadeFrame),this._fadeFrame=It(this._updateOpacity,this)):(a.active=!0,this._pruneTiles()),s||(lt(a.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:a.el,coords:e})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),J.ielt9||!this._map._fadeAnimated?It(this._pruneTiles,this):setTimeout(u(this._pruneTiles,this),250)))},_getTilePos:function(e){return e.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(e){var s=new K(this._wrapX?m(e.x,this._wrapX):e.x,this._wrapY?m(e.y,this._wrapY):e.y);return s.z=e.z,s},_pxBoundsToTileRange:function(e){var s=this.getTileSize();return new pt(e.min.unscaleBy(s).floor(),e.max.unscaleBy(s).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var e in this._tiles)if(!this._tiles[e].loaded)return!1;return!0}});function Th(e){return new Sn(e)}var Wi=Sn.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(e,s){this._url=e,s=P(this,s),s.detectRetina&&J.retina&&s.maxZoom>0?(s.tileSize=Math.floor(s.tileSize/2),s.zoomReverse?(s.zoomOffset--,s.minZoom=Math.min(s.maxZoom,s.minZoom+1)):(s.zoomOffset++,s.maxZoom=Math.max(s.minZoom,s.maxZoom-1)),s.minZoom=Math.max(0,s.minZoom)):s.zoomReverse?s.minZoom=Math.min(s.maxZoom,s.minZoom):s.maxZoom=Math.max(s.minZoom,s.maxZoom),typeof s.subdomains=="string"&&(s.subdomains=s.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(e,s){return this._url===e&&s===void 0&&(s=!0),this._url=e,s||this.redraw(),this},createTile:function(e,s){var a=document.createElement("img");return rt(a,"load",u(this._tileOnLoad,this,s,a)),rt(a,"error",u(this._tileOnError,this,s,a)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(a.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(a.referrerPolicy=this.options.referrerPolicy),a.alt="",a.src=this.getTileUrl(e),a},getTileUrl:function(e){var s={r:J.retina?"@2x":"",s:this._getSubdomain(e),x:e.x,y:e.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var a=this._globalTileRange.max.y-e.y;this.options.tms&&(s.y=a),s["-y"]=a}return U(this._url,o(s,this.options))},_tileOnLoad:function(e,s){J.ielt9?setTimeout(u(e,this,null,s),0):e(null,s)},_tileOnError:function(e,s,a){var c=this.options.errorTileUrl;c&&s.getAttribute("src")!==c&&(s.src=c),e(a,s)},_onTileRemove:function(e){e.tile.onload=null},_getZoomForUrl:function(){var e=this._tileZoom,s=this.options.maxZoom,a=this.options.zoomReverse,c=this.options.zoomOffset;return a&&(e=s-e),e+c},_getSubdomain:function(e){var s=Math.abs(e.x+e.y)%this.options.subdomains.length;return this.options.subdomains[s]},_abortLoading:function(){var e,s;for(e in this._tiles)if(this._tiles[e].coords.z!==this._tileZoom&&(s=this._tiles[e].el,s.onload=g,s.onerror=g,!s.complete)){s.src=H;var a=this._tiles[e].coords;Ot(s),delete this._tiles[e],this.fire("tileabort",{tile:s,coords:a})}},_removeTile:function(e){var s=this._tiles[e];if(s)return s.el.setAttribute("src",H),Sn.prototype._removeTile.call(this,e)},_tileReady:function(e,s,a){if(!(!this._map||a&&a.getAttribute("src")===H))return Sn.prototype._tileReady.call(this,e,s,a)}});function Ia(e,s){return new Wi(e,s)}var Ma=Wi.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(e,s){this._url=e;var a=o({},this.defaultWmsParams);for(var c in s)c in this.options||(a[c]=s[c]);s=P(this,s);var d=s.detectRetina&&J.retina?2:1,_=this.getTileSize();a.width=_.x*d,a.height=_.y*d,this.wmsParams=a},onAdd:function(e){this._crs=this.options.crs||e.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var s=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[s]=this._crs.code,Wi.prototype.onAdd.call(this,e)},getTileUrl:function(e){var s=this._tileCoordsToNwSe(e),a=this._crs,c=Et(a.project(s[0]),a.project(s[1])),d=c.min,_=c.max,y=(this._wmsVersion>=1.3&&this._crs===Ea?[d.y,d.x,_.y,_.x]:[d.x,d.y,_.x,_.y]).join(","),x=Wi.prototype.getTileUrl.call(this,e);return x+B(this.wmsParams,x,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+y},setParams:function(e,s){return o(this.wmsParams,e),s||this.redraw(),this}});function xh(e,s){return new Ma(e,s)}Wi.WMS=Ma,Ia.wms=xh;var qe=Se.extend({options:{padding:.1},initialize:function(e){P(this,e),f(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),lt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var e={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(e.zoomanim=this._onAnimZoom),e},_onAnimZoom:function(e){this._updateTransform(e.center,e.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(e,s){var a=this._map.getZoomScale(s,this._zoom),c=this._map.getSize().multiplyBy(.5+this.options.padding),d=this._map.project(this._center,s),_=c.multiplyBy(-a).add(d).subtract(this._map._getNewPixelOrigin(e,s));J.any3d?gi(this._container,_,a):Mt(this._container,_)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var e in this._layers)this._layers[e]._reset()},_onZoomEnd:function(){for(var e in this._layers)this._layers[e]._project()},_updatePaths:function(){for(var e in this._layers)this._layers[e]._update()},_update:function(){var e=this.options.padding,s=this._map.getSize(),a=this._map.containerPointToLayerPoint(s.multiplyBy(-e)).round();this._bounds=new pt(a,a.add(s.multiplyBy(1+e*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Na=qe.extend({options:{tolerance:0},getEvents:function(){var e=qe.prototype.getEvents.call(this);return e.viewprereset=this._onViewPreReset,e},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){qe.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var e=this._container=document.createElement("canvas");rt(e,"mousemove",this._onMouseMove,this),rt(e,"click dblclick mousedown mouseup contextmenu",this._onClick,this),rt(e,"mouseout",this._handleMouseOut,this),e._leaflet_disable_events=!0,this._ctx=e.getContext("2d")},_destroyContainer:function(){Ft(this._redrawRequest),delete this._ctx,Ot(this._container),xt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var e;this._redrawBounds=null;for(var s in this._layers)e=this._layers[s],e._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){qe.prototype._update.call(this);var e=this._bounds,s=this._container,a=e.getSize(),c=J.retina?2:1;Mt(s,e.min),s.width=c*a.x,s.height=c*a.y,s.style.width=a.x+"px",s.style.height=a.y+"px",J.retina&&this._ctx.scale(2,2),this._ctx.translate(-e.min.x,-e.min.y),this.fire("update")}},_reset:function(){qe.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(e){this._updateDashArray(e),this._layers[f(e)]=e;var s=e._order={layer:e,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=s),this._drawLast=s,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(e){this._requestRedraw(e)},_removePath:function(e){var s=e._order,a=s.next,c=s.prev;a?a.prev=c:this._drawLast=c,c?c.next=a:this._drawFirst=a,delete e._order,delete this._layers[f(e)],this._requestRedraw(e)},_updatePath:function(e){this._extendRedrawBounds(e),e._project(),e._update(),this._requestRedraw(e)},_updateStyle:function(e){this._updateDashArray(e),this._requestRedraw(e)},_updateDashArray:function(e){if(typeof e.options.dashArray=="string"){var s=e.options.dashArray.split(/[, ]+/),a=[],c,d;for(d=0;d<s.length;d++){if(c=Number(s[d]),isNaN(c))return;a.push(c)}e.options._dashArray=a}else e.options._dashArray=e.options.dashArray},_requestRedraw:function(e){this._map&&(this._extendRedrawBounds(e),this._redrawRequest=this._redrawRequest||It(this._redraw,this))},_extendRedrawBounds:function(e){if(e._pxBounds){var s=(e.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new pt,this._redrawBounds.extend(e._pxBounds.min.subtract([s,s])),this._redrawBounds.extend(e._pxBounds.max.add([s,s]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var e=this._redrawBounds;if(e){var s=e.getSize();this._ctx.clearRect(e.min.x,e.min.y,s.x,s.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var e,s=this._redrawBounds;if(this._ctx.save(),s){var a=s.getSize();this._ctx.beginPath(),this._ctx.rect(s.min.x,s.min.y,a.x,a.y),this._ctx.clip()}this._drawing=!0;for(var c=this._drawFirst;c;c=c.next)e=c.layer,(!s||e._pxBounds&&e._pxBounds.intersects(s))&&e._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(e,s){if(this._drawing){var a,c,d,_,y=e._parts,x=y.length,E=this._ctx;if(x){for(E.beginPath(),a=0;a<x;a++){for(c=0,d=y[a].length;c<d;c++)_=y[a][c],E[c?"lineTo":"moveTo"](_.x,_.y);s&&E.closePath()}this._fillStroke(E,e)}}},_updateCircle:function(e){if(!(!this._drawing||e._empty())){var s=e._point,a=this._ctx,c=Math.max(Math.round(e._radius),1),d=(Math.max(Math.round(e._radiusY),1)||c)/c;d!==1&&(a.save(),a.scale(1,d)),a.beginPath(),a.arc(s.x,s.y/d,c,0,Math.PI*2,!1),d!==1&&a.restore(),this._fillStroke(a,e)}},_fillStroke:function(e,s){var a=s.options;a.fill&&(e.globalAlpha=a.fillOpacity,e.fillStyle=a.fillColor||a.color,e.fill(a.fillRule||"evenodd")),a.stroke&&a.weight!==0&&(e.setLineDash&&e.setLineDash(s.options&&s.options._dashArray||[]),e.globalAlpha=a.opacity,e.lineWidth=a.weight,e.strokeStyle=a.color,e.lineCap=a.lineCap,e.lineJoin=a.lineJoin,e.stroke())},_onClick:function(e){for(var s=this._map.mouseEventToLayerPoint(e),a,c,d=this._drawFirst;d;d=d.next)a=d.layer,a.options.interactive&&a._containsPoint(s)&&(!(e.type==="click"||e.type==="preclick")||!this._map._draggableMoved(a))&&(c=a);this._fireEvent(c?[c]:!1,e)},_onMouseMove:function(e){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var s=this._map.mouseEventToLayerPoint(e);this._handleMouseHover(e,s)}},_handleMouseOut:function(e){var s=this._hoveredLayer;s&&(Rt(this._container,"leaflet-interactive"),this._fireEvent([s],e,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(e,s){if(!this._mouseHoverThrottled){for(var a,c,d=this._drawFirst;d;d=d.next)a=d.layer,a.options.interactive&&a._containsPoint(s)&&(c=a);c!==this._hoveredLayer&&(this._handleMouseOut(e),c&&(lt(this._container,"leaflet-interactive"),this._fireEvent([c],e,"mouseover"),this._hoveredLayer=c)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,e),this._mouseHoverThrottled=!0,setTimeout(u(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(e,s,a){this._map._fireDOMEvent(s,a||s.type,e)},_bringToFront:function(e){var s=e._order;if(s){var a=s.next,c=s.prev;if(a)a.prev=c;else return;c?c.next=a:a&&(this._drawFirst=a),s.prev=this._drawLast,this._drawLast.next=s,s.next=null,this._drawLast=s,this._requestRedraw(e)}},_bringToBack:function(e){var s=e._order;if(s){var a=s.next,c=s.prev;if(c)c.next=a;else return;a?a.prev=c:c&&(this._drawLast=c),s.prev=null,s.next=this._drawFirst,this._drawFirst.prev=s,this._drawFirst=s,this._requestRedraw(e)}}});function ja(e){return J.canvas?new Na(e):null}var Pn=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(e){return document.createElement("<lvml:"+e+' class="lvml">')}}catch{}return function(e){return document.createElement("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),Sh={_initContainer:function(){this._container=ft("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(qe.prototype._update.call(this),this.fire("update"))},_initPath:function(e){var s=e._container=Pn("shape");lt(s,"leaflet-vml-shape "+(this.options.className||"")),s.coordsize="1 1",e._path=Pn("path"),s.appendChild(e._path),this._updateStyle(e),this._layers[f(e)]=e},_addPath:function(e){var s=e._container;this._container.appendChild(s),e.options.interactive&&e.addInteractiveTarget(s)},_removePath:function(e){var s=e._container;Ot(s),e.removeInteractiveTarget(s),delete this._layers[f(e)]},_updateStyle:function(e){var s=e._stroke,a=e._fill,c=e.options,d=e._container;d.stroked=!!c.stroke,d.filled=!!c.fill,c.stroke?(s||(s=e._stroke=Pn("stroke")),d.appendChild(s),s.weight=c.weight+"px",s.color=c.color,s.opacity=c.opacity,c.dashArray?s.dashStyle=O(c.dashArray)?c.dashArray.join(" "):c.dashArray.replace(/( *, *)/g," "):s.dashStyle="",s.endcap=c.lineCap.replace("butt","flat"),s.joinstyle=c.lineJoin):s&&(d.removeChild(s),e._stroke=null),c.fill?(a||(a=e._fill=Pn("fill")),d.appendChild(a),a.color=c.fillColor||c.color,a.opacity=c.fillOpacity):a&&(d.removeChild(a),e._fill=null)},_updateCircle:function(e){var s=e._point.round(),a=Math.round(e._radius),c=Math.round(e._radiusY||a);this._setPath(e,e._empty()?"M0 0":"AL "+s.x+","+s.y+" "+a+","+c+" 0,"+65535*360)},_setPath:function(e,s){e._path.v=s},_bringToFront:function(e){Bi(e._container)},_bringToBack:function(e){Ui(e._container)}},Ps=J.vml?Pn:D,En=qe.extend({_initContainer:function(){this._container=Ps("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Ps("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Ot(this._container),xt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){qe.prototype._update.call(this);var e=this._bounds,s=e.getSize(),a=this._container;(!this._svgSize||!this._svgSize.equals(s))&&(this._svgSize=s,a.setAttribute("width",s.x),a.setAttribute("height",s.y)),Mt(a,e.min),a.setAttribute("viewBox",[e.min.x,e.min.y,s.x,s.y].join(" ")),this.fire("update")}},_initPath:function(e){var s=e._path=Ps("path");e.options.className&&lt(s,e.options.className),e.options.interactive&&lt(s,"leaflet-interactive"),this._updateStyle(e),this._layers[f(e)]=e},_addPath:function(e){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(e._path),e.addInteractiveTarget(e._path)},_removePath:function(e){Ot(e._path),e.removeInteractiveTarget(e._path),delete this._layers[f(e)]},_updatePath:function(e){e._project(),e._update()},_updateStyle:function(e){var s=e._path,a=e.options;s&&(a.stroke?(s.setAttribute("stroke",a.color),s.setAttribute("stroke-opacity",a.opacity),s.setAttribute("stroke-width",a.weight),s.setAttribute("stroke-linecap",a.lineCap),s.setAttribute("stroke-linejoin",a.lineJoin),a.dashArray?s.setAttribute("stroke-dasharray",a.dashArray):s.removeAttribute("stroke-dasharray"),a.dashOffset?s.setAttribute("stroke-dashoffset",a.dashOffset):s.removeAttribute("stroke-dashoffset")):s.setAttribute("stroke","none"),a.fill?(s.setAttribute("fill",a.fillColor||a.color),s.setAttribute("fill-opacity",a.fillOpacity),s.setAttribute("fill-rule",a.fillRule||"evenodd")):s.setAttribute("fill","none"))},_updatePoly:function(e,s){this._setPath(e,I(e._parts,s))},_updateCircle:function(e){var s=e._point,a=Math.max(Math.round(e._radius),1),c=Math.max(Math.round(e._radiusY),1)||a,d="a"+a+","+c+" 0 1,0 ",_=e._empty()?"M0 0":"M"+(s.x-a)+","+s.y+d+a*2+",0 "+d+-a*2+",0 ";this._setPath(e,_)},_setPath:function(e,s){e._path.setAttribute("d",s)},_bringToFront:function(e){Bi(e._path)},_bringToBack:function(e){Ui(e._path)}});J.vml&&En.include(Sh);function Da(e){return J.svg||J.vml?new En(e):null}ht.include({getRenderer:function(e){var s=e.options.renderer||this._getPaneRenderer(e.options.pane)||this.options.renderer||this._renderer;return s||(s=this._renderer=this._createRenderer()),this.hasLayer(s)||this.addLayer(s),s},_getPaneRenderer:function(e){if(e==="overlayPane"||e===void 0)return!1;var s=this._paneRenderers[e];return s===void 0&&(s=this._createRenderer({pane:e}),this._paneRenderers[e]=s),s},_createRenderer:function(e){return this.options.preferCanvas&&ja(e)||Da(e)}});var Ba=Fi.extend({initialize:function(e,s){Fi.prototype.initialize.call(this,this._boundsToLatLngs(e),s)},setBounds:function(e){return this.setLatLngs(this._boundsToLatLngs(e))},_boundsToLatLngs:function(e){return e=Ct(e),[e.getSouthWest(),e.getNorthWest(),e.getNorthEast(),e.getSouthEast()]}});function Ph(e,s){return new Ba(e,s)}En.create=Ps,En.pointsToPath=I,He.geometryToLayer=vs,He.coordsToLatLng=jr,He.coordsToLatLngs=ys,He.latLngToCoords=Dr,He.latLngsToCoords=ws,He.getFeature=Zi,He.asFeature=bs,ht.mergeOptions({boxZoom:!0});var Ua=Me.extend({initialize:function(e){this._map=e,this._container=e._container,this._pane=e._panes.overlayPane,this._resetStateTimeout=0,e.on("unload",this._destroy,this)},addHooks:function(){rt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){xt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Ot(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(e){if(!e.shiftKey||e.which!==1&&e.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),gn(),yr(),this._startPoint=this._map.mouseEventToContainerPoint(e),rt(document,{contextmenu:wi,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(e){this._moved||(this._moved=!0,this._box=ft("div","leaflet-zoom-box",this._container),lt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(e);var s=new pt(this._point,this._startPoint),a=s.getSize();Mt(this._box,s.min),this._box.style.width=a.x+"px",this._box.style.height=a.y+"px"},_finish:function(){this._moved&&(Ot(this._box),Rt(this._container,"leaflet-crosshair")),vn(),wr(),xt(document,{contextmenu:wi,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(e){if(!(e.which!==1&&e.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(u(this._resetState,this),0);var s=new Zt(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(s).fire("boxzoomend",{boxZoomBounds:s})}},_onKeyDown:function(e){e.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});ht.addInitHook("addHandler","boxZoom",Ua),ht.mergeOptions({doubleClickZoom:!0});var $a=Me.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(e){var s=this._map,a=s.getZoom(),c=s.options.zoomDelta,d=e.originalEvent.shiftKey?a-c:a+c;s.options.doubleClickZoom==="center"?s.setZoom(d):s.setZoomAround(e.containerPoint,d)}});ht.addInitHook("addHandler","doubleClickZoom",$a),ht.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var za=Me.extend({addHooks:function(){if(!this._draggable){var e=this._map;this._draggable=new ri(e._mapPane,e._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),e.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),e.on("zoomend",this._onZoomEnd,this),e.whenReady(this._onZoomEnd,this))}lt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Rt(this._map._container,"leaflet-grab"),Rt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var e=this._map;if(e._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var s=Ct(this._map.options.maxBounds);this._offsetLimit=Et(this._map.latLngToContainerPoint(s.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(s.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;e.fire("movestart").fire("dragstart"),e.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(e){if(this._map.options.inertia){var s=this._lastTime=+new Date,a=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(a),this._times.push(s),this._prunePositions(s)}this._map.fire("move",e).fire("drag",e)},_prunePositions:function(e){for(;this._positions.length>1&&e-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var e=this._map.getSize().divideBy(2),s=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=s.subtract(e).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(e,s){return e-(e-s)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var e=this._draggable._newPos.subtract(this._draggable._startPos),s=this._offsetLimit;e.x<s.min.x&&(e.x=this._viscousLimit(e.x,s.min.x)),e.y<s.min.y&&(e.y=this._viscousLimit(e.y,s.min.y)),e.x>s.max.x&&(e.x=this._viscousLimit(e.x,s.max.x)),e.y>s.max.y&&(e.y=this._viscousLimit(e.y,s.max.y)),this._draggable._newPos=this._draggable._startPos.add(e)}},_onPreDragWrap:function(){var e=this._worldWidth,s=Math.round(e/2),a=this._initialWorldOffset,c=this._draggable._newPos.x,d=(c-s+a)%e+s-a,_=(c+s+a)%e-s-a,y=Math.abs(d+a)<Math.abs(_+a)?d:_;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=y},_onDragEnd:function(e){var s=this._map,a=s.options,c=!a.inertia||e.noInertia||this._times.length<2;if(s.fire("dragend",e),c)s.fire("moveend");else{this._prunePositions(+new Date);var d=this._lastPos.subtract(this._positions[0]),_=(this._lastTime-this._times[0])/1e3,y=a.easeLinearity,x=d.multiplyBy(y/_),E=x.distanceTo([0,0]),R=Math.min(a.inertiaMaxSpeed,E),q=x.multiplyBy(R/E),et=R/(a.inertiaDeceleration*y),ct=q.multiplyBy(-et/2).round();!ct.x&&!ct.y?s.fire("moveend"):(ct=s._limitOffset(ct,s.options.maxBounds),It(function(){s.panBy(ct,{duration:et,easeLinearity:y,noMoveStart:!0,animate:!0})}))}}});ht.addInitHook("addHandler","dragging",za),ht.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Fa=Me.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(e){this._map=e,this._setPanDelta(e.options.keyboardPanDelta),this._setZoomDelta(e.options.zoomDelta)},addHooks:function(){var e=this._map._container;e.tabIndex<=0&&(e.tabIndex="0"),rt(e,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),xt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var e=document.body,s=document.documentElement,a=e.scrollTop||s.scrollTop,c=e.scrollLeft||s.scrollLeft;this._map._container.focus(),window.scrollTo(c,a)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(e){var s=this._panKeys={},a=this.keyCodes,c,d;for(c=0,d=a.left.length;c<d;c++)s[a.left[c]]=[-1*e,0];for(c=0,d=a.right.length;c<d;c++)s[a.right[c]]=[e,0];for(c=0,d=a.down.length;c<d;c++)s[a.down[c]]=[0,e];for(c=0,d=a.up.length;c<d;c++)s[a.up[c]]=[0,-1*e]},_setZoomDelta:function(e){var s=this._zoomKeys={},a=this.keyCodes,c,d;for(c=0,d=a.zoomIn.length;c<d;c++)s[a.zoomIn[c]]=e;for(c=0,d=a.zoomOut.length;c<d;c++)s[a.zoomOut[c]]=-e},_addHooks:function(){rt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){xt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(e){if(!(e.altKey||e.ctrlKey||e.metaKey)){var s=e.keyCode,a=this._map,c;if(s in this._panKeys){if(!a._panAnim||!a._panAnim._inProgress)if(c=this._panKeys[s],e.shiftKey&&(c=tt(c).multiplyBy(3)),a.options.maxBounds&&(c=a._limitOffset(tt(c),a.options.maxBounds)),a.options.worldCopyJump){var d=a.wrapLatLng(a.unproject(a.project(a.getCenter()).add(c)));a.panTo(d)}else a.panBy(c)}else if(s in this._zoomKeys)a.setZoom(a.getZoom()+(e.shiftKey?3:1)*this._zoomKeys[s]);else if(s===27&&a._popup&&a._popup.options.closeOnEscapeKey)a.closePopup();else return;wi(e)}}});ht.addInitHook("addHandler","keyboard",Fa),ht.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Za=Me.extend({addHooks:function(){rt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){xt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(e){var s=fa(e),a=this._map.options.wheelDebounceTime;this._delta+=s,this._lastMousePos=this._map.mouseEventToContainerPoint(e),this._startTime||(this._startTime=+new Date);var c=Math.max(a-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(u(this._performZoom,this),c),wi(e)},_performZoom:function(){var e=this._map,s=e.getZoom(),a=this._map.options.zoomSnap||0;e._stop();var c=this._delta/(this._map.options.wheelPxPerZoomLevel*4),d=4*Math.log(2/(1+Math.exp(-Math.abs(c))))/Math.LN2,_=a?Math.ceil(d/a)*a:d,y=e._limitZoom(s+(this._delta>0?_:-_))-s;this._delta=0,this._startTime=null,y&&(e.options.scrollWheelZoom==="center"?e.setZoom(s+y):e.setZoomAround(this._lastMousePos,s+y))}});ht.addInitHook("addHandler","scrollWheelZoom",Za);var Eh=600;ht.mergeOptions({tapHold:J.touchNative&&J.safari&&J.mobile,tapTolerance:15});var Wa=Me.extend({addHooks:function(){rt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){xt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(e){if(clearTimeout(this._holdTimeout),e.touches.length===1){var s=e.touches[0];this._startPos=this._newPos=new K(s.clientX,s.clientY),this._holdTimeout=setTimeout(u(function(){this._cancel(),this._isTapValid()&&(rt(document,"touchend",Ht),rt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",s))},this),Eh),rt(document,"touchend touchcancel contextmenu",this._cancel,this),rt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function e(){xt(document,"touchend",Ht),xt(document,"touchend touchcancel",e)},_cancel:function(){clearTimeout(this._holdTimeout),xt(document,"touchend touchcancel contextmenu",this._cancel,this),xt(document,"touchmove",this._onMove,this)},_onMove:function(e){var s=e.touches[0];this._newPos=new K(s.clientX,s.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(e,s){var a=new MouseEvent(e,{bubbles:!0,cancelable:!0,view:window,screenX:s.screenX,screenY:s.screenY,clientX:s.clientX,clientY:s.clientY});a._simulated=!0,s.target.dispatchEvent(a)}});ht.addInitHook("addHandler","tapHold",Wa),ht.mergeOptions({touchZoom:J.touch,bounceAtZoomLimits:!0});var Ha=Me.extend({addHooks:function(){lt(this._map._container,"leaflet-touch-zoom"),rt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Rt(this._map._container,"leaflet-touch-zoom"),xt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(e){var s=this._map;if(!(!e.touches||e.touches.length!==2||s._animatingZoom||this._zooming)){var a=s.mouseEventToContainerPoint(e.touches[0]),c=s.mouseEventToContainerPoint(e.touches[1]);this._centerPoint=s.getSize()._divideBy(2),this._startLatLng=s.containerPointToLatLng(this._centerPoint),s.options.touchZoom!=="center"&&(this._pinchStartLatLng=s.containerPointToLatLng(a.add(c)._divideBy(2))),this._startDist=a.distanceTo(c),this._startZoom=s.getZoom(),this._moved=!1,this._zooming=!0,s._stop(),rt(document,"touchmove",this._onTouchMove,this),rt(document,"touchend touchcancel",this._onTouchEnd,this),Ht(e)}},_onTouchMove:function(e){if(!(!e.touches||e.touches.length!==2||!this._zooming)){var s=this._map,a=s.mouseEventToContainerPoint(e.touches[0]),c=s.mouseEventToContainerPoint(e.touches[1]),d=a.distanceTo(c)/this._startDist;if(this._zoom=s.getScaleZoom(d,this._startZoom),!s.options.bounceAtZoomLimits&&(this._zoom<s.getMinZoom()&&d<1||this._zoom>s.getMaxZoom()&&d>1)&&(this._zoom=s._limitZoom(this._zoom)),s.options.touchZoom==="center"){if(this._center=this._startLatLng,d===1)return}else{var _=a._add(c)._divideBy(2)._subtract(this._centerPoint);if(d===1&&_.x===0&&_.y===0)return;this._center=s.unproject(s.project(this._pinchStartLatLng,this._zoom).subtract(_),this._zoom)}this._moved||(s._moveStart(!0,!1),this._moved=!0),Ft(this._animRequest);var y=u(s._move,s,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=It(y,this,!0),Ht(e)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,Ft(this._animRequest),xt(document,"touchmove",this._onTouchMove,this),xt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});ht.addInitHook("addHandler","touchZoom",Ha),ht.BoxZoom=Ua,ht.DoubleClickZoom=$a,ht.Drag=za,ht.Keyboard=Fa,ht.ScrollWheelZoom=Za,ht.TapHold=Wa,ht.TouchZoom=Ha,n.Bounds=pt,n.Browser=J,n.CRS=re,n.Canvas=Na,n.Circle=Nr,n.CircleMarker=gs,n.Class=le,n.Control=xe,n.DivIcon=Ra,n.DivOverlay=Ne,n.DomEvent=Wc,n.DomUtil=Fc,n.Draggable=ri,n.Evented=wt,n.FeatureGroup=Ze,n.GeoJSON=He,n.GridLayer=Sn,n.Handler=Me,n.Icon=zi,n.ImageOverlay=Ts,n.LatLng=mt,n.LatLngBounds=Zt,n.Layer=Se,n.LayerGroup=$i,n.LineUtil=nh,n.Map=ht,n.Marker=ms,n.Mixin=Yc,n.Path=oi,n.Point=K,n.PolyUtil=Xc,n.Polygon=Fi,n.Polyline=We,n.Popup=xs,n.PosAnimation=pa,n.Projection=sh,n.Rectangle=Ba,n.Renderer=qe,n.SVG=En,n.SVGOverlay=La,n.TileLayer=Wi,n.Tooltip=Ss,n.Transformation=as,n.Util=Ni,n.VideoOverlay=Aa,n.bind=u,n.bounds=Et,n.canvas=ja,n.circle=dh,n.circleMarker=hh,n.control=bn,n.divIcon=bh,n.extend=o,n.featureGroup=lh,n.geoJSON=Ca,n.geoJson=_h,n.gridLayer=Th,n.icon=uh,n.imageOverlay=mh,n.latLng=at,n.latLngBounds=Ct,n.layerGroup=ah,n.map=Hc,n.marker=ch,n.point=tt,n.polygon=ph,n.polyline=fh,n.popup=yh,n.rectangle=Ph,n.setOptions=P,n.stamp=f,n.svg=Da,n.svgOverlay=vh,n.tileLayer=Ia,n.tooltip=wh,n.transformation=v,n.version=r,n.videoOverlay=gh;var kh=window.L;n.noConflict=function(){return window.L=kh,this},window.L=n}))})(Rn,Rn.exports)),Rn.exports}var cp=up();const Rs=ap(cp);function ur(i,t){var n={};for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&t.indexOf(r)<0&&(n[r]=i[r]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(i);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(i,r[o])&&(n[r[o]]=i[r[o]]);return n}function hp(i,t,n,r){function o(l){return l instanceof n?l:new n(function(u){u(l)})}return new(n||(n=Promise))(function(l,u){function h(m){try{p(r.next(m))}catch(g){u(g)}}function f(m){try{p(r.throw(m))}catch(g){u(g)}}function p(m){m.done?l(m.value):o(m.value).then(h,f)}p((r=r.apply(i,t||[])).next())})}const dp=i=>i?(...t)=>i(...t):(...t)=>fetch(...t);class Go extends Error{constructor(t,n="FunctionsError",r){super(t),this.name=n,this.context=r}}class fp extends Go{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class kl extends Go{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Ol extends Go{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var yo;(function(i){i.Any="any",i.ApNortheast1="ap-northeast-1",i.ApNortheast2="ap-northeast-2",i.ApSouth1="ap-south-1",i.ApSoutheast1="ap-southeast-1",i.ApSoutheast2="ap-southeast-2",i.CaCentral1="ca-central-1",i.EuCentral1="eu-central-1",i.EuWest1="eu-west-1",i.EuWest2="eu-west-2",i.EuWest3="eu-west-3",i.SaEast1="sa-east-1",i.UsEast1="us-east-1",i.UsWest1="us-west-1",i.UsWest2="us-west-2"})(yo||(yo={}));class pp{constructor(t,{headers:n={},customFetch:r,region:o=yo.Any}={}){this.url=t,this.headers=n,this.region=o,this.fetch=dp(r)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return hp(this,arguments,void 0,function*(n,r={}){var o;let l,u;try{const{headers:h,method:f,body:p,signal:m,timeout:g}=r;let w={},{region:b}=r;b||(b=this.region);const S=new URL(`${this.url}/${n}`);b&&b!=="any"&&(w["x-region"]=b,S.searchParams.set("forceFunctionRegion",b));let P;p&&(h&&!Object.prototype.hasOwnProperty.call(h,"Content-Type")||!h)?typeof Blob<"u"&&p instanceof Blob||p instanceof ArrayBuffer?(w["Content-Type"]="application/octet-stream",P=p):typeof p=="string"?(w["Content-Type"]="text/plain",P=p):typeof FormData<"u"&&p instanceof FormData?P=p:(w["Content-Type"]="application/json",P=JSON.stringify(p)):p&&typeof p!="string"&&!(typeof Blob<"u"&&p instanceof Blob)&&!(p instanceof ArrayBuffer)&&!(typeof FormData<"u"&&p instanceof FormData)?P=JSON.stringify(p):P=p;let B=m;g&&(u=new AbortController,l=setTimeout(()=>u.abort(),g),m?(B=u.signal,m.addEventListener("abort",()=>u.abort())):B=u.signal);const j=yield this.fetch(S.toString(),{method:f||"POST",headers:Object.assign(Object.assign(Object.assign({},w),this.headers),h),body:P,signal:B}).catch(H=>{throw new fp(H)}),U=j.headers.get("x-relay-error");if(U&&U==="true")throw new kl(j);if(!j.ok)throw new Ol(j);let O=((o=j.headers.get("Content-Type"))!==null&&o!==void 0?o:"text/plain").split(";")[0].trim(),k;return O==="application/json"?k=yield j.json():O==="application/octet-stream"||O==="application/pdf"?k=yield j.blob():O==="text/event-stream"?k=j:O==="multipart/form-data"?k=yield j.formData():k=yield j.text(),{data:k,error:null,response:j}}catch(h){return{data:null,error:h,response:h instanceof Ol||h instanceof kl?h.context:void 0}}finally{l&&clearTimeout(l)}})}}var _p=class extends Error{constructor(i){super(i.message),this.name="PostgrestError",this.details=i.details,this.hint=i.hint,this.code=i.code}},mp=class{constructor(i){var t,n,r;this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=new Headers(i.headers),this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=(t=i.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=i.signal,this.isMaybeSingle=(n=i.isMaybeSingle)!==null&&n!==void 0?n:!1,this.urlLengthLimit=(r=i.urlLengthLimit)!==null&&r!==void 0?r:8e3,i.fetch?this.fetch=i.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,t){return this.headers=new Headers(this.headers),this.headers.set(i,t),this}then(i,t){var n=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const r=this.fetch;let o=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async l=>{let u=null,h=null,f=null,p=l.status,m=l.statusText;if(l.ok){var g,w;if(n.method!=="HEAD"){var b;const j=await l.text();j===""||(n.headers.get("Accept")==="text/csv"||n.headers.get("Accept")&&(!((b=n.headers.get("Accept"))===null||b===void 0)&&b.includes("application/vnd.pgrst.plan+text"))?h=j:h=JSON.parse(j))}const P=(g=n.headers.get("Prefer"))===null||g===void 0?void 0:g.match(/count=(exact|planned|estimated)/),B=(w=l.headers.get("content-range"))===null||w===void 0?void 0:w.split("/");P&&B&&B.length>1&&(f=parseInt(B[1])),n.isMaybeSingle&&n.method==="GET"&&Array.isArray(h)&&(h.length>1?(u={code:"PGRST116",details:`Results contain ${h.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},h=null,f=null,p=406,m="Not Acceptable"):h.length===1?h=h[0]:h=null)}else{var S;const P=await l.text();try{u=JSON.parse(P),Array.isArray(u)&&l.status===404&&(h=[],u=null,p=200,m="OK")}catch{l.status===404&&P===""?(p=204,m="No Content"):u={message:P}}if(u&&n.isMaybeSingle&&(!(u==null||(S=u.details)===null||S===void 0)&&S.includes("0 rows"))&&(u=null,p=200,m="OK"),u&&n.shouldThrowOnError)throw new _p(u)}return{error:u,data:h,count:f,status:p,statusText:m}});return this.shouldThrowOnError||(o=o.catch(l=>{var u;let h="",f="",p="";const m=l?.cause;if(m){var g,w,b,S;const j=(g=m?.message)!==null&&g!==void 0?g:"",U=(w=m?.code)!==null&&w!==void 0?w:"";h=`${(b=l?.name)!==null&&b!==void 0?b:"FetchError"}: ${l?.message}`,h+=`

Caused by: ${(S=m?.name)!==null&&S!==void 0?S:"Error"}: ${j}`,U&&(h+=` (${U})`),m?.stack&&(h+=`
${m.stack}`)}else{var P;h=(P=l?.stack)!==null&&P!==void 0?P:""}const B=this.url.toString().length;return l?.name==="AbortError"||l?.code==="ABORT_ERR"?(p="",f="Request was aborted (timeout or manual cancellation)",B>this.urlLengthLimit&&(f+=`. Note: Your request URL is ${B} characters, which may exceed server limits. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [many IDs])), consider using an RPC function to pass values server-side.`)):(m?.name==="HeadersOverflowError"||m?.code==="UND_ERR_HEADERS_OVERFLOW")&&(p="",f="HTTP headers exceeded server limits (typically 16KB)",B>this.urlLengthLimit&&(f+=`. Your request URL is ${B} characters. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [200+ IDs])), consider using an RPC function instead.`)),{error:{message:`${(u=l?.name)!==null&&u!==void 0?u:"FetchError"}: ${l?.message}`,details:h,hint:f,code:p},data:null,count:null,status:0,statusText:""}})),o.then(i,t)}returns(){return this}overrideTypes(){return this}},gp=class extends mp{select(i){let t=!1;const n=(i??"*").split("").map(r=>/\s/.test(r)&&!t?"":(r==='"'&&(t=!t),r)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(i,{ascending:t=!0,nullsFirst:n,foreignTable:r,referencedTable:o=r}={}){const l=o?`${o}.order`:"order",u=this.url.searchParams.get(l);return this.url.searchParams.set(l,`${u?`${u},`:""}${i}.${t?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(i,{foreignTable:t,referencedTable:n=t}={}){const r=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(r,`${i}`),this}range(i,t,{foreignTable:n,referencedTable:r=n}={}){const o=typeof r>"u"?"offset":`${r}.offset`,l=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(o,`${i}`),this.url.searchParams.set(l,`${t-i+1}`),this}abortSignal(i){return this.signal=i,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:i=!1,verbose:t=!1,settings:n=!1,buffers:r=!1,wal:o=!1,format:l="text"}={}){var u;const h=[i?"analyze":null,t?"verbose":null,n?"settings":null,r?"buffers":null,o?"wal":null].filter(Boolean).join("|"),f=(u=this.headers.get("Accept"))!==null&&u!==void 0?u:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${l}; for="${f}"; options=${h};`),l==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(i){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${i}`),this}};const Cl=new RegExp("[,()]");var en=class extends gp{eq(i,t){return this.url.searchParams.append(i,`eq.${t}`),this}neq(i,t){return this.url.searchParams.append(i,`neq.${t}`),this}gt(i,t){return this.url.searchParams.append(i,`gt.${t}`),this}gte(i,t){return this.url.searchParams.append(i,`gte.${t}`),this}lt(i,t){return this.url.searchParams.append(i,`lt.${t}`),this}lte(i,t){return this.url.searchParams.append(i,`lte.${t}`),this}like(i,t){return this.url.searchParams.append(i,`like.${t}`),this}likeAllOf(i,t){return this.url.searchParams.append(i,`like(all).{${t.join(",")}}`),this}likeAnyOf(i,t){return this.url.searchParams.append(i,`like(any).{${t.join(",")}}`),this}ilike(i,t){return this.url.searchParams.append(i,`ilike.${t}`),this}ilikeAllOf(i,t){return this.url.searchParams.append(i,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(i,t){return this.url.searchParams.append(i,`ilike(any).{${t.join(",")}}`),this}regexMatch(i,t){return this.url.searchParams.append(i,`match.${t}`),this}regexIMatch(i,t){return this.url.searchParams.append(i,`imatch.${t}`),this}is(i,t){return this.url.searchParams.append(i,`is.${t}`),this}isDistinct(i,t){return this.url.searchParams.append(i,`isdistinct.${t}`),this}in(i,t){const n=Array.from(new Set(t)).map(r=>typeof r=="string"&&Cl.test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(i,`in.(${n})`),this}notIn(i,t){const n=Array.from(new Set(t)).map(r=>typeof r=="string"&&Cl.test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(i,`not.in.(${n})`),this}contains(i,t){return typeof t=="string"?this.url.searchParams.append(i,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(i,`cs.{${t.join(",")}}`):this.url.searchParams.append(i,`cs.${JSON.stringify(t)}`),this}containedBy(i,t){return typeof t=="string"?this.url.searchParams.append(i,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(i,`cd.{${t.join(",")}}`):this.url.searchParams.append(i,`cd.${JSON.stringify(t)}`),this}rangeGt(i,t){return this.url.searchParams.append(i,`sr.${t}`),this}rangeGte(i,t){return this.url.searchParams.append(i,`nxl.${t}`),this}rangeLt(i,t){return this.url.searchParams.append(i,`sl.${t}`),this}rangeLte(i,t){return this.url.searchParams.append(i,`nxr.${t}`),this}rangeAdjacent(i,t){return this.url.searchParams.append(i,`adj.${t}`),this}overlaps(i,t){return typeof t=="string"?this.url.searchParams.append(i,`ov.${t}`):this.url.searchParams.append(i,`ov.{${t.join(",")}}`),this}textSearch(i,t,{config:n,type:r}={}){let o="";r==="plain"?o="pl":r==="phrase"?o="ph":r==="websearch"&&(o="w");const l=n===void 0?"":`(${n})`;return this.url.searchParams.append(i,`${o}fts${l}.${t}`),this}match(i){return Object.entries(i).forEach(([t,n])=>{this.url.searchParams.append(t,`eq.${n}`)}),this}not(i,t,n){return this.url.searchParams.append(i,`not.${t}.${n}`),this}or(i,{foreignTable:t,referencedTable:n=t}={}){const r=n?`${n}.or`:"or";return this.url.searchParams.append(r,`(${i})`),this}filter(i,t,n){return this.url.searchParams.append(i,`${t}.${n}`),this}},vp=class{constructor(i,{headers:t={},schema:n,fetch:r,urlLengthLimit:o=8e3}){this.url=i,this.headers=new Headers(t),this.schema=n,this.fetch=r,this.urlLengthLimit=o}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(i,t){const{head:n=!1,count:r}=t??{},o=n?"HEAD":"GET";let l=!1;const u=(i??"*").split("").map(p=>/\s/.test(p)&&!l?"":(p==='"'&&(l=!l),p)).join(""),{url:h,headers:f}=this.cloneRequestState();return h.searchParams.set("select",u),r&&f.append("Prefer",`count=${r}`),new en({method:o,url:h,headers:f,schema:this.schema,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}insert(i,{count:t,defaultToNull:n=!0}={}){var r;const o="POST",{url:l,headers:u}=this.cloneRequestState();if(t&&u.append("Prefer",`count=${t}`),n||u.append("Prefer","missing=default"),Array.isArray(i)){const h=i.reduce((f,p)=>f.concat(Object.keys(p)),[]);if(h.length>0){const f=[...new Set(h)].map(p=>`"${p}"`);l.searchParams.set("columns",f.join(","))}}return new en({method:o,url:l,headers:u,schema:this.schema,body:i,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch,urlLengthLimit:this.urlLengthLimit})}upsert(i,{onConflict:t,ignoreDuplicates:n=!1,count:r,defaultToNull:o=!0}={}){var l;const u="POST",{url:h,headers:f}=this.cloneRequestState();if(f.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),t!==void 0&&h.searchParams.set("on_conflict",t),r&&f.append("Prefer",`count=${r}`),o||f.append("Prefer","missing=default"),Array.isArray(i)){const p=i.reduce((m,g)=>m.concat(Object.keys(g)),[]);if(p.length>0){const m=[...new Set(p)].map(g=>`"${g}"`);h.searchParams.set("columns",m.join(","))}}return new en({method:u,url:h,headers:f,schema:this.schema,body:i,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch,urlLengthLimit:this.urlLengthLimit})}update(i,{count:t}={}){var n;const r="PATCH",{url:o,headers:l}=this.cloneRequestState();return t&&l.append("Prefer",`count=${t}`),new en({method:r,url:o,headers:l,schema:this.schema,body:i,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch,urlLengthLimit:this.urlLengthLimit})}delete({count:i}={}){var t;const n="DELETE",{url:r,headers:o}=this.cloneRequestState();return i&&o.append("Prefer",`count=${i}`),new en({method:n,url:r,headers:o,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch,urlLengthLimit:this.urlLengthLimit})}};function Jn(i){"@babel/helpers - typeof";return Jn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jn(i)}function yp(i,t){if(Jn(i)!="object"||!i)return i;var n=i[Symbol.toPrimitive];if(n!==void 0){var r=n.call(i,t);if(Jn(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(i)}function wp(i){var t=yp(i,"string");return Jn(t)=="symbol"?t:t+""}function bp(i,t,n){return(t=wp(t))in i?Object.defineProperty(i,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[t]=n,i}function Al(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(i,o).enumerable})),n.push.apply(n,r)}return n}function Is(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Al(Object(n),!0).forEach(function(r){bp(i,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):Al(Object(n)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(n,r))})}return i}var Tp=class nc{constructor(t,{headers:n={},schema:r,fetch:o,timeout:l,urlLengthLimit:u=8e3}={}){this.url=t,this.headers=new Headers(n),this.schemaName=r,this.urlLengthLimit=u;const h=o??globalThis.fetch;l!==void 0&&l>0?this.fetch=(f,p)=>{const m=new AbortController,g=setTimeout(()=>m.abort(),l),w=p?.signal;if(w){if(w.aborted)return clearTimeout(g),h(f,p);const b=()=>{clearTimeout(g),m.abort()};return w.addEventListener("abort",b,{once:!0}),h(f,Is(Is({},p),{},{signal:m.signal})).finally(()=>{clearTimeout(g),w.removeEventListener("abort",b)})}return h(f,Is(Is({},p),{},{signal:m.signal})).finally(()=>clearTimeout(g))}:this.fetch=h}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new vp(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}schema(t){return new nc(this.url,{headers:this.headers,schema:t,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}rpc(t,n={},{head:r=!1,get:o=!1,count:l}={}){var u;let h;const f=new URL(`${this.url}/rpc/${t}`);let p;const m=b=>b!==null&&typeof b=="object"&&(!Array.isArray(b)||b.some(m)),g=r&&Object.values(n).some(m);g?(h="POST",p=n):r||o?(h=r?"HEAD":"GET",Object.entries(n).filter(([b,S])=>S!==void 0).map(([b,S])=>[b,Array.isArray(S)?`{${S.join(",")}}`:`${S}`]).forEach(([b,S])=>{f.searchParams.append(b,S)})):(h="POST",p=n);const w=new Headers(this.headers);return g?w.set("Prefer",l?`count=${l},return=minimal`:"return=minimal"):l&&w.set("Prefer",`count=${l}`),new en({method:h,url:f,headers:w,schema:this.schemaName,body:p,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch,urlLengthLimit:this.urlLengthLimit})}};class xp{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const n=globalThis.process;if(n){const r=n.versions;if(r&&r.node){const o=r.node,l=parseInt(o.replace(/^v/,"").split(".")[0]);return l>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${l} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${l} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let n=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(n+=`

Suggested solution: ${t.workaround}`),new Error(n)}static createWebSocket(t,n){const r=this.getWebSocketConstructor();return new r(t,n)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const Sp="2.95.3",Pp=`realtime-js/${Sp}`,Ep="1.0.0",sc="2.0.0",Ll=sc,wo=1e4,kp=1e3,Op=100;var ci;(function(i){i[i.connecting=0]="connecting",i[i.open=1]="open",i[i.closing=2]="closing",i[i.closed=3]="closed"})(ci||(ci={}));var Ut;(function(i){i.closed="closed",i.errored="errored",i.joined="joined",i.joining="joining",i.leaving="leaving"})(Ut||(Ut={}));var ke;(function(i){i.close="phx_close",i.error="phx_error",i.join="phx_join",i.reply="phx_reply",i.leave="phx_leave",i.access_token="access_token"})(ke||(ke={}));var bo;(function(i){i.websocket="websocket"})(bo||(bo={}));var Oi;(function(i){i.Connecting="connecting",i.Open="open",i.Closing="closing",i.Closed="closed"})(Oi||(Oi={}));class Cp{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,n){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return n(this._binaryEncodeUserBroadcastPush(t));let r=[t.join_ref,t.ref,t.topic,t.event,t.payload];return n(JSON.stringify(r))}_binaryEncodeUserBroadcastPush(t){var n;return this._isArrayBuffer((n=t.payload)===null||n===void 0?void 0:n.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var n,r;const o=(r=(n=t.payload)===null||n===void 0?void 0:n.payload)!==null&&r!==void 0?r:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,o)}_encodeJsonUserBroadcastPush(t){var n,r;const o=(r=(n=t.payload)===null||n===void 0?void 0:n.payload)!==null&&r!==void 0?r:{},u=new TextEncoder().encode(JSON.stringify(o)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,u)}_encodeUserBroadcastPush(t,n,r){var o,l;const u=t.topic,h=(o=t.ref)!==null&&o!==void 0?o:"",f=(l=t.join_ref)!==null&&l!==void 0?l:"",p=t.payload.event,m=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},g=Object.keys(m).length===0?"":JSON.stringify(m);if(f.length>255)throw new Error(`joinRef length ${f.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`ref length ${h.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`topic length ${u.length} exceeds maximum of 255`);if(p.length>255)throw new Error(`userEvent length ${p.length} exceeds maximum of 255`);if(g.length>255)throw new Error(`metadata length ${g.length} exceeds maximum of 255`);const w=this.USER_BROADCAST_PUSH_META_LENGTH+f.length+h.length+u.length+p.length+g.length,b=new ArrayBuffer(this.HEADER_LENGTH+w);let S=new DataView(b),P=0;S.setUint8(P++,this.KINDS.userBroadcastPush),S.setUint8(P++,f.length),S.setUint8(P++,h.length),S.setUint8(P++,u.length),S.setUint8(P++,p.length),S.setUint8(P++,g.length),S.setUint8(P++,n),Array.from(f,j=>S.setUint8(P++,j.charCodeAt(0))),Array.from(h,j=>S.setUint8(P++,j.charCodeAt(0))),Array.from(u,j=>S.setUint8(P++,j.charCodeAt(0))),Array.from(p,j=>S.setUint8(P++,j.charCodeAt(0))),Array.from(g,j=>S.setUint8(P++,j.charCodeAt(0)));var B=new Uint8Array(b.byteLength+r.byteLength);return B.set(new Uint8Array(b),0),B.set(new Uint8Array(r),b.byteLength),B.buffer}decode(t,n){if(this._isArrayBuffer(t)){let r=this._binaryDecode(t);return n(r)}if(typeof t=="string"){const r=JSON.parse(t),[o,l,u,h,f]=r;return n({join_ref:o,ref:l,topic:u,event:h,payload:f})}return n({})}_binaryDecode(t){const n=new DataView(t),r=n.getUint8(0),o=new TextDecoder;if(r===this.KINDS.userBroadcast)return this._decodeUserBroadcast(t,n,o)}_decodeUserBroadcast(t,n,r){const o=n.getUint8(1),l=n.getUint8(2),u=n.getUint8(3),h=n.getUint8(4);let f=this.HEADER_LENGTH+4;const p=r.decode(t.slice(f,f+o));f=f+o;const m=r.decode(t.slice(f,f+l));f=f+l;const g=r.decode(t.slice(f,f+u));f=f+u;const w=t.slice(f,t.byteLength),b=h===this.JSON_ENCODING?JSON.parse(r.decode(w)):w,S={type:this.BROADCAST_EVENT,event:m,payload:b};return u>0&&(S.meta=JSON.parse(g)),{join_ref:null,ref:null,topic:p,event:this.BROADCAST_EVENT,payload:S}}_isArrayBuffer(t){var n;return t instanceof ArrayBuffer||((n=t?.constructor)===null||n===void 0?void 0:n.name)==="ArrayBuffer"}_pick(t,n){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([r])=>n.includes(r)))}}class rc{constructor(t,n){this.callback=t,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var St;(function(i){i.abstime="abstime",i.bool="bool",i.date="date",i.daterange="daterange",i.float4="float4",i.float8="float8",i.int2="int2",i.int4="int4",i.int4range="int4range",i.int8="int8",i.int8range="int8range",i.json="json",i.jsonb="jsonb",i.money="money",i.numeric="numeric",i.oid="oid",i.reltime="reltime",i.text="text",i.time="time",i.timestamp="timestamp",i.timestamptz="timestamptz",i.timetz="timetz",i.tsrange="tsrange",i.tstzrange="tstzrange"})(St||(St={}));const Rl=(i,t,n={})=>{var r;const o=(r=n.skipTypes)!==null&&r!==void 0?r:[];return t?Object.keys(t).reduce((l,u)=>(l[u]=Ap(u,i,t,o),l),{}):{}},Ap=(i,t,n,r)=>{const o=t.find(h=>h.name===i),l=o?.type,u=n[i];return l&&!r.includes(l)?oc(l,u):To(u)},oc=(i,t)=>{if(i.charAt(0)==="_"){const n=i.slice(1,i.length);return Mp(t,n)}switch(i){case St.bool:return Lp(t);case St.float4:case St.float8:case St.int2:case St.int4:case St.int8:case St.numeric:case St.oid:return Rp(t);case St.json:case St.jsonb:return Ip(t);case St.timestamp:return Np(t);case St.abstime:case St.date:case St.daterange:case St.int4range:case St.int8range:case St.money:case St.reltime:case St.text:case St.time:case St.timestamptz:case St.timetz:case St.tsrange:case St.tstzrange:return To(t);default:return To(t)}},To=i=>i,Lp=i=>{switch(i){case"t":return!0;case"f":return!1;default:return i}},Rp=i=>{if(typeof i=="string"){const t=parseFloat(i);if(!Number.isNaN(t))return t}return i},Ip=i=>{if(typeof i=="string")try{return JSON.parse(i)}catch{return i}return i},Mp=(i,t)=>{if(typeof i!="string")return i;const n=i.length-1,r=i[n];if(i[0]==="{"&&r==="}"){let l;const u=i.slice(1,n);try{l=JSON.parse("["+u+"]")}catch{l=u?u.split(","):[]}return l.map(h=>oc(t,h))}return i},Np=i=>typeof i=="string"?i.replace(" ","T"):i,ac=i=>{const t=new URL(i);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class Qr{constructor(t,n,r={},o=wo){this.channel=t,this.event=n,this.payload=r,this.timeout=o,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,n){var r;return this._hasReceived(t)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:t,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:n}){this.recHooks.filter(r=>r.status===t).forEach(r=>r.callback(n))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Il;(function(i){i.SYNC="sync",i.JOIN="join",i.LEAVE="leave"})(Il||(Il={}));class Fn{constructor(t,n){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=n?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},o=>{const{onJoin:l,onLeave:u,onSync:h}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Fn.syncState(this.state,o,l,u),this.pendingDiffs.forEach(f=>{this.state=Fn.syncDiff(this.state,f,l,u)}),this.pendingDiffs=[],h()}),this.channel._on(r.diff,{},o=>{const{onJoin:l,onLeave:u,onSync:h}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(o):(this.state=Fn.syncDiff(this.state,o,l,u),h())}),this.onJoin((o,l,u)=>{this.channel._trigger("presence",{event:"join",key:o,currentPresences:l,newPresences:u})}),this.onLeave((o,l,u)=>{this.channel._trigger("presence",{event:"leave",key:o,currentPresences:l,leftPresences:u})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,n,r,o){const l=this.cloneDeep(t),u=this.transformState(n),h={},f={};return this.map(l,(p,m)=>{u[p]||(f[p]=m)}),this.map(u,(p,m)=>{const g=l[p];if(g){const w=m.map(B=>B.presence_ref),b=g.map(B=>B.presence_ref),S=m.filter(B=>b.indexOf(B.presence_ref)<0),P=g.filter(B=>w.indexOf(B.presence_ref)<0);S.length>0&&(h[p]=S),P.length>0&&(f[p]=P)}else h[p]=m}),this.syncDiff(l,{joins:h,leaves:f},r,o)}static syncDiff(t,n,r,o){const{joins:l,leaves:u}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),o||(o=()=>{}),this.map(l,(h,f)=>{var p;const m=(p=t[h])!==null&&p!==void 0?p:[];if(t[h]=this.cloneDeep(f),m.length>0){const g=t[h].map(b=>b.presence_ref),w=m.filter(b=>g.indexOf(b.presence_ref)<0);t[h].unshift(...w)}r(h,m,f)}),this.map(u,(h,f)=>{let p=t[h];if(!p)return;const m=f.map(g=>g.presence_ref);p=p.filter(g=>m.indexOf(g.presence_ref)<0),t[h]=p,o(h,p,f),p.length===0&&delete t[h]}),t}static map(t,n){return Object.getOwnPropertyNames(t).map(r=>n(r,t[r]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((n,r)=>{const o=t[r];return"metas"in o?n[r]=o.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):n[r]=o,n},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Ml;(function(i){i.ALL="*",i.INSERT="INSERT",i.UPDATE="UPDATE",i.DELETE="DELETE"})(Ml||(Ml={}));var Zn;(function(i){i.BROADCAST="broadcast",i.PRESENCE="presence",i.POSTGRES_CHANGES="postgres_changes",i.SYSTEM="system"})(Zn||(Zn={}));var Ge;(function(i){i.SUBSCRIBED="SUBSCRIBED",i.TIMED_OUT="TIMED_OUT",i.CLOSED="CLOSED",i.CHANNEL_ERROR="CHANNEL_ERROR"})(Ge||(Ge={}));class rn{constructor(t,n={config:{}},r){var o,l;if(this.topic=t,this.params=n,this.socket=r,this.bindings={},this.state=Ut.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Qr(this,ke.join,this.params,this.timeout),this.rejoinTimer=new rc(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ut.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(u=>u.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ut.closed,this.socket._remove(this)}),this._onError(u=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,u),this.state=Ut.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ut.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",u=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,u),this.state=Ut.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ke.reply,{},(u,h)=>{this._trigger(this._replyEventName(h),u)}),this.presence=new Fn(this),this.broadcastEndpointURL=ac(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((l=(o=this.params.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,n=this.timeout){var r,o,l;if(this.socket.isConnected()||this.socket.connect(),this.state==Ut.closed){const{config:{broadcast:u,presence:h,private:f}}=this.params,p=(o=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(b=>b.filter))!==null&&o!==void 0?o:[],m=!!this.bindings[Zn.PRESENCE]&&this.bindings[Zn.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,g={},w={broadcast:u,presence:Object.assign(Object.assign({},h),{enabled:m}),postgres_changes:p,private:f};this.socket.accessTokenValue&&(g.access_token=this.socket.accessTokenValue),this._onError(b=>t?.(Ge.CHANNEL_ERROR,b)),this._onClose(()=>t?.(Ge.CLOSED)),this.updateJoinPayload(Object.assign({config:w},g)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:b})=>{var S;if(this.socket._isManualToken()||this.socket.setAuth(),b===void 0){t?.(Ge.SUBSCRIBED);return}else{const P=this.bindings.postgres_changes,B=(S=P?.length)!==null&&S!==void 0?S:0,j=[];for(let U=0;U<B;U++){const O=P[U],{filter:{event:k,schema:H,table:A,filter:V}}=O,_t=b&&b[U];if(_t&&_t.event===k&&rn.isFilterValueEqual(_t.schema,H)&&rn.isFilterValueEqual(_t.table,A)&&rn.isFilterValueEqual(_t.filter,V))j.push(Object.assign(Object.assign({},O),{id:_t.id}));else{this.unsubscribe(),this.state=Ut.errored,t?.(Ge.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=j,t&&t(Ge.SUBSCRIBED);return}}).receive("error",b=>{this.state=Ut.errored,t?.(Ge.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(b).join(", ")||"error")))}).receive("timeout",()=>{t?.(Ge.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,n={}){return await this.send({type:"presence",event:"track",payload:t},n.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,n,r){return this.state===Ut.joined&&t===Zn.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,n,r)}async httpSend(t,n,r={}){var o;if(n==null)return Promise.reject("Payload is required for httpSend()");const l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const u={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:n,private:this.private}]})},h=await this._fetchWithTimeout(this.broadcastEndpointURL,u,(o=r.timeout)!==null&&o!==void 0?o:this.timeout);if(h.status===202)return{success:!0};let f=h.statusText;try{const p=await h.json();f=p.error||p.message||f}catch{}return Promise.reject(new Error(f))}async send(t,n={}){var r,o;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:l,payload:u}=t,h={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(h.Authorization=`Bearer ${this.socket.accessTokenValue}`);const f={method:"POST",headers:h,body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:u,private:this.private}]})};try{const p=await this._fetchWithTimeout(this.broadcastEndpointURL,f,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((o=p.body)===null||o===void 0?void 0:o.cancel()),p.ok?"ok":"error"}catch(p){return p.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var u,h,f;const p=this._push(t.type,t,n.timeout||this.timeout);t.type==="broadcast"&&!(!((f=(h=(u=this.params)===null||u===void 0?void 0:u.config)===null||h===void 0?void 0:h.broadcast)===null||f===void 0)&&f.ack)&&l("ok"),p.receive("ok",()=>l("ok")),p.receive("error",()=>l("error")),p.receive("timeout",()=>l("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Ut.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ke.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(o=>{r=new Qr(this,ke.leave,{},t),r.receive("ok",()=>{n(),o("ok")}).receive("timeout",()=>{n(),o("timed out")}).receive("error",()=>{o("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Ut.closed,this.bindings={}}async _fetchWithTimeout(t,n,r){const o=new AbortController,l=setTimeout(()=>o.abort(),r),u=await this.socket.fetch(t,Object.assign(Object.assign({},n),{signal:o.signal}));return clearTimeout(l),u}_push(t,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let o=new Qr(this,t,n,r);return this._canPush()?o.send():this._addToPushBuffer(o),o}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>Op){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(t,n,r){return n}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,n,r){var o,l;const u=t.toLocaleLowerCase(),{close:h,error:f,leave:p,join:m}=ke;if(r&&[h,f,p,m].indexOf(u)>=0&&r!==this._joinRef())return;let w=this._onMessage(u,n,r);if(n&&!w)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(u)?(o=this.bindings.postgres_changes)===null||o===void 0||o.filter(b=>{var S,P,B;return((S=b.filter)===null||S===void 0?void 0:S.event)==="*"||((B=(P=b.filter)===null||P===void 0?void 0:P.event)===null||B===void 0?void 0:B.toLocaleLowerCase())===u}).map(b=>b.callback(w,r)):(l=this.bindings[u])===null||l===void 0||l.filter(b=>{var S,P,B,j,U,O;if(["broadcast","presence","postgres_changes"].includes(u))if("id"in b){const k=b.id,H=(S=b.filter)===null||S===void 0?void 0:S.event;return k&&((P=n.ids)===null||P===void 0?void 0:P.includes(k))&&(H==="*"||H?.toLocaleLowerCase()===((B=n.data)===null||B===void 0?void 0:B.type.toLocaleLowerCase()))}else{const k=(U=(j=b?.filter)===null||j===void 0?void 0:j.event)===null||U===void 0?void 0:U.toLocaleLowerCase();return k==="*"||k===((O=n?.event)===null||O===void 0?void 0:O.toLocaleLowerCase())}else return b.type.toLocaleLowerCase()===u}).map(b=>{if(typeof w=="object"&&"ids"in w){const S=w.data,{schema:P,table:B,commit_timestamp:j,type:U,errors:O}=S;w=Object.assign(Object.assign({},{schema:P,table:B,commit_timestamp:j,eventType:U,new:{},old:{},errors:O}),this._getPayloadRecords(S))}b.callback(w,r)})}_isClosed(){return this.state===Ut.closed}_isJoined(){return this.state===Ut.joined}_isJoining(){return this.state===Ut.joining}_isLeaving(){return this.state===Ut.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,n,r){const o=t.toLocaleLowerCase(),l={type:o,filter:n,callback:r};return this.bindings[o]?this.bindings[o].push(l):this.bindings[o]=[l],this}_off(t,n){const r=t.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(o=>{var l;return!(((l=o.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===r&&rn.isEqual(o.filter,n))})),this}static isEqual(t,n){if(Object.keys(t).length!==Object.keys(n).length)return!1;for(const r in t)if(t[r]!==n[r])return!1;return!0}static isFilterValueEqual(t,n){return(t??void 0)===(n??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(ke.close,{},t)}_onError(t){this._on(ke.error,{},n=>t(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ut.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const n={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(n.new=Rl(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(n.old=Rl(t.columns,t.old_record)),n}}const to=()=>{},Ms={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},jp=[1e3,2e3,5e3,1e4],Dp=1e4,Bp=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Up{constructor(t,n){var r;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=wo,this.transport=null,this.heartbeatIntervalMs=Ms.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=to,this.ref=0,this.reconnectTimer=null,this.vsn=Ll,this.logger=to,this.conn=null,this.sendBuffer=[],this.serializer=new Cp,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=o=>o?(...l)=>o(...l):(...l)=>fetch(...l),!(!((r=n?.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${t}/${bo.websocket}`,this.httpEndpoint=ac(t),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=xp.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const n=t.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,n??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const n=await t.unsubscribe();return n==="ok"&&this._remove(t),this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const t=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,n,r){this.logger(t,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case ci.connecting:return Oi.Connecting;case ci.open:return Oi.Open;case ci.closing:return Oi.Closing;default:return Oi.Closed}}isConnected(){return this.connectionState()===Oi.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,n={config:{}}){const r=`realtime:${t}`,o=this.getChannels().find(l=>l.topic===r);if(o)return o;{const l=new rn(`realtime:${t}`,n,this);return this.channels.push(l),l}}push(t){const{topic:n,event:r,payload:o,ref:l}=t,u=()=>{this.encode(t,h=>{var f;(f=this.conn)===null||f===void 0||f.send(h)})};this.log("push",`${n} ${r} (${l})`,o),this.isConnected()?u():this.sendBuffer.push(u)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(kp,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},Ms.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let n=this.channels.find(r=>r.topic===t&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${t}"`),n.unsubscribe())}_remove(t){this.channels=this.channels.filter(n=>n.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply"&&n.ref&&n.ref===this.pendingHeartbeatRef){const p=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error",p)}catch(m){this.log("error","error in heartbeat callback",m)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:r,event:o,payload:l,ref:u}=n,h=u?`(${u})`:"",f=l.status||"";this.log("receive",`${f} ${r} ${o} ${h}`.trim(),l),this.channels.filter(p=>p._isMember(r)).forEach(p=>p._trigger(o,l,u)),this._triggerStateCallbacks("message",n)})}_clearTimer(t){var n;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===ci.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===ci.open||this.conn.readyState===ci.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(n=>{this.log("error","error waiting for auth on connect",n),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this._terminateWorker()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var n;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t);try{this.heartbeatCallback("error")}catch(n){this.log("error","error in heartbeat callback",n)}}_triggerChanError(){this.channels.forEach(t=>t._trigger(ke.error))}_appendParams(t,n){if(Object.keys(n).length===0)return t;const r=t.match(/\?/)?"&":"?",o=new URLSearchParams(n);return`${t}${r}${o}`}_workerObjectUrl(t){let n;if(t)n=t;else{const r=new Blob([Bp],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}_setConnectionState(t,n=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(t=null){let n,r=!1;if(t)n=t,r=!0;else if(this.accessToken)try{n=await this.accessToken()}catch(o){this.log("error","Error fetching access token from callback",o),n=this.accessTokenValue}else n=this.accessTokenValue;r?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(o=>{const l={access_token:n,version:Pp};n&&o.updateJoinPayload(l),o.joinedOnce&&o._isJoined()&&o._push(ke.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(n=>{this.log("error",`Error setting auth in ${t}`,n)})}_triggerStateCallbacks(t,n){try{this.stateChangeCallbacks[t].forEach(r=>{try{r(n)}catch(o){this.log("error",`error in ${t} callback`,o)}})}catch(r){this.log("error",`error triggering ${t} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new rc(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Ms.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var n,r,o,l,u,h,f,p,m,g,w,b;switch(this.transport=(n=t?.transport)!==null&&n!==void 0?n:null,this.timeout=(r=t?.timeout)!==null&&r!==void 0?r:wo,this.heartbeatIntervalMs=(o=t?.heartbeatIntervalMs)!==null&&o!==void 0?o:Ms.HEARTBEAT_INTERVAL,this.worker=(l=t?.worker)!==null&&l!==void 0?l:!1,this.accessToken=(u=t?.accessToken)!==null&&u!==void 0?u:null,this.heartbeatCallback=(h=t?.heartbeatCallback)!==null&&h!==void 0?h:to,this.vsn=(f=t?.vsn)!==null&&f!==void 0?f:Ll,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(p=t?.reconnectAfterMs)!==null&&p!==void 0?p:(S=>jp[S-1]||Dp),this.vsn){case Ep:this.encode=(m=t?.encode)!==null&&m!==void 0?m:((S,P)=>P(JSON.stringify(S))),this.decode=(g=t?.decode)!==null&&g!==void 0?g:((S,P)=>P(JSON.parse(S)));break;case sc:this.encode=(w=t?.encode)!==null&&w!==void 0?w:this.serializer.encode.bind(this.serializer),this.decode=(b=t?.decode)!==null&&b!==void 0?b:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}}var Yn=class extends Error{constructor(i,t){super(i),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&t.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function $p(i,t,n){const r=new URL(t,i);if(n)for(const[o,l]of Object.entries(n))l!==void 0&&r.searchParams.set(o,l);return r.toString()}async function zp(i){return!i||i.type==="none"?{}:i.type==="bearer"?{Authorization:`Bearer ${i.token}`}:i.type==="header"?{[i.name]:i.value}:i.type==="custom"?await i.getHeaders():{}}function Fp(i){const t=i.fetchImpl??globalThis.fetch;return{async request({method:n,path:r,query:o,body:l,headers:u}){const h=$p(i.baseUrl,r,o),f=await zp(i.auth),p=await t(h,{method:n,headers:{...l?{"Content-Type":"application/json"}:{},...f,...u},body:l?JSON.stringify(l):void 0}),m=await p.text(),g=(p.headers.get("content-type")||"").includes("application/json"),w=g&&m?JSON.parse(m):m;if(!p.ok){const b=g?w:void 0,S=b?.error;throw new Yn(S?.message??`Request failed with status ${p.status}`,{status:p.status,icebergType:S?.type,icebergCode:S?.code,details:b})}return{status:p.status,headers:p.headers,data:w}}}}function Ns(i){return i.join("")}var Zp=class{constructor(i,t=""){this.client=i,this.prefix=t}async listNamespaces(i){const t=i?{parent:Ns(i.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(r=>({namespace:r}))}async createNamespace(i,t){const n={namespace:i.namespace,properties:t?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:n})).data}async dropNamespace(i){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Ns(i.namespace)}`})}async loadNamespaceMetadata(i){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ns(i.namespace)}`})).data.properties}}async namespaceExists(i){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Ns(i.namespace)}`}),!0}catch(t){if(t instanceof Yn&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(i,t){try{return await this.createNamespace(i,t)}catch(n){if(n instanceof Yn&&n.status===409)return;throw n}}};function Ki(i){return i.join("")}var Wp=class{constructor(i,t="",n){this.client=i,this.prefix=t,this.accessDelegation=n}async listTables(i){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ki(i.namespace)}/tables`})).data.identifiers}async createTable(i,t){const n={};return this.accessDelegation&&(n["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ki(i.namespace)}/tables`,body:t,headers:n})).data.metadata}async updateTable(i,t){const n=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ki(i.namespace)}/tables/${i.name}`,body:t});return{"metadata-location":n.data["metadata-location"],metadata:n.data.metadata}}async dropTable(i,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Ki(i.namespace)}/tables/${i.name}`,query:{purgeRequested:String(t?.purge??!1)}})}async loadTable(i){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ki(i.namespace)}/tables/${i.name}`,headers:t})).data.metadata}async tableExists(i){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Ki(i.namespace)}/tables/${i.name}`,headers:t}),!0}catch(n){if(n instanceof Yn&&n.status===404)return!1;throw n}}async createTableIfNotExists(i,t){try{return await this.createTable(i,t)}catch(n){if(n instanceof Yn&&n.status===409)return await this.loadTable({namespace:i.namespace,name:t.name});throw n}}},Hp=class{constructor(i){let t="v1";i.catalogName&&(t+=`/${i.catalogName}`);const n=i.baseUrl.endsWith("/")?i.baseUrl:`${i.baseUrl}/`;this.client=Fp({baseUrl:n,auth:i.auth,fetchImpl:i.fetch}),this.accessDelegation=i.accessDelegation?.join(","),this.namespaceOps=new Zp(this.client,t),this.tableOps=new Wp(this.client,t,this.accessDelegation)}async listNamespaces(i){return this.namespaceOps.listNamespaces(i)}async createNamespace(i,t){return this.namespaceOps.createNamespace(i,t)}async dropNamespace(i){await this.namespaceOps.dropNamespace(i)}async loadNamespaceMetadata(i){return this.namespaceOps.loadNamespaceMetadata(i)}async listTables(i){return this.tableOps.listTables(i)}async createTable(i,t){return this.tableOps.createTable(i,t)}async updateTable(i,t){return this.tableOps.updateTable(i,t)}async dropTable(i,t){await this.tableOps.dropTable(i,t)}async loadTable(i){return this.tableOps.loadTable(i)}async namespaceExists(i){return this.namespaceOps.namespaceExists(i)}async tableExists(i){return this.tableOps.tableExists(i)}async createNamespaceIfNotExists(i,t){return this.namespaceOps.createNamespaceIfNotExists(i,t)}async createTableIfNotExists(i,t){return this.tableOps.createTableIfNotExists(i,t)}},cr=class extends Error{constructor(i,t="storage",n,r){super(i),this.__isStorageError=!0,this.namespace=t,this.name=t==="vectors"?"StorageVectorsError":"StorageError",this.status=n,this.statusCode=r}};function hr(i){return typeof i=="object"&&i!==null&&"__isStorageError"in i}var js=class extends cr{constructor(i,t,n,r="storage"){super(i,r,t,n),this.name=r==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=t,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},lc=class extends cr{constructor(i,t,n="storage"){super(i,n),this.name=n==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=t}};const qp=i=>i?(...t)=>i(...t):(...t)=>fetch(...t),Kp=i=>{if(typeof i!="object"||i===null)return!1;const t=Object.getPrototypeOf(i);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in i)&&!(Symbol.iterator in i)},xo=i=>{if(Array.isArray(i))return i.map(n=>xo(n));if(typeof i=="function"||i!==Object(i))return i;const t={};return Object.entries(i).forEach(([n,r])=>{const o=n.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));t[o]=xo(r)}),t},Vp=i=>!i||typeof i!="string"||i.length===0||i.length>100||i.trim()!==i||i.includes("/")||i.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(i);function Xn(i){"@babel/helpers - typeof";return Xn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xn(i)}function Gp(i,t){if(Xn(i)!="object"||!i)return i;var n=i[Symbol.toPrimitive];if(n!==void 0){var r=n.call(i,t);if(Xn(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(i)}function Jp(i){var t=Gp(i,"string");return Xn(t)=="symbol"?t:t+""}function Yp(i,t,n){return(t=Jp(t))in i?Object.defineProperty(i,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[t]=n,i}function Nl(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(i,o).enumerable})),n.push.apply(n,r)}return n}function it(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Nl(Object(n),!0).forEach(function(r){Yp(i,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):Nl(Object(n)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(n,r))})}return i}const jl=i=>{var t;return i.msg||i.message||i.error_description||(typeof i.error=="string"?i.error:(t=i.error)===null||t===void 0?void 0:t.message)||JSON.stringify(i)},Xp=async(i,t,n,r)=>{if(i&&typeof i=="object"&&"status"in i&&"ok"in i&&typeof i.status=="number"&&!n?.noResolveJson){const o=i,l=o.status||500;if(typeof o.json=="function")o.json().then(u=>{const h=u?.statusCode||u?.code||l+"";t(new js(jl(u),l,h,r))}).catch(()=>{if(r==="vectors"){const u=l+"";t(new js(o.statusText||`HTTP ${l} error`,l,u,r))}else{const u=l+"";t(new js(o.statusText||`HTTP ${l} error`,l,u,r))}});else{const u=l+"";t(new js(o.statusText||`HTTP ${l} error`,l,u,r))}}else t(new lc(jl(i),i,r))},Qp=(i,t,n,r)=>{const o={method:i,headers:t?.headers||{}};return i==="GET"||i==="HEAD"||!r?it(it({},o),n):(Kp(r)?(o.headers=it({"Content-Type":"application/json"},t?.headers),o.body=JSON.stringify(r)):o.body=r,t?.duplex&&(o.duplex=t.duplex),it(it({},o),n))};async function Cn(i,t,n,r,o,l,u){return new Promise((h,f)=>{i(n,Qp(t,r,o,l)).then(p=>{if(!p.ok)throw p;if(r?.noResolveJson)return p;if(u==="vectors"){const m=p.headers.get("content-type");if(p.headers.get("content-length")==="0"||p.status===204)return{};if(!m||!m.includes("application/json"))return{}}return p.json()}).then(p=>h(p)).catch(p=>Xp(p,f,r,u))})}function uc(i="storage"){return{get:async(t,n,r,o)=>Cn(t,"GET",n,r,o,void 0,i),post:async(t,n,r,o,l)=>Cn(t,"POST",n,o,l,r,i),put:async(t,n,r,o,l)=>Cn(t,"PUT",n,o,l,r,i),head:async(t,n,r,o)=>Cn(t,"HEAD",n,it(it({},r),{},{noResolveJson:!0}),o,void 0,i),remove:async(t,n,r,o,l)=>Cn(t,"DELETE",n,o,l,r,i)}}const t_=uc("storage"),{get:Qn,post:Ee,put:So,head:e_,remove:Jo}=t_,fe=uc("vectors");var fn=class{constructor(i,t={},n,r="storage"){this.shouldThrowOnError=!1,this.url=i,this.headers=t,this.fetch=qp(n),this.namespace=r}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(i){var t=this;try{return{data:await i(),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(hr(n))return{data:null,error:n};throw n}}},i_=class{constructor(i,t){this.downloadFn=i,this.shouldThrowOnError=t}then(i,t){return this.execute().then(i,t)}async execute(){var i=this;try{return{data:(await i.downloadFn()).body,error:null}}catch(t){if(i.shouldThrowOnError)throw t;if(hr(t))return{data:null,error:t};throw t}}};let cc;cc=Symbol.toStringTag;var n_=class{constructor(i,t){this.downloadFn=i,this.shouldThrowOnError=t,this[cc]="BlobDownloadBuilder",this.promise=null}asStream(){return new i_(this.downloadFn,this.shouldThrowOnError)}then(i,t){return this.getPromise().then(i,t)}catch(i){return this.getPromise().catch(i)}finally(i){return this.getPromise().finally(i)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var i=this;try{return{data:await(await i.downloadFn()).blob(),error:null}}catch(t){if(i.shouldThrowOnError)throw t;if(hr(t))return{data:null,error:t};throw t}}};const s_={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Dl={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var r_=class extends fn{constructor(i,t={},n,r){super(i,t,r,"storage"),this.bucketId=n}async uploadOrUpdate(i,t,n,r){var o=this;return o.handleOperation(async()=>{let l;const u=it(it({},Dl),r);let h=it(it({},o.headers),i==="POST"&&{"x-upsert":String(u.upsert)});const f=u.metadata;typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),f&&l.append("metadata",o.encodeMetadata(f)),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.has("cacheControl")||l.append("cacheControl",u.cacheControl),f&&!l.has("metadata")&&l.append("metadata",o.encodeMetadata(f))):(l=n,h["cache-control"]=`max-age=${u.cacheControl}`,h["content-type"]=u.contentType,f&&(h["x-metadata"]=o.toBase64(o.encodeMetadata(f))),(typeof ReadableStream<"u"&&l instanceof ReadableStream||l&&typeof l=="object"&&"pipe"in l&&typeof l.pipe=="function")&&!u.duplex&&(u.duplex="half")),r?.headers&&(h=it(it({},h),r.headers));const p=o._removeEmptyFolders(t),m=o._getFinalPath(p),g=await(i=="PUT"?So:Ee)(o.fetch,`${o.url}/object/${m}`,l,it({headers:h},u?.duplex?{duplex:u.duplex}:{}));return{path:p,id:g.Id,fullPath:g.Key}})}async upload(i,t,n){return this.uploadOrUpdate("POST",i,t,n)}async uploadToSignedUrl(i,t,n,r){var o=this;const l=o._removeEmptyFolders(i),u=o._getFinalPath(l),h=new URL(o.url+`/object/upload/sign/${u}`);return h.searchParams.set("token",t),o.handleOperation(async()=>{let f;const p=it({upsert:Dl.upsert},r),m=it(it({},o.headers),{"x-upsert":String(p.upsert)});return typeof Blob<"u"&&n instanceof Blob?(f=new FormData,f.append("cacheControl",p.cacheControl),f.append("",n)):typeof FormData<"u"&&n instanceof FormData?(f=n,f.append("cacheControl",p.cacheControl)):(f=n,m["cache-control"]=`max-age=${p.cacheControl}`,m["content-type"]=p.contentType),{path:l,fullPath:(await So(o.fetch,h.toString(),f,{headers:m})).Key}})}async createSignedUploadUrl(i,t){var n=this;return n.handleOperation(async()=>{let r=n._getFinalPath(i);const o=it({},n.headers);t?.upsert&&(o["x-upsert"]="true");const l=await Ee(n.fetch,`${n.url}/object/upload/sign/${r}`,{},{headers:o}),u=new URL(n.url+l.url),h=u.searchParams.get("token");if(!h)throw new cr("No token returned by API");return{signedUrl:u.toString(),path:i,token:h}})}async update(i,t,n){return this.uploadOrUpdate("PUT",i,t,n)}async move(i,t,n){var r=this;return r.handleOperation(async()=>await Ee(r.fetch,`${r.url}/object/move`,{bucketId:r.bucketId,sourceKey:i,destinationKey:t,destinationBucket:n?.destinationBucket},{headers:r.headers}))}async copy(i,t,n){var r=this;return r.handleOperation(async()=>({path:(await Ee(r.fetch,`${r.url}/object/copy`,{bucketId:r.bucketId,sourceKey:i,destinationKey:t,destinationBucket:n?.destinationBucket},{headers:r.headers})).Key}))}async createSignedUrl(i,t,n){var r=this;return r.handleOperation(async()=>{let o=r._getFinalPath(i),l=await Ee(r.fetch,`${r.url}/object/sign/${o}`,it({expiresIn:t},n?.transform?{transform:n.transform}:{}),{headers:r.headers});const u=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{signedUrl:encodeURI(`${r.url}${l.signedURL}${u}`)}})}async createSignedUrls(i,t,n){var r=this;return r.handleOperation(async()=>{const o=await Ee(r.fetch,`${r.url}/object/sign/${r.bucketId}`,{expiresIn:t,paths:i},{headers:r.headers}),l=n?.download?`&download=${n.download===!0?"":n.download}`:"";return o.map(u=>it(it({},u),{},{signedUrl:u.signedURL?encodeURI(`${r.url}${u.signedURL}${l}`):null}))})}download(i,t,n){const r=typeof t?.transform<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString(t?.transform||{}),l=o?`?${o}`:"",u=this._getFinalPath(i),h=()=>Qn(this.fetch,`${this.url}/${r}/${u}${l}`,{headers:this.headers,noResolveJson:!0},n);return new n_(h,this.shouldThrowOnError)}async info(i){var t=this;const n=t._getFinalPath(i);return t.handleOperation(async()=>xo(await Qn(t.fetch,`${t.url}/object/info/${n}`,{headers:t.headers})))}async exists(i){var t=this;const n=t._getFinalPath(i);try{return await e_(t.fetch,`${t.url}/object/${n}`,{headers:t.headers}),{data:!0,error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(hr(r)&&r instanceof lc){const o=r.originalError;if([400,404].includes(o?.status))return{data:!1,error:r}}throw r}}getPublicUrl(i,t){const n=this._getFinalPath(i),r=[],o=t?.download?`download=${t.download===!0?"":t.download}`:"";o!==""&&r.push(o);const l=typeof t?.transform<"u"?"render/image":"object",u=this.transformOptsToQueryString(t?.transform||{});u!==""&&r.push(u);let h=r.join("&");return h!==""&&(h=`?${h}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${h}`)}}}async remove(i){var t=this;return t.handleOperation(async()=>await Jo(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:i},{headers:t.headers}))}async list(i,t,n){var r=this;return r.handleOperation(async()=>{const o=it(it(it({},s_),t),{},{prefix:i||""});return await Ee(r.fetch,`${r.url}/object/list/${r.bucketId}`,o,{headers:r.headers},n)})}async listV2(i,t){var n=this;return n.handleOperation(async()=>{const r=it({},i);return await Ee(n.fetch,`${n.url}/object/list-v2/${n.bucketId}`,r,{headers:n.headers},t)})}encodeMetadata(i){return JSON.stringify(i)}toBase64(i){return typeof Buffer<"u"?Buffer.from(i).toString("base64"):btoa(i)}_getFinalPath(i){return`${this.bucketId}/${i.replace(/^\/+/,"")}`}_removeEmptyFolders(i){return i.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(i){const t=[];return i.width&&t.push(`width=${i.width}`),i.height&&t.push(`height=${i.height}`),i.resize&&t.push(`resize=${i.resize}`),i.format&&t.push(`format=${i.format}`),i.quality&&t.push(`quality=${i.quality}`),t.join("&")}};const o_="2.95.3",rs={"X-Client-Info":`storage-js/${o_}`};var a_=class extends fn{constructor(i,t={},n,r){const o=new URL(i);r?.useNewHostname&&/supabase\.(co|in|red)$/.test(o.hostname)&&!o.hostname.includes("storage.supabase.")&&(o.hostname=o.hostname.replace("supabase.","storage.supabase."));const l=o.href.replace(/\/$/,""),u=it(it({},rs),t);super(l,u,n,"storage")}async listBuckets(i){var t=this;return t.handleOperation(async()=>{const n=t.listBucketOptionsToQueryString(i);return await Qn(t.fetch,`${t.url}/bucket${n}`,{headers:t.headers})})}async getBucket(i){var t=this;return t.handleOperation(async()=>await Qn(t.fetch,`${t.url}/bucket/${i}`,{headers:t.headers}))}async createBucket(i,t={public:!1}){var n=this;return n.handleOperation(async()=>await Ee(n.fetch,`${n.url}/bucket`,{id:i,name:i,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:n.headers}))}async updateBucket(i,t){var n=this;return n.handleOperation(async()=>await So(n.fetch,`${n.url}/bucket/${i}`,{id:i,name:i,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:n.headers}))}async emptyBucket(i){var t=this;return t.handleOperation(async()=>await Ee(t.fetch,`${t.url}/bucket/${i}/empty`,{},{headers:t.headers}))}async deleteBucket(i){var t=this;return t.handleOperation(async()=>await Jo(t.fetch,`${t.url}/bucket/${i}`,{},{headers:t.headers}))}listBucketOptionsToQueryString(i){const t={};return i&&("limit"in i&&(t.limit=String(i.limit)),"offset"in i&&(t.offset=String(i.offset)),i.search&&(t.search=i.search),i.sortColumn&&(t.sortColumn=i.sortColumn),i.sortOrder&&(t.sortOrder=i.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},l_=class extends fn{constructor(i,t={},n){const r=i.replace(/\/$/,""),o=it(it({},rs),t);super(r,o,n,"storage")}async createBucket(i){var t=this;return t.handleOperation(async()=>await Ee(t.fetch,`${t.url}/bucket`,{name:i},{headers:t.headers}))}async listBuckets(i){var t=this;return t.handleOperation(async()=>{const n=new URLSearchParams;i?.limit!==void 0&&n.set("limit",i.limit.toString()),i?.offset!==void 0&&n.set("offset",i.offset.toString()),i?.sortColumn&&n.set("sortColumn",i.sortColumn),i?.sortOrder&&n.set("sortOrder",i.sortOrder),i?.search&&n.set("search",i.search);const r=n.toString(),o=r?`${t.url}/bucket?${r}`:`${t.url}/bucket`;return await Qn(t.fetch,o,{headers:t.headers})})}async deleteBucket(i){var t=this;return t.handleOperation(async()=>await Jo(t.fetch,`${t.url}/bucket/${i}`,{},{headers:t.headers}))}from(i){var t=this;if(!Vp(i))throw new cr("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const n=new Hp({baseUrl:this.url,catalogName:i,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),r=this.shouldThrowOnError;return new Proxy(n,{get(o,l){const u=o[l];return typeof u!="function"?u:async(...h)=>{try{return{data:await u.apply(o,h),error:null}}catch(f){if(r)throw f;return{data:null,error:f}}}}})}},u_=class extends fn{constructor(i,t={},n){const r=i.replace(/\/$/,""),o=it(it({},rs),{},{"Content-Type":"application/json"},t);super(r,o,n,"vectors")}async createIndex(i){var t=this;return t.handleOperation(async()=>await fe.post(t.fetch,`${t.url}/CreateIndex`,i,{headers:t.headers})||{})}async getIndex(i,t){var n=this;return n.handleOperation(async()=>await fe.post(n.fetch,`${n.url}/GetIndex`,{vectorBucketName:i,indexName:t},{headers:n.headers}))}async listIndexes(i){var t=this;return t.handleOperation(async()=>await fe.post(t.fetch,`${t.url}/ListIndexes`,i,{headers:t.headers}))}async deleteIndex(i,t){var n=this;return n.handleOperation(async()=>await fe.post(n.fetch,`${n.url}/DeleteIndex`,{vectorBucketName:i,indexName:t},{headers:n.headers})||{})}},c_=class extends fn{constructor(i,t={},n){const r=i.replace(/\/$/,""),o=it(it({},rs),{},{"Content-Type":"application/json"},t);super(r,o,n,"vectors")}async putVectors(i){var t=this;if(i.vectors.length<1||i.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return t.handleOperation(async()=>await fe.post(t.fetch,`${t.url}/PutVectors`,i,{headers:t.headers})||{})}async getVectors(i){var t=this;return t.handleOperation(async()=>await fe.post(t.fetch,`${t.url}/GetVectors`,i,{headers:t.headers}))}async listVectors(i){var t=this;if(i.segmentCount!==void 0){if(i.segmentCount<1||i.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(i.segmentIndex!==void 0&&(i.segmentIndex<0||i.segmentIndex>=i.segmentCount))throw new Error(`segmentIndex must be between 0 and ${i.segmentCount-1}`)}return t.handleOperation(async()=>await fe.post(t.fetch,`${t.url}/ListVectors`,i,{headers:t.headers}))}async queryVectors(i){var t=this;return t.handleOperation(async()=>await fe.post(t.fetch,`${t.url}/QueryVectors`,i,{headers:t.headers}))}async deleteVectors(i){var t=this;if(i.keys.length<1||i.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return t.handleOperation(async()=>await fe.post(t.fetch,`${t.url}/DeleteVectors`,i,{headers:t.headers})||{})}},h_=class extends fn{constructor(i,t={},n){const r=i.replace(/\/$/,""),o=it(it({},rs),{},{"Content-Type":"application/json"},t);super(r,o,n,"vectors")}async createBucket(i){var t=this;return t.handleOperation(async()=>await fe.post(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:i},{headers:t.headers})||{})}async getBucket(i){var t=this;return t.handleOperation(async()=>await fe.post(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:i},{headers:t.headers}))}async listBuckets(i={}){var t=this;return t.handleOperation(async()=>await fe.post(t.fetch,`${t.url}/ListVectorBuckets`,i,{headers:t.headers}))}async deleteBucket(i){var t=this;return t.handleOperation(async()=>await fe.post(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:i},{headers:t.headers})||{})}},d_=class extends h_{constructor(i,t={}){super(i,t.headers||{},t.fetch)}from(i){return new f_(this.url,this.headers,i,this.fetch)}async createBucket(i){var t=()=>super.createBucket,n=this;return t().call(n,i)}async getBucket(i){var t=()=>super.getBucket,n=this;return t().call(n,i)}async listBuckets(i={}){var t=()=>super.listBuckets,n=this;return t().call(n,i)}async deleteBucket(i){var t=()=>super.deleteBucket,n=this;return t().call(n,i)}},f_=class extends u_{constructor(i,t,n,r){super(i,t,r),this.vectorBucketName=n}async createIndex(i){var t=()=>super.createIndex,n=this;return t().call(n,it(it({},i),{},{vectorBucketName:n.vectorBucketName}))}async listIndexes(i={}){var t=()=>super.listIndexes,n=this;return t().call(n,it(it({},i),{},{vectorBucketName:n.vectorBucketName}))}async getIndex(i){var t=()=>super.getIndex,n=this;return t().call(n,n.vectorBucketName,i)}async deleteIndex(i){var t=()=>super.deleteIndex,n=this;return t().call(n,n.vectorBucketName,i)}index(i){return new p_(this.url,this.headers,this.vectorBucketName,i,this.fetch)}},p_=class extends c_{constructor(i,t,n,r,o){super(i,t,o),this.vectorBucketName=n,this.indexName=r}async putVectors(i){var t=()=>super.putVectors,n=this;return t().call(n,it(it({},i),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async getVectors(i){var t=()=>super.getVectors,n=this;return t().call(n,it(it({},i),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async listVectors(i={}){var t=()=>super.listVectors,n=this;return t().call(n,it(it({},i),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async queryVectors(i){var t=()=>super.queryVectors,n=this;return t().call(n,it(it({},i),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async deleteVectors(i){var t=()=>super.deleteVectors,n=this;return t().call(n,it(it({},i),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}},__=class extends a_{constructor(i,t={},n,r){super(i,t,n,r)}from(i){return new r_(this.url,this.headers,i,this.fetch)}get vectors(){return new d_(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new l_(this.url+"/iceberg",this.headers,this.fetch)}};const hc="2.95.3",nn=30*1e3,Po=3,eo=Po*nn,m_="http://localhost:9999",g_="supabase.auth.token",v_={"X-Client-Info":`gotrue-js/${hc}`},Eo="X-Supabase-Api-Version",dc={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},y_=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,w_=600*1e3;class ts extends Error{constructor(t,n,r){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function G(i){return typeof i=="object"&&i!==null&&"__isAuthError"in i}class b_ extends ts{constructor(t,n,r){super(t,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function T_(i){return G(i)&&i.name==="AuthApiError"}class Ci extends ts{constructor(t,n){super(t),this.name="AuthUnknownError",this.originalError=n}}class ii extends ts{constructor(t,n,r,o){super(t,r,o),this.name=n,this.status=r}}class ce extends ii{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function io(i){return G(i)&&i.name==="AuthSessionMissingError"}class Vi extends ii{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ds extends ii{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Bs extends ii{constructor(t,n=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function x_(i){return G(i)&&i.name==="AuthImplicitGrantRedirectError"}class Bl extends ii{constructor(t,n=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class S_ extends ii{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class ko extends ii{constructor(t,n){super(t,"AuthRetryableFetchError",n,void 0)}}function no(i){return G(i)&&i.name==="AuthRetryableFetchError"}class Ul extends ii{constructor(t,n,r){super(t,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class Oo extends ii{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Js="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),$l=` 	
\r=`.split(""),P_=(()=>{const i=new Array(128);for(let t=0;t<i.length;t+=1)i[t]=-1;for(let t=0;t<$l.length;t+=1)i[$l[t].charCodeAt(0)]=-2;for(let t=0;t<Js.length;t+=1)i[Js[t].charCodeAt(0)]=t;return i})();function zl(i,t,n){if(i!==null)for(t.queue=t.queue<<8|i,t.queuedBits+=8;t.queuedBits>=6;){const r=t.queue>>t.queuedBits-6&63;n(Js[r]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const r=t.queue>>t.queuedBits-6&63;n(Js[r]),t.queuedBits-=6}}function fc(i,t,n){const r=P_[i];if(r>-1)for(t.queue=t.queue<<6|r,t.queuedBits+=6;t.queuedBits>=8;)n(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(i)}"`)}}function Fl(i){const t=[],n=u=>{t.push(String.fromCodePoint(u))},r={utf8seq:0,codepoint:0},o={queue:0,queuedBits:0},l=u=>{O_(u,r,n)};for(let u=0;u<i.length;u+=1)fc(i.charCodeAt(u),o,l);return t.join("")}function E_(i,t){if(i<=127){t(i);return}else if(i<=2047){t(192|i>>6),t(128|i&63);return}else if(i<=65535){t(224|i>>12),t(128|i>>6&63),t(128|i&63);return}else if(i<=1114111){t(240|i>>18),t(128|i>>12&63),t(128|i>>6&63),t(128|i&63);return}throw new Error(`Unrecognized Unicode codepoint: ${i.toString(16)}`)}function k_(i,t){for(let n=0;n<i.length;n+=1){let r=i.charCodeAt(n);if(r>55295&&r<=56319){const o=(r-55296)*1024&65535;r=(i.charCodeAt(n+1)-56320&65535|o)+65536,n+=1}E_(r,t)}}function O_(i,t,n){if(t.utf8seq===0){if(i<=127){n(i);return}for(let r=1;r<6;r+=1)if((i>>7-r&1)===0){t.utf8seq=r;break}if(t.utf8seq===2)t.codepoint=i&31;else if(t.utf8seq===3)t.codepoint=i&15;else if(t.utf8seq===4)t.codepoint=i&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(i<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|i&63,t.utf8seq-=1,t.utf8seq===0&&n(t.codepoint)}}function cn(i){const t=[],n={queue:0,queuedBits:0},r=o=>{t.push(o)};for(let o=0;o<i.length;o+=1)fc(i.charCodeAt(o),n,r);return new Uint8Array(t)}function C_(i){const t=[];return k_(i,n=>t.push(n)),new Uint8Array(t)}function Ai(i){const t=[],n={queue:0,queuedBits:0},r=o=>{t.push(o)};return i.forEach(o=>zl(o,n,r)),zl(null,n,r),t.join("")}function A_(i){return Math.round(Date.now()/1e3)+i}function L_(){return Symbol("auth-callback")}const Kt=()=>typeof window<"u"&&typeof document<"u",Si={tested:!1,writable:!1},pc=()=>{if(!Kt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Si.tested)return Si.writable;const i=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(i,i),globalThis.localStorage.removeItem(i),Si.tested=!0,Si.writable=!0}catch{Si.tested=!0,Si.writable=!1}return Si.writable};function R_(i){const t={},n=new URL(i);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((o,l)=>{t[l]=o})}catch{}return n.searchParams.forEach((r,o)=>{t[o]=r}),t}const _c=i=>i?(...t)=>i(...t):(...t)=>fetch(...t),I_=i=>typeof i=="object"&&i!==null&&"status"in i&&"ok"in i&&"json"in i&&typeof i.json=="function",sn=async(i,t,n)=>{await i.setItem(t,JSON.stringify(n))},Pi=async(i,t)=>{const n=await i.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch{return n}},qt=async(i,t)=>{await i.removeItem(t)};class dr{constructor(){this.promise=new dr.promiseConstructor((t,n)=>{this.resolve=t,this.reject=n})}}dr.promiseConstructor=Promise;function Us(i){const t=i.split(".");if(t.length!==3)throw new Oo("Invalid JWT structure");for(let r=0;r<t.length;r++)if(!y_.test(t[r]))throw new Oo("JWT not in base64url format");return{header:JSON.parse(Fl(t[0])),payload:JSON.parse(Fl(t[1])),signature:cn(t[2]),raw:{header:t[0],payload:t[1]}}}async function M_(i){return await new Promise(t=>{setTimeout(()=>t(null),i)})}function N_(i,t){return new Promise((r,o)=>{(async()=>{for(let l=0;l<1/0;l++)try{const u=await i(l);if(!t(l,null,u)){r(u);return}}catch(u){if(!t(l,u)){o(u);return}}})()})}function j_(i){return("0"+i.toString(16)).substr(-2)}function D_(){const t=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let o="";for(let l=0;l<56;l++)o+=n.charAt(Math.floor(Math.random()*r));return o}return crypto.getRandomValues(t),Array.from(t,j_).join("")}async function B_(i){const n=new TextEncoder().encode(i),r=await crypto.subtle.digest("SHA-256",n),o=new Uint8Array(r);return Array.from(o).map(l=>String.fromCharCode(l)).join("")}async function U_(i){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),i;const n=await B_(i);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Gi(i,t,n=!1){const r=D_();let o=r;n&&(o+="/PASSWORD_RECOVERY"),await sn(i,`${t}-code-verifier`,o);const l=await U_(r);return[l,r===l?"plain":"s256"]}const $_=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function z_(i){const t=i.headers.get(Eo);if(!t||!t.match($_))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function F_(i){if(!i)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(i<=t)throw new Error("JWT has expired")}function Z_(i){switch(i){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const W_=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ji(i){if(!W_.test(i))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function so(){const i={};return new Proxy(i,{get:(t,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const r=n.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function H_(i,t){return new Proxy(i,{get:(n,r,o)=>{if(r==="__isInsecureUserWarningProxy")return!0;if(typeof r=="symbol"){const l=r.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)"||l==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(n,r,o)}return!t.value&&typeof r=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(n,r,o)}})}function Zl(i){return JSON.parse(JSON.stringify(i))}const ki=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),q_=[502,503,504];async function Wl(i){var t;if(!I_(i))throw new ko(ki(i),0);if(q_.includes(i.status))throw new ko(ki(i),i.status);let n;try{n=await i.json()}catch(l){throw new Ci(ki(l),l)}let r;const o=z_(i);if(o&&o.getTime()>=dc["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new Ul(ki(n),i.status,((t=n.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(r==="session_not_found")throw new ce}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((l,u)=>l&&typeof u=="string",!0))throw new Ul(ki(n),i.status,n.weak_password.reasons);throw new b_(ki(n),i.status||500,r)}const K_=(i,t,n,r)=>{const o={method:i,headers:t?.headers||{}};return i==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),o.body=JSON.stringify(r),Object.assign(Object.assign({},o),n))};async function Q(i,t,n,r){var o;const l=Object.assign({},r?.headers);l[Eo]||(l[Eo]=dc["2024-01-01"].name),r?.jwt&&(l.Authorization=`Bearer ${r.jwt}`);const u=(o=r?.query)!==null&&o!==void 0?o:{};r?.redirectTo&&(u.redirect_to=r.redirectTo);const h=Object.keys(u).length?"?"+new URLSearchParams(u).toString():"",f=await V_(i,t,n+h,{headers:l,noResolveJson:r?.noResolveJson},{},r?.body);return r?.xform?r?.xform(f):{data:Object.assign({},f),error:null}}async function V_(i,t,n,r,o,l){const u=K_(t,r,o,l);let h;try{h=await i(n,Object.assign({},u))}catch(f){throw console.error(f),new ko(ki(f),0)}if(h.ok||await Wl(h),r?.noResolveJson)return h;try{return await h.json()}catch(f){await Wl(f)}}function Pe(i){var t;let n=null;Y_(i)&&(n=Object.assign({},i),i.expires_at||(n.expires_at=A_(i.expires_in)));const r=(t=i.user)!==null&&t!==void 0?t:i;return{data:{session:n,user:r},error:null}}function Hl(i){const t=Pe(i);return!t.error&&i.weak_password&&typeof i.weak_password=="object"&&Array.isArray(i.weak_password.reasons)&&i.weak_password.reasons.length&&i.weak_password.message&&typeof i.weak_password.message=="string"&&i.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(t.data.weak_password=i.weak_password),t}function hi(i){var t;return{data:{user:(t=i.user)!==null&&t!==void 0?t:i},error:null}}function G_(i){return{data:i,error:null}}function J_(i){const{action_link:t,email_otp:n,hashed_token:r,redirect_to:o,verification_type:l}=i,u=ur(i,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),h={action_link:t,email_otp:n,hashed_token:r,redirect_to:o,verification_type:l},f=Object.assign({},u);return{data:{properties:h,user:f},error:null}}function ql(i){return i}function Y_(i){return i.access_token&&i.refresh_token&&i.expires_in}const ro=["global","local","others"];class X_{constructor({url:t="",headers:n={},fetch:r}){this.url=t,this.headers=n,this.fetch=_c(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,n=ro[0]){if(ro.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${ro.join(", ")}`);try{return await Q(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(r){if(G(r))return{data:null,error:r};throw r}}async inviteUserByEmail(t,n={}){try{return await Q(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:hi})}catch(r){if(G(r))return{data:{user:null},error:r};throw r}}async generateLink(t){try{const{options:n}=t,r=ur(t,["options"]),o=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(o.new_email=r?.newEmail,delete o.newEmail),await Q(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:o,headers:this.headers,xform:J_,redirectTo:n?.redirectTo})}catch(n){if(G(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(t){try{return await Q(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:hi})}catch(n){if(G(n))return{data:{user:null},error:n};throw n}}async listUsers(t){var n,r,o,l,u,h,f;try{const p={nextPage:null,lastPage:0,total:0},m=await Q(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=t?.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(l=(o=t?.perPage)===null||o===void 0?void 0:o.toString())!==null&&l!==void 0?l:""},xform:ql});if(m.error)throw m.error;const g=await m.json(),w=(u=m.headers.get("x-total-count"))!==null&&u!==void 0?u:0,b=(f=(h=m.headers.get("link"))===null||h===void 0?void 0:h.split(","))!==null&&f!==void 0?f:[];return b.length>0&&(b.forEach(S=>{const P=parseInt(S.split(";")[0].split("=")[1].substring(0,1)),B=JSON.parse(S.split(";")[1].split("=")[1]);p[`${B}Page`]=P}),p.total=parseInt(w)),{data:Object.assign(Object.assign({},g),p),error:null}}catch(p){if(G(p))return{data:{users:[]},error:p};throw p}}async getUserById(t){Ji(t);try{return await Q(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:hi})}catch(n){if(G(n))return{data:{user:null},error:n};throw n}}async updateUserById(t,n){Ji(t);try{return await Q(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:n,headers:this.headers,xform:hi})}catch(r){if(G(r))return{data:{user:null},error:r};throw r}}async deleteUser(t,n=!1){Ji(t);try{return await Q(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:n},xform:hi})}catch(r){if(G(r))return{data:{user:null},error:r};throw r}}async _listFactors(t){Ji(t.userId);try{const{data:n,error:r}=await Q(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:o=>({data:{factors:o},error:null})});return{data:n,error:r}}catch(n){if(G(n))return{data:null,error:n};throw n}}async _deleteFactor(t){Ji(t.userId),Ji(t.id);try{return{data:await Q(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(n){if(G(n))return{data:null,error:n};throw n}}async _listOAuthClients(t){var n,r,o,l,u,h,f;try{const p={nextPage:null,lastPage:0,total:0},m=await Q(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=t?.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(l=(o=t?.perPage)===null||o===void 0?void 0:o.toString())!==null&&l!==void 0?l:""},xform:ql});if(m.error)throw m.error;const g=await m.json(),w=(u=m.headers.get("x-total-count"))!==null&&u!==void 0?u:0,b=(f=(h=m.headers.get("link"))===null||h===void 0?void 0:h.split(","))!==null&&f!==void 0?f:[];return b.length>0&&(b.forEach(S=>{const P=parseInt(S.split(";")[0].split("=")[1].substring(0,1)),B=JSON.parse(S.split(";")[1].split("=")[1]);p[`${B}Page`]=P}),p.total=parseInt(w)),{data:Object.assign(Object.assign({},g),p),error:null}}catch(p){if(G(p))return{data:{clients:[]},error:p};throw p}}async _createOAuthClient(t){try{return await Q(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(G(n))return{data:null,error:n};throw n}}async _getOAuthClient(t){try{return await Q(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(G(n))return{data:null,error:n};throw n}}async _updateOAuthClient(t,n){try{return await Q(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:n,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(G(r))return{data:null,error:r};throw r}}async _deleteOAuthClient(t){try{return await Q(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(n){if(G(n))return{data:null,error:n};throw n}}async _regenerateOAuthClientSecret(t){try{return await Q(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(G(n))return{data:null,error:n};throw n}}}function Kl(i={}){return{getItem:t=>i[t]||null,setItem:(t,n)=>{i[t]=n},removeItem:t=>{delete i[t]}}}const Yi={debug:!!(globalThis&&pc()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class mc extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class Q_ extends mc{}async function tm(i,t,n){Yi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",i,t);const r=new globalThis.AbortController;return t>0&&setTimeout(()=>{r.abort(),Yi.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",i)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(i,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async o=>{if(o){Yi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",i,o.name);try{return await n()}finally{Yi.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",i,o.name)}}else{if(t===0)throw Yi.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",i),new Q_(`Acquiring an exclusive Navigator LockManager lock "${i}" immediately failed`);if(Yi.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}function em(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function gc(i){if(!/^0x[a-fA-F0-9]{40}$/.test(i))throw new Error(`@supabase/auth-js: Address "${i}" is invalid.`);return i.toLowerCase()}function im(i){return parseInt(i,16)}function nm(i){const t=new TextEncoder().encode(i);return"0x"+Array.from(t,r=>r.toString(16).padStart(2,"0")).join("")}function sm(i){var t;const{chainId:n,domain:r,expirationTime:o,issuedAt:l=new Date,nonce:u,notBefore:h,requestId:f,resources:p,scheme:m,uri:g,version:w}=i;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!r)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(u&&u.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${u}`);if(!g)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(w!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${w}`);if(!((t=i.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${i.statement}`)}const b=gc(i.address),S=m?`${m}://${r}`:r,P=i.statement?`${i.statement}
`:"",B=`${S} wants you to sign in with your Ethereum account:
${b}

${P}`;let j=`URI: ${g}
Version: ${w}
Chain ID: ${n}${u?`
Nonce: ${u}`:""}
Issued At: ${l.toISOString()}`;if(o&&(j+=`
Expiration Time: ${o.toISOString()}`),h&&(j+=`
Not Before: ${h.toISOString()}`),f&&(j+=`
Request ID: ${f}`),p){let U=`
Resources:`;for(const O of p){if(!O||typeof O!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${O}`);U+=`
- ${O}`}j+=U}return`${B}
${j}`}class Dt extends Error{constructor({message:t,code:n,cause:r,name:o}){var l;super(t,{cause:r}),this.__isWebAuthnError=!0,this.name=(l=o??(r instanceof Error?r.name:void 0))!==null&&l!==void 0?l:"Unknown Error",this.code=n}}class Ys extends Dt{constructor(t,n){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n,message:t}),this.name="WebAuthnUnknownError",this.originalError=n}}function rm({error:i,options:t}){var n,r,o;const{publicKey:l}=t;if(!l)throw Error("options was missing required publicKey property");if(i.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Dt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:i})}else if(i.name==="ConstraintError"){if(((n=l.authenticatorSelection)===null||n===void 0?void 0:n.requireResidentKey)===!0)return new Dt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:i});if(t.mediation==="conditional"&&((r=l.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new Dt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:i});if(((o=l.authenticatorSelection)===null||o===void 0?void 0:o.userVerification)==="required")return new Dt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:i})}else{if(i.name==="InvalidStateError")return new Dt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:i});if(i.name==="NotAllowedError")return new Dt({message:i.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:i});if(i.name==="NotSupportedError")return l.pubKeyCredParams.filter(h=>h.type==="public-key").length===0?new Dt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:i}):new Dt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:i});if(i.name==="SecurityError"){const u=window.location.hostname;if(vc(u)){if(l.rp.id!==u)return new Dt({message:`The RP ID "${l.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:i})}else return new Dt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:i})}else if(i.name==="TypeError"){if(l.user.id.byteLength<1||l.user.id.byteLength>64)return new Dt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:i})}else if(i.name==="UnknownError")return new Dt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:i})}return new Dt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:i})}function om({error:i,options:t}){const{publicKey:n}=t;if(!n)throw Error("options was missing required publicKey property");if(i.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Dt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:i})}else{if(i.name==="NotAllowedError")return new Dt({message:i.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:i});if(i.name==="SecurityError"){const r=window.location.hostname;if(vc(r)){if(n.rpId!==r)return new Dt({message:`The RP ID "${n.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:i})}else return new Dt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:i})}else if(i.name==="UnknownError")return new Dt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:i})}return new Dt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:i})}class am{createNewAbortSignal(){if(this.controller){const n=new Error("Cancelling existing WebAuthn API call for new one");n.name="AbortError",this.controller.abort(n)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const lm=new am;function um(i){if(!i)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(i);const{challenge:t,user:n,excludeCredentials:r}=i,o=ur(i,["challenge","user","excludeCredentials"]),l=cn(t).buffer,u=Object.assign(Object.assign({},n),{id:cn(n.id).buffer}),h=Object.assign(Object.assign({},o),{challenge:l,user:u});if(r&&r.length>0){h.excludeCredentials=new Array(r.length);for(let f=0;f<r.length;f++){const p=r[f];h.excludeCredentials[f]=Object.assign(Object.assign({},p),{id:cn(p.id).buffer,type:p.type||"public-key",transports:p.transports})}}return h}function cm(i){if(!i)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(i);const{challenge:t,allowCredentials:n}=i,r=ur(i,["challenge","allowCredentials"]),o=cn(t).buffer,l=Object.assign(Object.assign({},r),{challenge:o});if(n&&n.length>0){l.allowCredentials=new Array(n.length);for(let u=0;u<n.length;u++){const h=n[u];l.allowCredentials[u]=Object.assign(Object.assign({},h),{id:cn(h.id).buffer,type:h.type||"public-key",transports:h.transports})}}return l}function hm(i){var t;if("toJSON"in i&&typeof i.toJSON=="function")return i.toJSON();const n=i;return{id:i.id,rawId:i.id,response:{attestationObject:Ai(new Uint8Array(i.response.attestationObject)),clientDataJSON:Ai(new Uint8Array(i.response.clientDataJSON))},type:"public-key",clientExtensionResults:i.getClientExtensionResults(),authenticatorAttachment:(t=n.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function dm(i){var t;if("toJSON"in i&&typeof i.toJSON=="function")return i.toJSON();const n=i,r=i.getClientExtensionResults(),o=i.response;return{id:i.id,rawId:i.id,response:{authenticatorData:Ai(new Uint8Array(o.authenticatorData)),clientDataJSON:Ai(new Uint8Array(o.clientDataJSON)),signature:Ai(new Uint8Array(o.signature)),userHandle:o.userHandle?Ai(new Uint8Array(o.userHandle)):void 0},type:"public-key",clientExtensionResults:r,authenticatorAttachment:(t=n.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function vc(i){return i==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(i)}function Vl(){var i,t;return!!(Kt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((i=navigator?.credentials)===null||i===void 0?void 0:i.create)=="function"&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.get)=="function")}async function fm(i){try{const t=await navigator.credentials.create(i);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Ys("Browser returned unexpected credential type",t)}:{data:null,error:new Ys("Empty credential response",t)}}catch(t){return{data:null,error:rm({error:t,options:i})}}}async function pm(i){try{const t=await navigator.credentials.get(i);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Ys("Browser returned unexpected credential type",t)}:{data:null,error:new Ys("Empty credential response",t)}}catch(t){return{data:null,error:om({error:t,options:i})}}}const _m={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},mm={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Xs(...i){const t=o=>o!==null&&typeof o=="object"&&!Array.isArray(o),n=o=>o instanceof ArrayBuffer||ArrayBuffer.isView(o),r={};for(const o of i)if(o)for(const l in o){const u=o[l];if(u!==void 0)if(Array.isArray(u))r[l]=u;else if(n(u))r[l]=u;else if(t(u)){const h=r[l];t(h)?r[l]=Xs(h,u):r[l]=Xs(u)}else r[l]=u}return r}function gm(i,t){return Xs(_m,i,t||{})}function vm(i,t){return Xs(mm,i,t||{})}class ym{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:n,friendlyName:r,signal:o},l){var u;try{const{data:h,error:f}=await this.client.mfa.challenge({factorId:t,webauthn:n});if(!h)return{data:null,error:f};const p=o??lm.createNewAbortSignal();if(h.webauthn.type==="create"){const{user:m}=h.webauthn.credential_options.publicKey;if(!m.name){const g=r;if(g)m.name=`${m.id}:${g}`;else{const b=(await this.client.getUser()).data.user,S=((u=b?.user_metadata)===null||u===void 0?void 0:u.name)||b?.email||b?.id||"User";m.name=`${m.id}:${S}`}}m.displayName||(m.displayName=m.name)}switch(h.webauthn.type){case"create":{const m=gm(h.webauthn.credential_options.publicKey,l?.create),{data:g,error:w}=await fm({publicKey:m,signal:p});return g?{data:{factorId:t,challengeId:h.id,webauthn:{type:h.webauthn.type,credential_response:g}},error:null}:{data:null,error:w}}case"request":{const m=vm(h.webauthn.credential_options.publicKey,l?.request),{data:g,error:w}=await pm(Object.assign(Object.assign({},h.webauthn.credential_options),{publicKey:m,signal:p}));return g?{data:{factorId:t,challengeId:h.id,webauthn:{type:h.webauthn.type,credential_response:g}},error:null}:{data:null,error:w}}}}catch(h){return G(h)?{data:null,error:h}:{data:null,error:new Ci("Unexpected error in challenge",h)}}}async _verify({challengeId:t,factorId:n,webauthn:r}){return this.client.mfa.verify({factorId:n,challengeId:t,webauthn:r})}async _authenticate({factorId:t,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:o}={}},l){if(!n)return{data:null,error:new ts("rpId is required for WebAuthn authentication")};try{if(!Vl())return{data:null,error:new Ci("Browser does not support WebAuthn",null)};const{data:u,error:h}=await this.challenge({factorId:t,webauthn:{rpId:n,rpOrigins:r},signal:o},{request:l});if(!u)return{data:null,error:h};const{webauthn:f}=u;return this._verify({factorId:t,challengeId:u.challengeId,webauthn:{type:f.type,rpId:n,rpOrigins:r,credential_response:f.credential_response}})}catch(u){return G(u)?{data:null,error:u}:{data:null,error:new Ci("Unexpected error in authenticate",u)}}}async _register({friendlyName:t,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:o}={}},l){if(!n)return{data:null,error:new ts("rpId is required for WebAuthn registration")};try{if(!Vl())return{data:null,error:new Ci("Browser does not support WebAuthn",null)};const{data:u,error:h}=await this._enroll({friendlyName:t});if(!u)return await this.client.mfa.listFactors().then(m=>{var g;return(g=m.data)===null||g===void 0?void 0:g.all.find(w=>w.factor_type==="webauthn"&&w.friendly_name===t&&w.status!=="unverified")}).then(m=>m?this.client.mfa.unenroll({factorId:m?.id}):void 0),{data:null,error:h};const{data:f,error:p}=await this._challenge({factorId:u.id,friendlyName:u.friendly_name,webauthn:{rpId:n,rpOrigins:r},signal:o},{create:l});return f?this._verify({factorId:u.id,challengeId:f.challengeId,webauthn:{rpId:n,rpOrigins:r,type:f.webauthn.type,credential_response:f.webauthn.credential_response}}):{data:null,error:p}}catch(u){return G(u)?{data:null,error:u}:{data:null,error:new Ci("Unexpected error in register",u)}}}}em();const wm={url:m_,storageKey:g_,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:v_,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function Gl(i,t,n){return await n()}const Xi={};class es{get jwks(){var t,n;return(n=(t=Xi[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(t){Xi[this.storageKey]=Object.assign(Object.assign({},Xi[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,n;return(n=(t=Xi[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Xi[this.storageKey]=Object.assign(Object.assign({},Xi[this.storageKey]),{cachedAt:t})}constructor(t){var n,r,o;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const l=Object.assign(Object.assign({},wm),t);if(this.storageKey=l.storageKey,this.instanceID=(n=es.nextInstanceID[this.storageKey])!==null&&n!==void 0?n:0,es.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!l.debug,typeof l.debug=="function"&&(this.logger=l.debug),this.instanceID>0&&Kt()){const u=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(u),this.logDebugMessages&&console.trace(u)}if(this.persistSession=l.persistSession,this.autoRefreshToken=l.autoRefreshToken,this.admin=new X_({url:l.url,headers:l.headers,fetch:l.fetch}),this.url=l.url,this.headers=l.headers,this.fetch=_c(l.fetch),this.lock=l.lock||Gl,this.detectSessionInUrl=l.detectSessionInUrl,this.flowType=l.flowType,this.hasCustomAuthorizationHeader=l.hasCustomAuthorizationHeader,this.throwOnError=l.throwOnError,this.lockAcquireTimeout=l.lockAcquireTimeout,l.lock?this.lock=l.lock:this.persistSession&&Kt()&&(!((r=globalThis?.navigator)===null||r===void 0)&&r.locks)?this.lock=tm:this.lock=Gl,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new ym(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(l.storage?this.storage=l.storage:pc()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Kl(this.memoryStorage)),l.userStorage&&(this.userStorage=l.userStorage)):(this.memoryStorage={},this.storage=Kl(this.memoryStorage)),Kt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(u){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",u)}(o=this.broadcastChannel)===null||o===void 0||o.addEventListener("message",async u=>{this._debug("received broadcast notification from other tab or client",u);try{await this._notifyAllSubscribers(u.data.event,u.data.session,!1)}catch(h){this._debug("#broadcastChannel","error",h)}})}this.initialize().catch(u=>{this._debug("#initialize()","error",u)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${hc}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let n={},r="none";if(Kt()&&(n=R_(window.location.href),this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce")),Kt()&&this.detectSessionInUrl&&r!=="none"){const{data:o,error:l}=await this._getSessionFromURL(n,r);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),x_(l)){const f=(t=l.details)===null||t===void 0?void 0:t.code;if(f==="identity_already_exists"||f==="identity_not_found"||f==="single_identity_not_deletable")return{error:l}}return{error:l}}const{session:u,redirectType:h}=o;return this._debug("#_initialize()","detected session in URL",u,"redirect type",h),await this._saveSession(u),setTimeout(async()=>{h==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",u):await this._notifyAllSubscribers("SIGNED_IN",u)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return G(n)?this._returnResult({error:n}):this._returnResult({error:new Ci("Unexpected error during initialization",n)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var n,r,o;try{const l=await Q(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=t?.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(o=t?.options)===null||o===void 0?void 0:o.captchaToken}},xform:Pe}),{data:u,error:h}=l;if(h||!u)return this._returnResult({data:{user:null,session:null},error:h});const f=u.session,p=u.user;return u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",f)),this._returnResult({data:{user:p,session:f},error:null})}catch(l){if(G(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signUp(t){var n,r,o;try{let l;if("email"in t){const{email:m,password:g,options:w}=t;let b=null,S=null;this.flowType==="pkce"&&([b,S]=await Gi(this.storage,this.storageKey)),l=await Q(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:w?.emailRedirectTo,body:{email:m,password:g,data:(n=w?.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:w?.captchaToken},code_challenge:b,code_challenge_method:S},xform:Pe})}else if("phone"in t){const{phone:m,password:g,options:w}=t;l=await Q(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:m,password:g,data:(r=w?.data)!==null&&r!==void 0?r:{},channel:(o=w?.channel)!==null&&o!==void 0?o:"sms",gotrue_meta_security:{captcha_token:w?.captchaToken}},xform:Pe})}else throw new Ds("You must provide either an email or phone number and a password");const{data:u,error:h}=l;if(h||!u)return await qt(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:h});const f=u.session,p=u.user;return u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",f)),this._returnResult({data:{user:p,session:f},error:null})}catch(l){if(await qt(this.storage,`${this.storageKey}-code-verifier`),G(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signInWithPassword(t){try{let n;if("email"in t){const{email:l,password:u,options:h}=t;n=await Q(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:u,gotrue_meta_security:{captcha_token:h?.captchaToken}},xform:Hl})}else if("phone"in t){const{phone:l,password:u,options:h}=t;n=await Q(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:u,gotrue_meta_security:{captcha_token:h?.captchaToken}},xform:Hl})}else throw new Ds("You must provide either an email or phone number and a password");const{data:r,error:o}=n;if(o)return this._returnResult({data:{user:null,session:null},error:o});if(!r||!r.session||!r.user){const l=new Vi;return this._returnResult({data:{user:null,session:null},error:l})}return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),this._returnResult({data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:o})}catch(n){if(G(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOAuth(t){var n,r,o,l;return await this._handleProviderSignIn(t.provider,{redirectTo:(n=t.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=t.options)===null||r===void 0?void 0:r.scopes,queryParams:(o=t.options)===null||o===void 0?void 0:o.queryParams,skipBrowserRedirect:(l=t.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:n}=t;switch(n){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(t){var n,r,o,l,u,h,f,p,m,g,w;let b,S;if("message"in t)b=t.message,S=t.signature;else{const{chain:P,wallet:B,statement:j,options:U}=t;let O;if(Kt())if(typeof B=="object")O=B;else{const Lt=window;if("ethereum"in Lt&&typeof Lt.ethereum=="object"&&"request"in Lt.ethereum&&typeof Lt.ethereum.request=="function")O=Lt.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof B!="object"||!U?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");O=B}const k=new URL((n=U?.url)!==null&&n!==void 0?n:window.location.href),H=await O.request({method:"eth_requestAccounts"}).then(Lt=>Lt).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!H||H.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const A=gc(H[0]);let V=(r=U?.signInWithEthereum)===null||r===void 0?void 0:r.chainId;if(!V){const Lt=await O.request({method:"eth_chainId"});V=im(Lt)}const _t={domain:k.host,address:A,statement:j,uri:k.href,version:"1",chainId:V,nonce:(o=U?.signInWithEthereum)===null||o===void 0?void 0:o.nonce,issuedAt:(u=(l=U?.signInWithEthereum)===null||l===void 0?void 0:l.issuedAt)!==null&&u!==void 0?u:new Date,expirationTime:(h=U?.signInWithEthereum)===null||h===void 0?void 0:h.expirationTime,notBefore:(f=U?.signInWithEthereum)===null||f===void 0?void 0:f.notBefore,requestId:(p=U?.signInWithEthereum)===null||p===void 0?void 0:p.requestId,resources:(m=U?.signInWithEthereum)===null||m===void 0?void 0:m.resources};b=sm(_t),S=await O.request({method:"personal_sign",params:[nm(b),A]})}try{const{data:P,error:B}=await Q(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:b,signature:S},!((g=t.options)===null||g===void 0)&&g.captchaToken?{gotrue_meta_security:{captcha_token:(w=t.options)===null||w===void 0?void 0:w.captchaToken}}:null),xform:Pe});if(B)throw B;if(!P||!P.session||!P.user){const j=new Vi;return this._returnResult({data:{user:null,session:null},error:j})}return P.session&&(await this._saveSession(P.session),await this._notifyAllSubscribers("SIGNED_IN",P.session)),this._returnResult({data:Object.assign({},P),error:B})}catch(P){if(G(P))return this._returnResult({data:{user:null,session:null},error:P});throw P}}async signInWithSolana(t){var n,r,o,l,u,h,f,p,m,g,w,b;let S,P;if("message"in t)S=t.message,P=t.signature;else{const{chain:B,wallet:j,statement:U,options:O}=t;let k;if(Kt())if(typeof j=="object")k=j;else{const A=window;if("solana"in A&&typeof A.solana=="object"&&("signIn"in A.solana&&typeof A.solana.signIn=="function"||"signMessage"in A.solana&&typeof A.solana.signMessage=="function"))k=A.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof j!="object"||!O?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");k=j}const H=new URL((n=O?.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in k&&k.signIn){const A=await k.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},O?.signInWithSolana),{version:"1",domain:H.host,uri:H.href}),U?{statement:U}:null));let V;if(Array.isArray(A)&&A[0]&&typeof A[0]=="object")V=A[0];else if(A&&typeof A=="object"&&"signedMessage"in A&&"signature"in A)V=A;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in V&&"signature"in V&&(typeof V.signedMessage=="string"||V.signedMessage instanceof Uint8Array)&&V.signature instanceof Uint8Array)S=typeof V.signedMessage=="string"?V.signedMessage:new TextDecoder().decode(V.signedMessage),P=V.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in k)||typeof k.signMessage!="function"||!("publicKey"in k)||typeof k!="object"||!k.publicKey||!("toBase58"in k.publicKey)||typeof k.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");S=[`${H.host} wants you to sign in with your Solana account:`,k.publicKey.toBase58(),...U?["",U,""]:[""],"Version: 1",`URI: ${H.href}`,`Issued At: ${(o=(r=O?.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&o!==void 0?o:new Date().toISOString()}`,...!((l=O?.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${O.signInWithSolana.notBefore}`]:[],...!((u=O?.signInWithSolana)===null||u===void 0)&&u.expirationTime?[`Expiration Time: ${O.signInWithSolana.expirationTime}`]:[],...!((h=O?.signInWithSolana)===null||h===void 0)&&h.chainId?[`Chain ID: ${O.signInWithSolana.chainId}`]:[],...!((f=O?.signInWithSolana)===null||f===void 0)&&f.nonce?[`Nonce: ${O.signInWithSolana.nonce}`]:[],...!((p=O?.signInWithSolana)===null||p===void 0)&&p.requestId?[`Request ID: ${O.signInWithSolana.requestId}`]:[],...!((g=(m=O?.signInWithSolana)===null||m===void 0?void 0:m.resources)===null||g===void 0)&&g.length?["Resources",...O.signInWithSolana.resources.map(V=>`- ${V}`)]:[]].join(`
`);const A=await k.signMessage(new TextEncoder().encode(S),"utf8");if(!A||!(A instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");P=A}}try{const{data:B,error:j}=await Q(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:S,signature:Ai(P)},!((w=t.options)===null||w===void 0)&&w.captchaToken?{gotrue_meta_security:{captcha_token:(b=t.options)===null||b===void 0?void 0:b.captchaToken}}:null),xform:Pe});if(j)throw j;if(!B||!B.session||!B.user){const U=new Vi;return this._returnResult({data:{user:null,session:null},error:U})}return B.session&&(await this._saveSession(B.session),await this._notifyAllSubscribers("SIGNED_IN",B.session)),this._returnResult({data:Object.assign({},B),error:j})}catch(B){if(G(B))return this._returnResult({data:{user:null,session:null},error:B});throw B}}async _exchangeCodeForSession(t){const n=await Pi(this.storage,`${this.storageKey}-code-verifier`),[r,o]=(n??"").split("/");try{if(!r&&this.flowType==="pkce")throw new S_;const{data:l,error:u}=await Q(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:r},xform:Pe});if(await qt(this.storage,`${this.storageKey}-code-verifier`),u)throw u;if(!l||!l.session||!l.user){const h=new Vi;return this._returnResult({data:{user:null,session:null,redirectType:null},error:h})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign(Object.assign({},l),{redirectType:o??null}),error:u})}catch(l){if(await qt(this.storage,`${this.storageKey}-code-verifier`),G(l))return this._returnResult({data:{user:null,session:null,redirectType:null},error:l});throw l}}async signInWithIdToken(t){try{const{options:n,provider:r,token:o,access_token:l,nonce:u}=t,h=await Q(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:o,access_token:l,nonce:u,gotrue_meta_security:{captcha_token:n?.captchaToken}},xform:Pe}),{data:f,error:p}=h;if(p)return this._returnResult({data:{user:null,session:null},error:p});if(!f||!f.session||!f.user){const m=new Vi;return this._returnResult({data:{user:null,session:null},error:m})}return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",f.session)),this._returnResult({data:f,error:p})}catch(n){if(G(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOtp(t){var n,r,o,l,u;try{if("email"in t){const{email:h,options:f}=t;let p=null,m=null;this.flowType==="pkce"&&([p,m]=await Gi(this.storage,this.storageKey));const{error:g}=await Q(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:h,data:(n=f?.data)!==null&&n!==void 0?n:{},create_user:(r=f?.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:f?.captchaToken},code_challenge:p,code_challenge_method:m},redirectTo:f?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:g})}if("phone"in t){const{phone:h,options:f}=t,{data:p,error:m}=await Q(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:h,data:(o=f?.data)!==null&&o!==void 0?o:{},create_user:(l=f?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:f?.captchaToken},channel:(u=f?.channel)!==null&&u!==void 0?u:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:p?.message_id},error:m})}throw new Ds("You must provide either an email or phone number.")}catch(h){if(await qt(this.storage,`${this.storageKey}-code-verifier`),G(h))return this._returnResult({data:{user:null,session:null},error:h});throw h}}async verifyOtp(t){var n,r;try{let o,l;"options"in t&&(o=(n=t.options)===null||n===void 0?void 0:n.redirectTo,l=(r=t.options)===null||r===void 0?void 0:r.captchaToken);const{data:u,error:h}=await Q(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:l}}),redirectTo:o,xform:Pe});if(h)throw h;if(!u)throw new Error("An error occurred on token verification.");const f=u.session,p=u.user;return f?.access_token&&(await this._saveSession(f),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",f)),this._returnResult({data:{user:p,session:f},error:null})}catch(o){if(G(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signInWithSSO(t){var n,r,o,l,u;try{let h=null,f=null;this.flowType==="pkce"&&([h,f]=await Gi(this.storage,this.storageKey));const p=await Q(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(r=(n=t.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((o=t?.options)===null||o===void 0)&&o.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:h,code_challenge_method:f}),headers:this.headers,xform:G_});return!((l=p.data)===null||l===void 0)&&l.url&&Kt()&&!(!((u=t.options)===null||u===void 0)&&u.skipBrowserRedirect)&&window.location.assign(p.data.url),this._returnResult(p)}catch(h){if(await qt(this.storage,`${this.storageKey}-code-verifier`),G(h))return this._returnResult({data:null,error:h});throw h}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:n},error:r}=t;if(r)throw r;if(!n)throw new ce;const{error:o}=await Q(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return this._returnResult({data:{user:null,session:null},error:o})})}catch(t){if(G(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const n=`${this.url}/resend`;if("email"in t){const{email:r,type:o,options:l}=t,{error:u}=await Q(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:o,gotrue_meta_security:{captcha_token:l?.captchaToken}},redirectTo:l?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:u})}else if("phone"in t){const{phone:r,type:o,options:l}=t,{data:u,error:h}=await Q(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:o,gotrue_meta_security:{captcha_token:l?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:u?.message_id},error:h})}throw new Ds("You must provide either an email or phone number and a type")}catch(n){if(G(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async n=>n))}async _acquireLock(t,n){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),o=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await o}catch{}})()),o}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const o=[...this.pendingInLock];await Promise.all(o),this.pendingInLock.splice(0,o.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await t(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const n=await Pi(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?t=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const r=t.expires_at?t.expires_at*1e3-Date.now()<eo:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",t.expires_at),!r){if(this.userStorage){const u=await Pi(this.userStorage,this.storageKey+"-user");u?.user?t.user=u.user:t.user=so()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const u={value:this.suppressGetSessionWarning};t.user=H_(t.user,u),u.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:o,error:l}=await this._callRefreshToken(t.refresh_token);return l?this._returnResult({data:{session:null},error:l}):this._returnResult({data:{session:o},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const n=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return n.data.user&&(this.suppressGetSessionWarning=!0),n}async _getUser(t){try{return t?await Q(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:hi}):await this._useSession(async n=>{var r,o,l;const{data:u,error:h}=n;if(h)throw h;return!(!((r=u.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ce}:await Q(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(o=u.session)===null||o===void 0?void 0:o.access_token)!==null&&l!==void 0?l:void 0,xform:hi})})}catch(n){if(G(n))return io(n)&&(await this._removeSession(),await qt(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:n});throw n}}async updateUser(t,n={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(t,n))}async _updateUser(t,n={}){try{return await this._useSession(async r=>{const{data:o,error:l}=r;if(l)throw l;if(!o.session)throw new ce;const u=o.session;let h=null,f=null;this.flowType==="pkce"&&t.email!=null&&([h,f]=await Gi(this.storage,this.storageKey));const{data:p,error:m}=await Q(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:h,code_challenge_method:f}),jwt:u.access_token,xform:hi});if(m)throw m;return u.user=p.user,await this._saveSession(u),await this._notifyAllSubscribers("USER_UPDATED",u),this._returnResult({data:{user:u.user},error:null})})}catch(r){if(await qt(this.storage,`${this.storageKey}-code-verifier`),G(r))return this._returnResult({data:{user:null},error:r});throw r}}async setSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new ce;const n=Date.now()/1e3;let r=n,o=!0,l=null;const{payload:u}=Us(t.access_token);if(u.exp&&(r=u.exp,o=r<=n),o){const{data:h,error:f}=await this._callRefreshToken(t.refresh_token);if(f)return this._returnResult({data:{user:null,session:null},error:f});if(!h)return{data:{user:null,session:null},error:null};l=h}else{const{data:h,error:f}=await this._getUser(t.access_token);if(f)return this._returnResult({data:{user:null,session:null},error:f});l={access_token:t.access_token,refresh_token:t.refresh_token,user:h.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return this._returnResult({data:{user:l.user,session:l},error:null})}catch(n){if(G(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async n=>{var r;if(!t){const{data:u,error:h}=n;if(h)throw h;t=(r=u.session)!==null&&r!==void 0?r:void 0}if(!t?.refresh_token)throw new ce;const{data:o,error:l}=await this._callRefreshToken(t.refresh_token);return l?this._returnResult({data:{user:null,session:null},error:l}):o?this._returnResult({data:{user:o.user,session:o},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(n){if(G(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async _getSessionFromURL(t,n){try{if(!Kt())throw new Bs("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Bs(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new Bl("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Bs("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Bl("No code detected.");const{data:U,error:O}=await this._exchangeCodeForSession(t.code);if(O)throw O;const k=new URL(window.location.href);return k.searchParams.delete("code"),window.history.replaceState(window.history.state,"",k.toString()),{data:{session:U.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:o,access_token:l,refresh_token:u,expires_in:h,expires_at:f,token_type:p}=t;if(!l||!h||!u||!p)throw new Bs("No session defined in URL");const m=Math.round(Date.now()/1e3),g=parseInt(h);let w=m+g;f&&(w=parseInt(f));const b=w-m;b*1e3<=nn&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${b}s, should have been closer to ${g}s`);const S=w-g;m-S>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",S,w,m):m-S<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",S,w,m);const{data:P,error:B}=await this._getUser(l);if(B)throw B;const j={provider_token:r,provider_refresh_token:o,access_token:l,expires_in:g,expires_at:w,refresh_token:u,token_type:p,user:P.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:j,redirectType:t.type},error:null})}catch(r){if(G(r))return this._returnResult({data:{session:null,redirectType:null},error:r});throw r}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const n=await Pi(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&n)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:o,error:l}=n;if(l&&!io(l))return this._returnResult({error:l});const u=(r=o.session)===null||r===void 0?void 0:r.access_token;if(u){const{error:h}=await this.admin.signOut(u,t);if(h&&!(T_(h)&&(h.status===404||h.status===401||h.status===403)||io(h)))return this._returnResult({error:h})}return t!=="others"&&(await this._removeSession(),await qt(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const n=L_(),r={id:n,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(t){return await this._useSession(async n=>{var r,o;try{const{data:{session:l},error:u}=n;if(u)throw u;await((r=this.stateChangeEmitters.get(t))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",t,"session",l)}catch(l){await((o=this.stateChangeEmitters.get(t))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",l),console.error(l)}})}async resetPasswordForEmail(t,n={}){let r=null,o=null;this.flowType==="pkce"&&([r,o]=await Gi(this.storage,this.storageKey,!0));try{return await Q(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:r,code_challenge_method:o,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(l){if(await qt(this.storage,`${this.storageKey}-code-verifier`),G(l))return this._returnResult({data:null,error:l});throw l}}async getUserIdentities(){var t;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return this._returnResult({data:{identities:(t=n.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(n){if(G(n))return this._returnResult({data:null,error:n});throw n}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var n;try{const{data:r,error:o}=await this._useSession(async l=>{var u,h,f,p,m;const{data:g,error:w}=l;if(w)throw w;const b=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(u=t.options)===null||u===void 0?void 0:u.redirectTo,scopes:(h=t.options)===null||h===void 0?void 0:h.scopes,queryParams:(f=t.options)===null||f===void 0?void 0:f.queryParams,skipBrowserRedirect:!0});return await Q(this.fetch,"GET",b,{headers:this.headers,jwt:(m=(p=g.session)===null||p===void 0?void 0:p.access_token)!==null&&m!==void 0?m:void 0})});if(o)throw o;return Kt()&&!(!((n=t.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r?.url),this._returnResult({data:{provider:t.provider,url:r?.url},error:null})}catch(r){if(G(r))return this._returnResult({data:{provider:t.provider,url:null},error:r});throw r}}async linkIdentityIdToken(t){return await this._useSession(async n=>{var r;try{const{error:o,data:{session:l}}=n;if(o)throw o;const{options:u,provider:h,token:f,access_token:p,nonce:m}=t,g=await Q(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(r=l?.access_token)!==null&&r!==void 0?r:void 0,body:{provider:h,id_token:f,access_token:p,nonce:m,link_identity:!0,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:Pe}),{data:w,error:b}=g;return b?this._returnResult({data:{user:null,session:null},error:b}):!w||!w.session||!w.user?this._returnResult({data:{user:null,session:null},error:new Vi}):(w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("USER_UPDATED",w.session)),this._returnResult({data:w,error:b}))}catch(o){if(await qt(this.storage,`${this.storageKey}-code-verifier`),G(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}})}async unlinkIdentity(t){try{return await this._useSession(async n=>{var r,o;const{data:l,error:u}=n;if(u)throw u;return await Q(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(o=(r=l.session)===null||r===void 0?void 0:r.access_token)!==null&&o!==void 0?o:void 0})})}catch(n){if(G(n))return this._returnResult({data:null,error:n});throw n}}async _refreshAccessToken(t){const n=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await N_(async o=>(o>0&&await M_(200*Math.pow(2,o-1)),this._debug(n,"refreshing attempt",o),await Q(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Pe})),(o,l)=>{const u=200*Math.pow(2,o);return l&&no(l)&&Date.now()+u-r<nn})}catch(r){if(this._debug(n,"error",r),G(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}finally{this._debug(n,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",n,"url",r),Kt()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:t,url:r},error:null}}async _recoverAndRefresh(){var t,n;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const o=await Pi(this.storage,this.storageKey);if(o&&this.userStorage){let u=await Pi(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!u&&(u={user:o.user},await sn(this.userStorage,this.storageKey+"-user",u)),o.user=(t=u?.user)!==null&&t!==void 0?t:so()}else if(o&&!o.user&&!o.user){const u=await Pi(this.storage,this.storageKey+"-user");u&&u?.user?(o.user=u.user,await qt(this.storage,this.storageKey+"-user"),await sn(this.storage,this.storageKey,o)):o.user=so()}if(this._debug(r,"session from storage",o),!this._isValidSession(o)){this._debug(r,"session is not valid"),o!==null&&await this._removeSession();return}const l=((n=o.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<eo;if(this._debug(r,`session has${l?"":" not"} expired with margin of ${eo}s`),l){if(this.autoRefreshToken&&o.refresh_token){const{error:u}=await this._callRefreshToken(o.refresh_token);u&&(console.error(u),no(u)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",u),await this._removeSession()))}}else if(o.user&&o.user.__isUserNotAvailableProxy===!0)try{const{data:u,error:h}=await this._getUser(o.access_token);!h&&u?.user?(o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(u){console.error("Error getting user data:",u),this._debug(r,"error getting user data, skipping SIGNED_IN notification",u)}else await this._notifyAllSubscribers("SIGNED_IN",o)}catch(o){this._debug(r,"error",o),console.error(o);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var n,r;if(!t)throw new ce;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const o=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(o,"begin");try{this.refreshingDeferred=new dr;const{data:l,error:u}=await this._refreshAccessToken(t);if(u)throw u;if(!l.session)throw new ce;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const h={data:l.session,error:null};return this.refreshingDeferred.resolve(h),h}catch(l){if(this._debug(o,"error",l),G(l)){const u={data:null,error:l};return no(l)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(u),u}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(l),l}finally{this.refreshingDeferred=null,this._debug(o,"end")}}async _notifyAllSubscribers(t,n,r=!0){const o=`#_notifyAllSubscribers(${t})`;this._debug(o,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:t,session:n});const l=[],u=Array.from(this.stateChangeEmitters.values()).map(async h=>{try{await h.callback(t,n)}catch(f){l.push(f)}});if(await Promise.all(u),l.length>0){for(let h=0;h<l.length;h+=1)console.error(l[h]);throw l[0]}}finally{this._debug(o,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await qt(this.storage,`${this.storageKey}-code-verifier`);const n=Object.assign({},t),r=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&n.user&&await sn(this.userStorage,this.storageKey+"-user",{user:n.user});const o=Object.assign({},n);delete o.user;const l=Zl(o);await sn(this.storage,this.storageKey,l)}else{const o=Zl(n);await sn(this.storage,this.storageKey,o)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await qt(this.storage,this.storageKey),await qt(this.storage,this.storageKey+"-code-verifier"),await qt(this.storage,this.storageKey+"-user"),this.userStorage&&await qt(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Kt()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),nn);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t);const n=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=n,n&&typeof n=="object"&&typeof n.unref=="function"?n.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(n)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t);const n=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,n&&clearTimeout(n)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const o=Math.floor((r.expires_at*1e3-t)/nn);this._debug("#_autoRefreshTokenTick()",`access token expires in ${o} ticks, a tick lasts ${nn}ms, refresh threshold is ${Po} ticks`),o<=Po&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof mc)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Kt()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(t){this._debug("#visibilityChangedCallback","error",t)}},window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const n=`#_onVisibilityChanged(${t})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,n,r){const o=[`provider=${encodeURIComponent(n)}`];if(r?.redirectTo&&o.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r?.scopes&&o.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[l,u]=await Gi(this.storage,this.storageKey),h=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(u)}`});o.push(h.toString())}if(r?.queryParams){const l=new URLSearchParams(r.queryParams);o.push(l.toString())}return r?.skipBrowserRedirect&&o.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${t}?${o.join("&")}`}async _unenroll(t){try{return await this._useSession(async n=>{var r;const{data:o,error:l}=n;return l?this._returnResult({data:null,error:l}):await Q(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(r=o?.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(G(n))return this._returnResult({data:null,error:n});throw n}}async _enroll(t){try{return await this._useSession(async n=>{var r,o;const{data:l,error:u}=n;if(u)return this._returnResult({data:null,error:u});const h=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:f,error:p}=await Q(this.fetch,"POST",`${this.url}/factors`,{body:h,headers:this.headers,jwt:(r=l?.session)===null||r===void 0?void 0:r.access_token});return p?this._returnResult({data:null,error:p}):(t.factorType==="totp"&&f.type==="totp"&&(!((o=f?.totp)===null||o===void 0)&&o.qr_code)&&(f.totp.qr_code=`data:image/svg+xml;utf-8,${f.totp.qr_code}`),this._returnResult({data:f,error:null}))})}catch(n){if(G(n))return this._returnResult({data:null,error:n});throw n}}async _verify(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async n=>{var r;const{data:o,error:l}=n;if(l)return this._returnResult({data:null,error:l});const u=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?hm(t.webauthn.credential_response):dm(t.webauthn.credential_response)})}:{code:t.code}),{data:h,error:f}=await Q(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:u,headers:this.headers,jwt:(r=o?.session)===null||r===void 0?void 0:r.access_token});return f?this._returnResult({data:null,error:f}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+h.expires_in},h)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",h),this._returnResult({data:h,error:f}))})}catch(n){if(G(n))return this._returnResult({data:null,error:n});throw n}})}async _challenge(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async n=>{var r;const{data:o,error:l}=n;if(l)return this._returnResult({data:null,error:l});const u=await Q(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(r=o?.session)===null||r===void 0?void 0:r.access_token});if(u.error)return u;const{data:h}=u;if(h.type!=="webauthn")return{data:h,error:null};switch(h.webauthn.type){case"create":return{data:Object.assign(Object.assign({},h),{webauthn:Object.assign(Object.assign({},h.webauthn),{credential_options:Object.assign(Object.assign({},h.webauthn.credential_options),{publicKey:um(h.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},h),{webauthn:Object.assign(Object.assign({},h.webauthn),{credential_options:Object.assign(Object.assign({},h.webauthn.credential_options),{publicKey:cm(h.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(n){if(G(n))return this._returnResult({data:null,error:n});throw n}})}async _challengeAndVerify(t){const{data:n,error:r}=await this._challenge({factorId:t.factorId});return r?this._returnResult({data:null,error:r}):await this._verify({factorId:t.factorId,challengeId:n.id,code:t.code})}async _listFactors(){var t;const{data:{user:n},error:r}=await this.getUser();if(r)return{data:null,error:r};const o={all:[],phone:[],totp:[],webauthn:[]};for(const l of(t=n?.factors)!==null&&t!==void 0?t:[])o.all.push(l),l.status==="verified"&&o[l.factor_type].push(l);return{data:o,error:null}}async _getAuthenticatorAssuranceLevel(t){var n,r,o,l;if(t)try{const{payload:b}=Us(t);let S=null;b.aal&&(S=b.aal);let P=S;const{data:{user:B},error:j}=await this.getUser(t);if(j)return this._returnResult({data:null,error:j});((r=(n=B?.factors)===null||n===void 0?void 0:n.filter(k=>k.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(P="aal2");const O=b.amr||[];return{data:{currentLevel:S,nextLevel:P,currentAuthenticationMethods:O},error:null}}catch(b){if(G(b))return this._returnResult({data:null,error:b});throw b}const{data:{session:u},error:h}=await this.getSession();if(h)return this._returnResult({data:null,error:h});if(!u)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:f}=Us(u.access_token);let p=null;f.aal&&(p=f.aal);let m=p;((l=(o=u.user.factors)===null||o===void 0?void 0:o.filter(b=>b.status==="verified"))!==null&&l!==void 0?l:[]).length>0&&(m="aal2");const w=f.amr||[];return{data:{currentLevel:p,nextLevel:m,currentAuthenticationMethods:w},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async n=>{const{data:{session:r},error:o}=n;return o?this._returnResult({data:null,error:o}):r?await Q(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:r.access_token,xform:l=>({data:l,error:null})}):this._returnResult({data:null,error:new ce})})}catch(n){if(G(n))return this._returnResult({data:null,error:n});throw n}}async _approveAuthorization(t,n){try{return await this._useSession(async r=>{const{data:{session:o},error:l}=r;if(l)return this._returnResult({data:null,error:l});if(!o)return this._returnResult({data:null,error:new ce});const u=await Q(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:o.access_token,body:{action:"approve"},xform:h=>({data:h,error:null})});return u.data&&u.data.redirect_url&&Kt()&&!n?.skipBrowserRedirect&&window.location.assign(u.data.redirect_url),u})}catch(r){if(G(r))return this._returnResult({data:null,error:r});throw r}}async _denyAuthorization(t,n){try{return await this._useSession(async r=>{const{data:{session:o},error:l}=r;if(l)return this._returnResult({data:null,error:l});if(!o)return this._returnResult({data:null,error:new ce});const u=await Q(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:o.access_token,body:{action:"deny"},xform:h=>({data:h,error:null})});return u.data&&u.data.redirect_url&&Kt()&&!n?.skipBrowserRedirect&&window.location.assign(u.data.redirect_url),u})}catch(r){if(G(r))return this._returnResult({data:null,error:r});throw r}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:n},error:r}=t;return r?this._returnResult({data:null,error:r}):n?await Q(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,xform:o=>({data:o,error:null})}):this._returnResult({data:null,error:new ce})})}catch(t){if(G(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async n=>{const{data:{session:r},error:o}=n;return o?this._returnResult({data:null,error:o}):r?(await Q(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new ce})})}catch(n){if(G(n))return this._returnResult({data:null,error:n});throw n}}async fetchJwk(t,n={keys:[]}){let r=n.keys.find(h=>h.kid===t);if(r)return r;const o=Date.now();if(r=this.jwks.keys.find(h=>h.kid===t),r&&this.jwks_cached_at+w_>o)return r;const{data:l,error:u}=await Q(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(u)throw u;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=o,r=l.keys.find(h=>h.kid===t),!r)?null:r}async getClaims(t,n={}){try{let r=t;if(!r){const{data:b,error:S}=await this.getSession();if(S||!b.session)return this._returnResult({data:null,error:S});r=b.session.access_token}const{header:o,payload:l,signature:u,raw:{header:h,payload:f}}=Us(r);n?.allowExpired||F_(l.exp);const p=!o.alg||o.alg.startsWith("HS")||!o.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(o.kid,n?.keys?{keys:n.keys}:n?.jwks);if(!p){const{error:b}=await this.getUser(r);if(b)throw b;return{data:{claims:l,header:o,signature:u},error:null}}const m=Z_(o.alg),g=await crypto.subtle.importKey("jwk",p,m,!0,["verify"]);if(!await crypto.subtle.verify(m,g,u,C_(`${h}.${f}`)))throw new Oo("Invalid JWT signature");return{data:{claims:l,header:o,signature:u},error:null}}catch(r){if(G(r))return this._returnResult({data:null,error:r});throw r}}}es.nextInstanceID={};const bm=es,Tm="2.95.3";let In="";typeof Deno<"u"?In="deno":typeof document<"u"?In="web":typeof navigator<"u"&&navigator.product==="ReactNative"?In="react-native":In="node";const xm={"X-Client-Info":`supabase-js-${In}/${Tm}`},Sm={headers:xm},Pm={schema:"public"},Em={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},km={};function is(i){"@babel/helpers - typeof";return is=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},is(i)}function Om(i,t){if(is(i)!="object"||!i)return i;var n=i[Symbol.toPrimitive];if(n!==void 0){var r=n.call(i,t);if(is(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(i)}function Cm(i){var t=Om(i,"string");return is(t)=="symbol"?t:t+""}function Am(i,t,n){return(t=Cm(t))in i?Object.defineProperty(i,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[t]=n,i}function Jl(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(i,o).enumerable})),n.push.apply(n,r)}return n}function At(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Jl(Object(n),!0).forEach(function(r){Am(i,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):Jl(Object(n)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(n,r))})}return i}const Lm=i=>i?(...t)=>i(...t):(...t)=>fetch(...t),Rm=()=>Headers,Im=(i,t,n)=>{const r=Lm(n),o=Rm();return async(l,u)=>{var h;const f=(h=await t())!==null&&h!==void 0?h:i;let p=new o(u?.headers);return p.has("apikey")||p.set("apikey",i),p.has("Authorization")||p.set("Authorization",`Bearer ${f}`),r(l,At(At({},u),{},{headers:p}))}};function Mm(i){return i.endsWith("/")?i:i+"/"}function Nm(i,t){var n,r;const{db:o,auth:l,realtime:u,global:h}=i,{db:f,auth:p,realtime:m,global:g}=t,w={db:At(At({},f),o),auth:At(At({},p),l),realtime:At(At({},m),u),storage:{},global:At(At(At({},g),h),{},{headers:At(At({},(n=g?.headers)!==null&&n!==void 0?n:{}),(r=h?.headers)!==null&&r!==void 0?r:{})}),accessToken:async()=>""};return i.accessToken?w.accessToken=i.accessToken:delete w.accessToken,w}function jm(i){const t=i?.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Mm(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var Dm=class extends bm{constructor(i){super(i)}},Bm=class{constructor(i,t,n){var r,o;this.supabaseUrl=i,this.supabaseKey=t;const l=jm(i);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const u=`sb-${l.hostname.split(".")[0]}-auth-token`,h={db:Pm,realtime:km,auth:At(At({},Em),{},{storageKey:u}),global:Sm},f=Nm(n??{},h);if(this.storageKey=(r=f.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(o=f.global.headers)!==null&&o!==void 0?o:{},f.accessToken)this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(m,g)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(g)} is not possible`)}});else{var p;this.auth=this._initSupabaseAuthClient((p=f.auth)!==null&&p!==void 0?p:{},this.headers,f.global.fetch)}this.fetch=Im(t,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(At({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(m=>this.realtime.setAuth(m)).catch(m=>console.warn("Failed to set initial Realtime auth token:",m)),this.rest=new Tp(new URL("rest/v1",l).href,{headers:this.headers,schema:f.db.schema,fetch:this.fetch,timeout:f.db.timeout,urlLengthLimit:f.db.urlLengthLimit}),this.storage=new __(this.storageUrl.href,this.headers,this.fetch,n?.storage),f.accessToken||this._listenForAuthEvents()}get functions(){return new pp(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(i){return this.rest.from(i)}schema(i){return this.rest.schema(i)}rpc(i,t={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(i,t,n)}channel(i,t={config:{}}){return this.realtime.channel(i,t)}getChannels(){return this.realtime.getChannels()}removeChannel(i){return this.realtime.removeChannel(i)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var i=this,t,n;if(i.accessToken)return await i.accessToken();const{data:r}=await i.auth.getSession();return(t=(n=r.session)===null||n===void 0?void 0:n.access_token)!==null&&t!==void 0?t:i.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:i,persistSession:t,detectSessionInUrl:n,storage:r,userStorage:o,storageKey:l,flowType:u,lock:h,debug:f,throwOnError:p},m,g){const w={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Dm({url:this.authUrl.href,headers:At(At({},w),m),storageKey:l,autoRefreshToken:i,persistSession:t,detectSessionInUrl:n,storage:r,userStorage:o,flowType:u,lock:h,debug:f,throwOnError:p,fetch:g,hasCustomAuthorizationHeader:Object.keys(this.headers).some(b=>b.toLowerCase()==="authorization")})}_initRealtimeClient(i){return new Up(this.realtimeUrl.href,At(At({},i),{},{params:At(At({},{apikey:this.supabaseKey}),i?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((i,t)=>{this._handleTokenChanged(i,"CLIENT",t?.access_token)})}_handleTokenChanged(i,t,n){(i==="TOKEN_REFRESHED"||i==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):i==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const Um=(i,t,n)=>new Bm(i,t,n);function $m(){if(typeof window<"u")return!1;const i=globalThis.process;if(!i)return!1;const t=i.version;if(t==null)return!1;const n=t.match(/^v(\d+)\./);return n?parseInt(n[1],10)<=18:!1}$m()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const zm="your_supabase_url_here",Fm="your_supabase_anon_key_here",Li=Um(zm,Fm),oo=[{name:"JKA (Civil Engineering)",coords:[101.1218,4.5891],desc:"Main building for Civil Engineering students.",img:[]},{name:"JKE (Electrical Engineering)",coords:[101.12223048744252,4.5865135045488925],desc:"Main building for Electrical Engineering students.",img:[]},{name:"JTMK (Information Technology and Comunication)",coords:[101.1221099242751,4.587174478314882],desc:"Main building for Information Technology and Communication students.",img:[]},{name:"JKP (Marine Engineering)",coords:[101.1231604020463,4.587192005780873],desc:"Main building for Marine Engineering students.",img:[]},{name:"Library (Perpustakaan PUO)",coords:[101.1225,4.588],desc:"Learning resource center & e-library access.",img:[]},{name:"Dewan Jubli Perak",coords:[4.587560151474034,101.12381542138613],desc:"Main auditorium for events and ceremonies.",img:["image/DEWAN_JUBLI_PERAK.jpg"]},{name:"Cafe A (JKA Cafeteria)",coords:[4.587886698466278,101.12498833422116],desc:"Cafeteria near Dewan Warisan.",img:["image/KANTIN_A.jpg"]},{name:"Cafe B (JKE Cafeteria)",coords:[101.12275930567483,4.586740727476954],desc:"Cafeteria near JKE building.",img:["image/cafe_jke/1.jpg","image/cafe_jke/2.jpg"]},{name:"Cafe C (Campus B Cafeteria)",coords:[101.12257068194992,4.590834756559952],desc:"Cafeteria near Campus B.",img:[]},{name:"Kolej Kediaman PFI",coords:[4.589539460460139,101.12152033870018],desc:"Student accommodation for PFI students.",img:[]},{name:"Dewan Seri Kinta",coords:[4.588055803102894,101.12531008087336],desc:"Main hall for events and activities.",img:["image/DEWAN_KINTA.jpg"]},{name:"Dewan Warisan",coords:[4.588055803102894,101.12531008087336],desc:"Main hall for events and activities.",img:["image/dewan_warisan/1.jpg"]},{name:"Pondok Guard",coords:[4.588740968020849,101.12620219660123],desc:"Safety Place.",img:[]}];async function Co(){try{const{data:i,error:t}=await Li.from("locations").select("*, location_images(*)").order("id");return t?(console.error("Error fetching locations from Supabase:",t),oo):!i||i.length===0?(console.log("No locations in Supabase, using fallback data"),oo):i.map(n=>({id:n.id,name:n.name,coords:[n.longitude,n.latitude],desc:n.description||"",img:n.location_images?.sort((r,o)=>(r.order||0)-(o.order||0))?.map(r=>r.image_url)||[]}))}catch(i){return console.error("Exception fetching locations:",i),oo}}async function Zm(i,t,n,r){try{const{data:o,error:l}=await Li.from("locations").insert([{name:i,description:t,latitude:n,longitude:r}]).select();if(l)throw l;return o?.[0]}catch(o){throw console.error("Error adding location:",o),o}}async function Wm(i){try{const{error:t}=await Li.from("locations").delete().eq("id",i);if(t)throw t}catch(t){throw console.error("Error deleting location:",t),t}}async function Hm(i,t){try{const n=t.name.split(".").pop(),r=`${i}/${Date.now()}.${n}`,{error:o}=await Li.storage.from("location-images").upload(r,t);if(o)throw o;const{data:l}=Li.storage.from("location-images").getPublicUrl(r),{data:u}=await Li.from("location_images").select("order").eq("location_id",i),h=u?.length||0,{data:f,error:p}=await Li.from("location_images").insert([{location_id:i,image_url:l.publicUrl,order:h}]).select();if(p)throw p;return f?.[0]}catch(n){throw console.error("Error uploading image:",n),n}}const yc=(i,t)=>{const n=i.__vccOpts||i;for(const[r,o]of t)n[r]=o;return n},qm={key:0,class:"admin-panel"},Km={class:"admin-modal"},Vm={class:"admin-tabs"},Gm={class:"admin-content"},Jm={key:0,class:"tab-content"},Ym={class:"form-section"},Xm={class:"form-group"},Qm={class:"form-group"},tg={class:"form-row"},eg={class:"form-group"},ig={class:"form-group"},ng=["disabled"],sg={class:"list-section"},rg={class:"locations-list"},og={class:"location-info"},ag={class:"image-count"},lg={class:"location-actions"},ug=["onClick"],cg=["onClick"],hg={key:1,class:"tab-content"},dg={key:0,class:"no-selection"},fg={key:1},pg={class:"selected-location"},_g={class:"form-section"},mg={key:0,class:"file-list"},gg=["disabled"],vg={class:"list-section"},yg={key:0,class:"empty-state"},wg={key:1,class:"images-grid"},bg=["src","alt"],Tg={class:"image-actions"},xg=["onClick"],Sg={class:"image-order"},Pg={__name:"AdminPanel",setup(i,{expose:t}){const n=Gt(!1),r=Gt("locations"),o=Gt([]),l=Gt(null),u=Gt(!1),h=Gt(!1),f=Gt(!1),p=Gt([]),m=Gt(null),g=Gt({name:"",description:"",latitude:4.5884,longitude:101.1215});t({toggleAdmin:()=>{n.value=!n.value}});async function w(){try{o.value=await Co()}catch(H){console.error("Failed to load locations:",H),alert("Error loading locations")}}async function b(){if(!g.value.name||g.value.latitude===null||g.value.longitude===null){alert("Please fill in all required fields");return}u.value=!0;try{await Zm(g.value.name,g.value.description,g.value.latitude,g.value.longitude),alert("Location added successfully!"),g.value={name:"",description:"",latitude:4.5884,longitude:101.1215},await w()}catch(H){console.error("Error adding location:",H),alert("Error adding location: "+H.message)}finally{u.value=!1}}async function S(H){if(confirm("Are you sure you want to delete this location?"))try{await Wm(H),alert("Location deleted successfully!"),await w()}catch(A){console.error("Error deleting location:",A),alert("Error deleting location")}}function P(H){l.value=H,r.value="images"}function B(H){p.value=Array.from(H.target.files)}function j(H){H.preventDefault(),f.value=!1,p.value=Array.from(H.dataTransfer.files).filter(A=>A.type.startsWith("image/"))}async function U(){if(!l.value||p.value.length===0){alert("Please select files to upload");return}h.value=!0;try{for(const A of p.value)await Hm(l.value.id,A);alert("Images uploaded successfully!"),p.value=[],await w();const H=o.value.find(A=>A.id===l.value.id);H&&(l.value=H)}catch(H){console.error("Error uploading images:",H),alert("Error uploading images: "+H.message)}finally{h.value=!1}}async function O(H){if(confirm("Are you sure you want to delete this image?"))try{alert("Image deletion requires additional implementation")}catch(A){console.error("Error deleting image:",A),alert("Error deleting image")}}function k(){n.value=!1}return w(),(H,A)=>n.value?(jt(),$t("div",qm,[$("div",{class:"admin-overlay",onClick:k}),$("div",Km,[$("div",{class:"admin-header"},[A[11]||(A[11]=$("h2",null,"Poli-Map Admin Dashboard",-1)),$("button",{onClick:k,class:"close-btn"},[...A[10]||(A[10]=[$("i",{class:"bi bi-x-lg"},null,-1)])])]),$("div",Vm,[$("button",{class:Wn(["tab-btn",{active:r.value==="locations"}]),onClick:A[0]||(A[0]=V=>r.value="locations")}," Locations ",2),$("button",{class:Wn(["tab-btn",{active:r.value==="images"}]),onClick:A[1]||(A[1]=V=>r.value="images")}," Images ",2)]),$("div",Gm,[r.value==="locations"?(jt(),$t("div",Jm,[A[19]||(A[19]=$("h3",null,"Manage Locations",-1)),$("div",Ym,[A[16]||(A[16]=$("h4",null,"Add New Location",-1)),$("form",{onSubmit:Ln(b,["prevent"])},[$("div",Xm,[A[12]||(A[12]=$("label",null,"Location Name *",-1)),As($("input",{"onUpdate:modelValue":A[2]||(A[2]=V=>g.value.name=V),type:"text",required:""},null,512),[[Ls,g.value.name]])]),$("div",Qm,[A[13]||(A[13]=$("label",null,"Description",-1)),As($("textarea",{"onUpdate:modelValue":A[3]||(A[3]=V=>g.value.description=V)},null,512),[[Ls,g.value.description]])]),$("div",tg,[$("div",eg,[A[14]||(A[14]=$("label",null,"Latitude *",-1)),As($("input",{"onUpdate:modelValue":A[4]||(A[4]=V=>g.value.latitude=V),type:"number",step:"0.0001",required:""},null,512),[[Ls,g.value.latitude,void 0,{number:!0}]])]),$("div",ig,[A[15]||(A[15]=$("label",null,"Longitude *",-1)),As($("input",{"onUpdate:modelValue":A[5]||(A[5]=V=>g.value.longitude=V),type:"number",step:"0.0001",required:""},null,512),[[Ls,g.value.longitude,void 0,{number:!0}]])])]),$("button",{type:"submit",class:"btn-primary",disabled:u.value},Vt(u.value?"Adding...":"Add Location"),9,ng)],32)]),$("div",sg,[$("h4",null,"Existing Locations ("+Vt(o.value.length)+")",1),$("div",rg,[(jt(!0),$t(de,null,qr(o.value,V=>(jt(),$t("div",{key:V.id,class:"location-item"},[$("div",og,[$("h5",null,Vt(V.name),1),$("p",null,Vt(V.desc),1),$("small",null,Vt(V.coords[1])+", "+Vt(V.coords[0]),1),$("p",ag,Vt(V.img?.length||0)+" images",1)]),$("div",lg,[$("button",{onClick:_t=>P(V),class:"btn-secondary"},[...A[17]||(A[17]=[$("i",{class:"bi bi-images"},null,-1),zn(" Manage Images ",-1)])],8,ug),$("button",{onClick:_t=>S(V.id),class:"btn-danger"},[...A[18]||(A[18]=[$("i",{class:"bi bi-trash"},null,-1),zn(" Delete ",-1)])],8,cg)])]))),128))])])])):di("",!0),r.value==="images"?(jt(),$t("div",hg,[A[25]||(A[25]=$("h3",null,"Manage Images",-1)),l.value?(jt(),$t("div",fg,[$("div",pg,[$("h4",null,Vt(l.value.name),1),$("button",{onClick:A[6]||(A[6]=V=>l.value=null),class:"btn-text"}," Back to locations")]),$("div",_g,[A[22]||(A[22]=$("h4",null,"Upload Images",-1)),$("div",{class:"upload-area",onDragover:A[8]||(A[8]=V=>f.value=!0),onDragleave:A[9]||(A[9]=V=>f.value=!1),onDrop:j},[$("input",{type:"file",multiple:"",accept:"image/*",onChange:B,ref_key:"fileInput",ref:m,style:{display:"none"}},null,544),$("button",{type:"button",onClick:A[7]||(A[7]=V=>H.$refs.fileInput.click()),class:"btn-primary"},[...A[21]||(A[21]=[$("i",{class:"bi bi-cloud-arrow-up"},null,-1),zn(" Choose Images or Drag & Drop ",-1)])]),p.value.length>0?(jt(),$t("div",mg,[$("p",null,Vt(p.value.length)+" file(s) selected",1),$("ul",null,[(jt(!0),$t(de,null,qr(p.value,V=>(jt(),$t("li",{key:V.name},Vt(V.name),1))),128))]),$("button",{onClick:U,class:"btn-primary",disabled:h.value},Vt(h.value?"Uploading...":"Upload Selected Images"),9,gg)])):di("",!0)],32)]),$("div",vg,[$("h4",null,"Images for "+Vt(l.value.name)+" ("+Vt(l.value.img?.length||0)+")",1),l.value.img?.length===0?(jt(),$t("div",yg,[...A[23]||(A[23]=[$("p",null,"No images yet. Upload your first image above!",-1)])])):(jt(),$t("div",wg,[(jt(!0),$t(de,null,qr(l.value.img,(V,_t)=>(jt(),$t("div",{key:_t,class:"image-card"},[$("img",{src:V,alt:`Image ${_t+1}`},null,8,bg),$("div",Tg,[$("button",{onClick:Lt=>O(),class:"btn-danger-small"},[...A[24]||(A[24]=[$("i",{class:"bi bi-trash"},null,-1)])],8,xg)]),$("p",Sg,Vt(_t+1),1)]))),128))]))])])):(jt(),$t("div",dg,[...A[20]||(A[20]=[$("p",null,"Select a location from the Locations tab to manage its images.",-1)])]))])):di("",!0)]),$("div",{class:"admin-footer"},[$("button",{onClick:k,class:"btn-secondary"},"Close")])])])):di("",!0)}},Eg=yc(Pg,[["__scopeId","data-v-8c287286"]]),kg={class:"w-full h-screen bg-gray-100"},Og={key:0,class:"absolute top-4 left-4 w-80 bg-white/90 backdrop-blur-md rounded-2xl shadow-2xl z-[2000] overflow-hidden transition-all duration-300 border border-white/20"},Cg={key:0,class:"relative group"},Ag=["src"],Lg={key:1,class:"p-5"},Rg={class:"text-xl font-extrabold text-slate-900 mb-2 leading-tight"},Ig={class:"text-slate-600 text-sm leading-relaxed"},Mg=["src"],Ng={__name:"App",setup(i){const t=Gt(-1),n=Gt(0),r=Gt(!1),o=Gt(!1),l=Gt([]),u=Gt([]),h=Gt(null);let f;const p=ec(()=>t.value>=0?u.value[t.value]:null);Ru(async()=>{try{u.value=await Co(),m()}catch(O){console.error("Failed to load locations:",O)}});function m(){f=Rs.map("map").setView([4.5884,101.1215],16),Rs.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:" OpenStreetMap contributors",maxZoom:19}).addTo(f),u.value.forEach((O,k)=>{const H=Rs.divIcon({html:`
        <div class="custom-marker-content">
          <div class="marker-pulse"></div>
          <div class="relative flex items-center justify-center w-8 h-8 bg-blue-600 rounded-full border-2 border-white shadow-xl transition-transform duration-300 hover:scale-125 hover:bg-blue-500">
            <i class="bi bi-geo-alt-fill text-white text-sm"></i>
          </div>
        </div>
      `,className:"custom-marker-wrapper",iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]}),A=Rs.marker([O.coords[1],O.coords[0]],{icon:H,title:O.name}).addTo(f),V=A.getElement();if(V){V.classList.add("group");const _t=document.createElement("div");_t.className="marker-label",_t.textContent=O.name,V.appendChild(_t),V.addEventListener("click",Lt=>{Lt.stopPropagation(),g(k)})}l.value.push({marker:A,element:V})}),f.on("click",()=>{r.value&&w()})}function g(O){t.value=O,n.value=0,r.value=!0;const k=u.value[O];f.flyTo([k.coords[1],k.coords[0]],17.5,{duration:2})}function w(){r.value=!1}function b(O){O&&O.stopPropagation();const k=p.value;k&&k.img&&k.img.length>0&&(n.value=(n.value+1)%k.img.length)}function S(O){O&&O.stopPropagation();const k=p.value;k&&k.img&&k.img.length>0&&(n.value=(n.value-1+k.img.length)%k.img.length)}function P(O){O&&O.stopPropagation(),o.value=!0}function B(){o.value=!1}function j(){if(p.value){const{coords:O,name:k}=p.value,H=`https://www.google.com/maps/search/${encodeURIComponent(k)}/@${O[1]},${O[0]},17z`;window.open(H,"_blank")}}async function U(){try{u.value=await Co(),f&&f.remove(),l.value=[],t.value=-1,r.value=!1,m()}catch(O){console.error("Failed to reload locations:",O)}}return(O,k)=>(jt(),$t("div",kg,[$("button",{onClick:k[0]||(k[0]=H=>O.$refs.adminPanel.toggleAdmin()),class:"admin-button",title:"Admin Dashboard"},[...k[2]||(k[2]=[$("i",{class:"bi bi-gear-fill"},null,-1)])]),$e(Eg,{ref_key:"adminPanel",ref:h,onLocationsUpdated:U},null,512),k[10]||(k[10]=$("div",{id:"map",class:"w-full h-full"},null,-1)),r.value?(jt(),$t("div",Og,[p.value&&p.value.img&&p.value.img.length>0?(jt(),$t("div",Cg,[$("div",{onClick:w,class:"absolute top-3 right-3 bg-white/80 backdrop-blur-sm rounded-full w-8 h-8 flex items-center justify-center cursor-pointer shadow-sm hover:bg-white z-10 transition-colors"},[...k[3]||(k[3]=[$("i",{class:"bi bi-x-lg text-slate-800 text-sm"},null,-1)])]),$("img",{src:p.value.img[n.value],onClick:P,class:"w-full h-48 object-cover transition-transform duration-500 hover:scale-105 cursor-pointer",alt:"Campus"},null,8,Ag),$("div",{class:"absolute bottom-3 right-3 flex gap-2"},[$("button",{onClick:S,class:"bg-black/40 hover:bg-black/60 text-white p-2 rounded-full backdrop-blur-sm transition-all"},[...k[4]||(k[4]=[$("i",{class:"bi bi-chevron-left text-lg"},null,-1)])]),$("button",{onClick:b,class:"bg-black/40 hover:bg-black/60 text-white p-2 rounded-full backdrop-blur-sm transition-all"},[...k[5]||(k[5]=[$("i",{class:"bi bi-chevron-right text-lg"},null,-1)])])])])):di("",!0),p.value?(jt(),$t("div",Lg,[$("h5",Rg,Vt(p.value.name),1),$("p",Ig,Vt(p.value.desc),1),$("button",{onClick:j,class:"mt-4 w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-xl text-sm font-semibold transition-colors flex items-center justify-center gap-2"},[...k[6]||(k[6]=[$("i",{class:"bi bi-geo-alt"},null,-1),zn(" View in Google Maps ",-1)])])])):di("",!0)])):di("",!0),o.value?(jt(),$t("div",{key:1,class:"modal-overlay",onClick:B},[$("span",{onClick:Ln(B,["stop"]),class:"modal-close"},[...k[7]||(k[7]=[$("i",{class:"bi bi-x-lg"},null,-1)])]),$("button",{onClick:Ln(S,["stop"]),class:"modal-nav-btn prev"},[...k[8]||(k[8]=[$("i",{class:"bi bi-chevron-left"},null,-1)])]),$("img",{src:p.value.img[n.value],onClick:k[1]||(k[1]=Ln(()=>{},["stop"])),class:"modal-img-content",alt:"Full size"},null,8,Mg),$("button",{onClick:Ln(b,["stop"]),class:"modal-nav-btn next"},[...k[9]||(k[9]=[$("i",{class:"bi bi-chevron-right"},null,-1)])])])):di("",!0)]))}},jg=yc(Ng,[["__scopeId","data-v-2d094611"]]),Dg=sp(jg);Dg.mount("#app");
